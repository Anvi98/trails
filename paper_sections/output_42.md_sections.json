[
    {
        "level": "#",
        "title": "Uplink Soft Handover For Leo Constellations: How Strong The Inter-Satellite Link Should Be",
        "content": "\n2nd Alberto Tarable CNR-IEIIT\nTorino, Italy alberto.tarable@cnr.it\n1st Houcem Ben Salem CNR-IEIIT\nTorino, Italy houcem.bensalem@ieiit.cnr.it\n\n  Abstract\u2014We consider a constellation of low-earth-orbit (LEO)\nsatellites connected to a handheld device on the ground. Due\nto the very large orbital speed, an effective handover strategy\nbecomes of paramount importance. In particular, we study the\nbenefits of soft handover in the uplink from the physical-layer\npoint of view. We give a realistic model for both the ground-to-\nsatellite and the inter-satellite links, following the 3GPP channel\nmodel for the former. We suppose that, during handover from\na serving satellite to a target satellite, one of the two satellites\nforwards the received signal from the ground user to the other,\nthus acting as a relay. We quantify through simulations the loss\nof hard handover, compared to soft handover. For the latter,\nwe test both amplify-and-forward (AF) and decode-and-forward\n(DF) relaying techniques and verify that, at least in the simulated\nconditions, DF does not repay, in terms of block error rate\n(BLER), the increase of complexity with respect to AF. Also,\nwe study the effect of the LEO constellation size on the network\nBLER. Finally, we show that, with soft handover, the impact of\nmisalignment on the inter-satellite link is severe, especially at\noptical frequencies.\n  Index Terms\u2014Non-Terrestrial Networks, LEO constellations,\nsoft handover, Inter-Satellite Link\n"
    },
    {
        "level": "##",
        "title": "I. Introduction",
        "content": "\nThe integration of terrestrial and non-terrestrial networks\n(NTNs) is foreseen as one of the key factors that will enable ubiquitous connectivity in future 6G networks [1], [2]. NTNs can also play a fundamental role in ensuring connectivity in cases where the terrestrial infrastructure is missing or indequate to support the requested traffic, such as in rural areas or in disaster scenarios. In particular, low-earth orbit (LEO)\nNTNs have now become an important research subject, also fostered by the surge of privately-owned LEO constellations put into operations by several companies.\n\nLEO NTNs offer smaller round-trip times (up to 30 ms)\ncompared to geostationary NTNs, but they present a number of challenges. Since a LEO satellite provides a limited coverage on the earth surface, several tens of satellites need to be employed in the same LEO, in order to ensure uninterrupted connectivity with static ground users (GU). Even more importantly, LEO satellites have a very short orbital period. As an example, a satellite having height 550 km above the earth surface performs a revolution in about 1.6 hours. Thus, a LEO satellite remains in visibility for a limited amount of time (a few minutes), so that there is need for frequent handover,\n4th Behrooz Makki Ericsson EAB\nG\u00a8oteborg, Sweden behrooz.makki@ericsson.com\n3rd Alessandro Nordio CNR-IEIIT\nTorino, Italy alessandro.nordio@cnr.it even for a static GU [3]. In this regard, we can distinguish two different system-level choices. In the first method, each satellite steers its antenna array so as to point always to the same ground area, therefore the cells are earth-fixed. In the second method, the satellite array points to a fixed direction, so that the cells are earth-moving. In the first case, handover between different satellites has to be performed every few minutes. In the second case, handover events are much more frequent, once every few seconds [3]. In both scenarios, it is clear that handling effectively the handover is crucial to ensure a high-level quality of service.\n\nIn this paper, we consider the uplink (UL) of a satellite communication system where a GU initially communicates with a serving satellite S. In an ideal hard-handover scenario, the GU instantaneously switches to a target satellite T, when its elevation on the horizon becomes greater than that of S (for a more realistic protocol, see, e.g., [3]). Instead, in soft handover the GU signal is received by both S and T for a short period of time. Then, the lower-elevation satellite (which is first T, then S) acts as a relay, by forwarding its received signal to the higher-elevation one through the inter-satellite link (ISL). In the following, we are particularly interested in understanding the role of the ISL to help the handover. We study the block error rate (BLER) when amplify-and-forward (AF) and decode-and-forward (DF) relaying techniques are applied. We consider realistic models for ground-to-satellite\n(G2S) and ISL channels, following the recent 3GPP model for the former. Also, we assess the advantage of soft handover with respect to hard handover, and we study the effect of the size of the satellite constellation and of the misalignment in the ISL on the performance of soft-handover-based LEO systems.\n\nA paper dealing with soft handover in the UL is [4], which considers multipacket transmission on a highly time-dispersive channel. However, the ISL is assumed ideal, and the satellite performs linear minimum-mean square error filtering on the signals received from several GUs. A paper that performs multi-satellite reception (without reference to handover) is the recent [5]. In that context, the channel model defined in [6], [7] is used and imperfect channel state information is taken into account. Performance is measured in terms of achievable capacity. However, also in that case, the ISL is assumed ideal.\n\nDifferently from previous works, we precisely address the role of the ISL in the performance of soft handover. We perform evaluation of BLER by simulating a realistic environment in which the time evolution of satellite elevations is obtained by geometrical considerations, the G2S link is based on the 3GPP standard channel model defined in [6], [7], and the ISL\nchannel model is based on [8]. 1\nWe will address the following questions:\n\n- What is the advantage of soft handover, compared to hard\nhandover?\n- What is the best strategy the relaying satellite can adopt?\nTo answer this question, we will compare the performance of AF and DF relaying techniques.\n- What is the impact of the constellation size?\n- How severe is the impact of misalignment for an optical ISL? In this respect, is an ISL in the THz band more robust?\n\nIn the following, we partially answer such questions, by concluding that, with a proper choice of the soft-handover scheme, and with a suitable design of the ISL, the performance gain of soft handover over hard handover justifies the additional complexity related to its implementation.\n"
    },
    {
        "level": "##",
        "title": "Ii. System Description",
        "content": "\nA. Geometrical Model We consider a set of M satellites deployed on a circular orbit, with height on the ground h0 and inclination iK with respect to the equatorial plane. Satellites are angularly spaced on the orbit by \u03b10 = 2\u03c0/M radiants, as depicted in Figure 1.\n\nAccording to Kepler's laws, the angular speed of each satellite is given by [10]\n\n(RE + h0)3 [rad/s], (1) \u03c9 = \ufffd \u00b5\nwhere RE = 6371 km is the earth radius and \u00b5 = 3.986 \u00d7\n105 km3s\u22122 is the gravitational constant. Let us denote by \u2113\neither the serving satellite, \u2113 = S, or the target satellite, \u2113 = T .\n\nLet \u03b1\u2113(t) = \u03c9t + \u03b1\u2113(0), \u2113 \u2208 {S, T}, be the angular position of satellite \u2113 at time t. Without loss of generality, we can set \u03b1S(0) = 0 and \u03b1T(0) = \u03b10, i.e., S and T are adjacent satellites on the orbit. Also, let \u03bb\u2113(t) ad \u03c6\u2113(t) be the latitude and longitude of the sub-satellite point (SSP)2 of \u2113 at time t.\n\nBy geometric considerations, we obtain\n\n\u03bb\u2113(t) = arcsin(sin iK sin \u03b1\u2113(t)) (2)\nwhere \u03c9E is the earth angular speed,\n\n\u03c6\u2113(t) = mod \ufffd \ufffd\u03c6\u2113(t) \u2212 \u03c9Et + \u03c0, 2\u03c0 \ufffd \u2212 \u03c0, (3) \ufffd\u03c6\u2113(t) = atan2(cos iK sin \u03b1\u2113(t), cos \u03b1\u2113(t)), (4)\nand atan2(\u00b7, \u00b7) is the 4-quadrant inverse tangent function. With reference to Fig. 2, let \u03bbGU and \u03c6GU be latitude and longitude of the GU, supposed fixed in a single satellite pass3. Using the spherical law of cosines, the central angle between the GU and the SSP of satellite \u2113 is given by [11]\n\n$$\\gamma_{\\ell}(t)=\\arccos\\left(\\sin\\lambda_{\\ell}(t)\\sin\\lambda_{\\rm GU}+\\cos\\lambda_{\\ell}(t)\\cos\\lambda_{\\rm GU}\\cos\\Delta\\phi_{\\ell}(t)\\right)\\tag{5}$$\n\nwhere $\\Delta\\phi_{\\ell}(t)=\\phi_{\\rm GU}-\\phi_{\\ell}(t)$. The elevation of the satellite $\\ell$ at time $t$, as observed by the GU, can be found using the law of sines [10], yielding\n\n$$\\delta_{\\ell}(t)=\\arctan\\frac{\\cos\\gamma_{\\ell}(t)-\\frac{R_{\\rm E}}{R_{\\rm E}+h_{0}}}{\\sin\\gamma_{\\ell}(t)}\\,.\\tag{6}$$\nWe define \u03b4min as the minimum elevation that allows a successful communication between the GU and the satellite.\n\nFinally, considering Fig. 2, the slant distance of the satellite \u2113\nfrom the GU can be obtained by the law of cosines [6] as\n\n$$d_{\\ell}(t)=\\sqrt{R_{\\rm E}^{2}\\sin^{2}\\delta_{\\ell}(t)+h_{0}^{2}+2h_{0}R_{\\rm E}-R_{\\rm E}\\sin\\delta_{\\ell}(t)}\\tag{7}$$\n"
    },
    {
        "level": "##",
        "title": "B. Ground-To-Satellite Channel Model",
        "content": "\nWe assume the narrow-band G2S channel model presented in [6], [7]. It is based on a Semi-Markov chain, where there are two states, good (G) and bad (B). State G represents a condition in which the effect of obstructions and fading is relatively low, while in state B shadowing and fading have a more severe impact on the received signal-to-noise ratio\n(SNR). The evolution of the channel conditions corresponds to an alternate sequence of states G and B, where the duration of each state occurrence is a random variable independent of all the others. In both states, the duration has a lognormal probability density function (PDF), with different parameters for state-G and state-B occurrences.\n\nWithin a given state occurrence, the channel coefficients obey a Loo distribution, which is the superposition of a lognormal shadowing (modeling slow channel variations) and a Rayleigh fading. Under this model, a channel coefficient is a complex random variable with independent magnitude and phase. The phase is uniformly distributed in [0, 2\u03c0] and the magnitude has PDF\n\n$$f_{\\rm LOo}(x)=\\frac{8.686x}{\\Sigma_{\\rm A}\\sigma^{2}\\sqrt{2}\\pi}\\int_{0}^{+\\infty}\\frac{1}{a}{\\rm e}^{-\\frac{(20\\log_{10}(a)-M_{\\rm A})^{2}}{2\\Sigma_{\\rm A}^{2}}}-\\frac{x^{2}-a^{2}}{2\\sigma^{2}}\\tag{8}$$ $$\\times I_{0}\\left(\\frac{ax}{\\sigma^{2}}\\right)\\,{\\rm d}a$$\nwhere MA and \u03a3A are mean and standard deviation of the Line-of-Sight (LoS) component, while MP = 10 log10 \u03c32\nis the power of the scattered component. In (8), I0(x) is the order-0 modified Bessel function of the first kind. The triple of parameters (MA, \u03a3A, MP) characterizing the Loo distribution is itself a random variable, with different PDF\ndepending on whether the state is good or bad, and sampled independently for each state occurrence. Correlation between successive channel coefficients is obtained by low-pass filtering on the LoS component and Jakes' filtering on the scattered component [7].\n\nOn the G2S link, the signal received by satellite \u2113 at time t has SNR\n\n$${\\rm SNR}_{\\ell}(t)=\\frac{P_{\\rm GU}G_{\\rm GU}G_{\\ell}L_{\\ell}(t)|h_{\\ell}(t)|^{2}}{N_{0}W_{\\rm GS}}=\\rho_{\\ell}(t)|h_{\\ell}(t)|^{2}\\tag{9}$$\nwhere\n\n- PGU is the GU TX power;\n- GGU and G\u2113 are the antenna gains of the GU and of\nsatellite \u2113, respectively;\n4\u03c0d\u2113(t)fG2S\n- L\u2113(t) =\n\ufffd\nc\n\ufffd2\nis the free-space path loss, with\nc and fG2S being the speed of light and the carrier\nfrequency on the G2S link;\n- h\u2113(t) is the term in the G2S channel that accounts for\nshadowing and fading;\n- \u03c1\u2113(t) is the LoS SNR, without shadowing/fading;\n- N0 is the noise power spectral density;\n- WG2S is the signal bandwidth on the G2S channel.\n"
    },
    {
        "level": "##",
        "title": "C. Isl Channel Model",
        "content": "\nFor the ISL channel, we adopt the model reported in\n[8]. In particular, we assume that the ISL works at a large operating frequency, so that the depolarization effect can be neglected. Moreover, the attenuation due to plasma frequency and collision frequency is very low, compared to the free-space path loss, thus it will also be neglected [8].\n\nThe inter-satellite channel model boils down to an AWGN\nchannel, with random SNR due to pointing errors, represented by a misalignment angle \u03be between transmit and receive antennas. We assume that the antenna gain of both satellites on the ISL can be characterized as [8]\n\n$$G=G_{0}{\\rm e}^{-\\nu\\xi^{2}}\\tag{109}$$\nwhere G0 is the maximum antenna gain (achieved when the main lobe of the satellite antenna perfectly points towards the other satellite), \u03bd = 4 ln 2/\u03b82\n3dB is a parameter related to the\n3-dB width \u03b83dB of the main lobe and \u03be is a Gaussian random variable with zero mean and variance \u03c32\np.\n\nThus, we can compute the received SNR on the ISL as\n\n$$\\rho_{\\rm ISL}=\\frac{P_{T}L_{\\rm ISL}G_{0}^{2}{\\rm e}^{-2\\nu\\xi^{2}}}{k_{B}T_{0}W_{\\rm ISL}}\\tag{11}$$\nwhere\n- PT is the transmit power on the ISL link;\n4\u03c0dISLfISL\n\ufffd2\nis the free-space path loss, with\nfISL and dISL = 2(Re + h0) sin \u03b10\n- LISL =\n\ufffd\nc\n2\nbeing the carrier\nfrequency and the link length on the ISL, respectively;\n- kB is the Boltzmann constant;\n- T0 is the ambient noise temperature; - WISL is the signal bandwidth on the ISL.\nWe suppose perfect receiver knowledge of the ISL SNR.\n"
    },
    {
        "level": "##",
        "title": "D. Signal Received On The G2S Link",
        "content": "\nIn this subsection, we describe the communication channel in the G2S link.\n\nThe GU takes into information word $\\mathbf{u}$ and encodes it with a rate-$R_{\\ell}$ channel code. Then, the obtained codeword $\\mathbf{c}=1,2,\\ldots,N$, broadening the sequence of symbols $x[n]$, $n=1,2,\\ldots,N$, taken from a size-$S$ unit-energy modulation, where $T_{s}$ is the symbol time.\n\nIn the soft-handover scenario, both satellites receive the signal transmitted by the GU. One of the two satellites works as relay (R), through the ISI, according to the relaying strategies described in Sect. II-E; the other as destination (D). More precisely, when $\\delta_{\\delta}(t)>\\delta_{\\mathrm{T}}(t)$, then $\\mathrm{R}=\\mathrm{T}$ and $\\mathrm{D}=\\mathrm{S}$. Both satellites are supposed to have perfect knowledge of their respective channel, because for example it has been estimated through the use of plots. The (normalized) signal received by satellite $\\ell$ at time step $n$, $n=1,\\ldots,N$ is given by\n\n$$\\begin{array}{l}y\\ell[n]\\ \\sim\\ \\sqrt{\\rho_{\\ell}[n]h[n][n]+w\\ell[n]},\\end{array}\\tag{12}$$\n\nwhere $w_{\\ell}[n]\\sim\\mathcal{CN}(0,1)$, i.e., it is a circularly-symmetric complex Gaussian noise sample with zero mean and unit variance, $\\rho_{\\ell}[n]\\triangleq\\rho_{\\ell}(nT_{s})$ is the received LoS SNRs, while $h[n]\\triangleq h(nT_{s})$ accounts for both shadowing and fading. For the sake of notation compactness, we define the vectors $\\mathbf{y}_{\\ell}=(y_{\\ell}[1],\\ldots,y_{\\ell}[N])$, with $\\ell\\in\\{\\mathrm{S},\\mathrm{T}\\}$ if we consider the physical satellites or $\\ell\\in\\{\\mathrm{R},\\mathrm{D}\\}$ if we refer to the logical satellites, and analogously for $\\rho_{\\ell}$ and $\\mathbf{h}_{\\ell}$.\n\nE. Relaying Techniques\n  With soft handover, after reception from the GU, the relay-\ning satellite R may forward its received signal to satellite D.\nWe consider two possible choices for the relaying strategy, as\nfollows.\n\n- *Amplify and forward (AF)*: Satellite R works as a repeater,\nby only forwarding the received signal yR[n]. The normalized (unit-energy) forwarded signal on the ISL link then becomes\n$$x_{\\rm ISL}[n]=\\frac{y_{\\rm R}[n]}{\\sqrt{q[n]}},\\quad\\forall n\\tag{13}$$\n\nwhere $q[n]={\\mathbb{E}}[|y_{\\rm R}[n]|^{2}]=\\rho_{\\rm R}[n]|h_{\\rm R}[n]|^{2}+1$ is a normalization factor. Indeed, with AF relaying, the normalized signal in (13) is amplified with an amplification gain before transmission.\n* _Decode and forward (DF)_: Satellite R demodulates and decodes the received signal. A block decoding error happens with probability $P_{B}$, according to the definition (24) given below. We suppose that satellite R is aware whether decoding is successful or not. If it is successful, it encodes the estimated information bits, modulates the coded bits and forwards the regenerated signal to S, so that $$x_{\\rm ISL}[n]=x[n],\\quad\\forall n$$ (14)\nIf decoding is not successful, T forwards no signal to S.\n\nF. Processing at Satellite D\nThe (normalized) signal received by satellite D on the ISL\nfrom R at time step n is given by\n\n$$y_{\\rm{ISL}}[n]=\\sqrt{\\rho_{\\rm{ISL}}x_{\\rm{ISL}}[n]+w_{\\rm{ISL}}[n]},\\tag{15}$$\nwhere \u03c1ISL is defined in (11), and wISL[n] \u223c CN(0, 1). For DF, \u03c1ISL = 0 in the case of unsuccessful decoding at R.\n\nIn order to improve the link reliability, satellite D then performs maximum ratio combining (MRC) of the two signals, the one received directly from the GU on the G2S link and the one relayed by R on the ISL link. For both AF and DF, after suitable normalization, we can write the MRC output as\n\n$$\\widetilde{y}_{\\vartheta}[n]=\\widetilde{h}_{\\vartheta}[n]x[n]+\\widetilde{w}[n],\\tag{16}$$\n\nwhere $\\vartheta\\in\\{\\text{AF},\\text{DF}\\}$, $\\widetilde{w}[n]$ is a zero-mean complex Gaussian noise with variance 1 and $\\widetilde{h}[n]$ is the equivalent channel at time step $n$. In the case of AF, we have\n\n$$\\widetilde{h}_{\\text{AF}}[n]=\\sqrt{\\rho_{\\text{D}}[n]|h_{\\text{D}}[n]|^{2}+\\frac{\\rho_{\\text{ISL}}\\rho_{\\text{R}}[n]|h_{\\text{R}}[n]|^{2}}{\\rho_{\\text{ISL}}+q[n]}}\\tag{17}$$\n\n$$\\widetilde{y}_{\\text{AF}}[n]=\\sqrt{\\rho_{\\text{D}}[n]\\left(\\frac{h_{\\text{D}}[n]}{\\widetilde{h}_{\\text{AF}}[n]}\\right)^{*}y_{\\text{D}}[n]+}\\tag{18}$$ $$+\\frac{\\sqrt{\\rho_{\\text{ISL}}q[n]\\rho_{\\text{R}}[n]}}{\\rho_{\\text{ISL}}+q[n]}\\left(\\begin{array}{c}\\\\ \\\\ \\end{array}\\right)^{*}y_{\\text{ISL}}[n].$$\nInstead, for DF,\n\n$$\\tilde{\\tilde{h}}_{\\rm H}\\tilde{\\tilde{\\rm H}}_{\\rm H}=\\sqrt{\\rho_{\\rm H}}\\left(\\left[\\frac{h_{\\rm H}\\tilde{\\rm H}_{\\rm H}}{h_{\\rm H}\\tilde{\\rm H}_{\\rm H}}\\right]\\right)+\\sqrt{\\rho_{\\rm H}}\\tilde{\\tilde{\\rm H}}_{\\rm H}\\tilde{\\tilde{\\rm H}}_{\\rm H}\\tilde{\\rm H}_{\\rm H}\\tag{19}$$\n\nNotice that $\\Delta$F is continuous by replacing the $\\tilde{\\tilde{\\rm H}}_{\\rm H}$ and $\\tilde{\\tilde{\\rm H}}_{\\rm H}$. (20) as a multiple $0$-fold for pure water.\n"
    },
    {
        "level": "##",
        "title": "Iii. Bler Analysis",
        "content": "\nIn this section, we derive the final performance in terms of BLER for the combined signal at satellite D. Consider the AWGN channel $\\mathcal{Y}=\\sqrt{\\rho}\\mathcal{H}\\mathcal{X}+\\mathcal{W}$ with $\\mathcal{W}\\sim\\mathcal{CN}(0,1)$ and $\\mathcal{X}$ belonging to a size-$S$ modulation $\\mathcal{S}$. Let $H\\left(\\mathcal{X}|y,\\sqrt{\\rho}h\\right)$ be the equivocation on such channel when $\\mathcal{Y}=y$ and $\\mathcal{H}=h$, i.e.,\n\n$$H\\left(\\mathcal{X}|y,\\sqrt{\\rho}h\\right)=-\\sum_{s\\in\\mathcal{S}}p\\left(s|y,\\sqrt{\\rho}h\\right)\\log_{2}p\\left(s|y,\\sqrt{\\rho}h\\right)\\tag{21}$$\n\n$\\cdot$\nwhere\n\n$$p\\left(s|y,\\sqrt{\\rho}h\\right)=\\frac{\\mathrm{e}^{-\\mathrm{j}\\,\\mathrm{y}\\cdot\\sqrt{\\rho}h^{\\mathrm{T}}}}{\\sum_{n^{\\prime}\\in\\mathrm{C}}\\mathrm{e}^{-\\mathrm{j}\\,\\mathrm{y}\\cdot\\sqrt{\\rho}h^{\\mathrm{T}}}}\\tag{22}$$\n\nThen, the (conditional) natural information (MI) per bit is given by\n\n$$C(y,\\sqrt{\\rho}h)=1-\\frac{1}{\\log_{2}S}H\\left(X|y,\\sqrt{\\rho}h\\right)\\tag{23}$$\n\nSuppose that the model of length $N_{c}$ symbols is transmitted on the AWGN channel and denote $\\mathrm{y},\\mathrm{h},\\rho$ be length $\\mathrm{y}_{c}$. Na vectors of realized control nodes and denote $\\mathrm{y},\\mathrm{h},\\rho$ be length $\\mathrm{y}_{c}$. Na SNR values, respectively. We assume that the channel decoder has a block error problem given by[4]\n\n$$P_{H}(e|\\mathbf{y},\\sqrt{\\rho}\\odot\\mathrm{h})=1,\\ \\frac{1}{0},\\ \\frac{\\overline{C}(\\mathbf{y},\\sqrt{\\rho}\\odot\\mathrm{h})}{\\overline{C}(y,\\sqrt{\\rho}\\odot\\mathrm{h})}\\leq C_{T}\\tag{24}$$\n\nwhere\n\n$$\\overline{C}(\\mathbf{y},\\sqrt{\\rho}\\odot\\mathrm{h})=\\frac{1}{N_{c}}\\sum_{n^{\\prime}\\in\\mathrm{C}}C(y_{n}|h,\\sqrt{\\rho}_{n}|h|n)\\tag{25}$$\n\ngives the variance of all per bit on the code block. In (24), $C_{T}$ is the threshold $\\mathrm{M}$ on the AWGN channel for the channel code. Intuitively, (24) the model of the channel decoder on the transmission channel is large enough, the signal is correctly decoded, otherwise it is lost. Typically, (24) is a good \n"
    },
    {
        "level": "##",
        "title": "A. Soft Handover With Noiseless Isl",
        "content": "\nIn this subsection, we derive the performance of soft handover, for both AF and DF, in the limit of \u03c1ISL \u2192 \u221e. In such case, the considered system is equivalent to a virtual\n1 \u00d7 2 single-input multiple-output system, in which there is only one satellite with two antennas, and the received signal is\n(yD, yR). Notice that, given the elevations of the two satellites and thus the values of (\u03c1D, \u03c1R), the two branches of the received signal are independent in our model.\n\nIn such a scenario, the optimal receiver performs MRC\nbefore decoding, as in the AF case. The instantaneous SNR after MRC will then be given by\n\n$$\\lim_{\\rho_{\\rm LSL}\\rightarrow\\infty}|\\widetilde{h}_{\\rm AF}[n]|^{2}=\\rho_{\\rm D}[n]|h_{\\rm D}[n]|^{2}+\\rho_{\\rm R}[n]|h_{\\rm R}[n]|^{2}\\tag{28}$$\n\nThe advantage of AF-based soft handover with respect to hard handover, on a noiseless ISI, is then obvious, as the hard-handover SNR is equal to $\\rho_{\\rm D}[n]|h_{\\rm D}[n]|^{2}$, so that hard handover is more prone to B-state channel conditions on the link between GU and satellite D. Notice that this conclusion can be generalized to a noisy ISI, as the SNR after MRC will always be larger than in the hard-handover case.\n\nOn the noiseless ISI, the DF strategy corresponds to separate decoding on ${\\bf y}_{\\rm D}$ and ${\\bf y}_{\\rm R}$, so that the transmitted block is lost if and only if both decoding attempts fail. Thus:\n\n$$\\lim_{\\rho_{\\rm ISL}\\rightarrow\\infty}P_{B,{\\rm SH},{\\rm DF}}(e)=\\mathbb{E}_{\\mathbf{\\rho}_{\\rm D},\\mathbf{\\rho}_{\\rm R}}\\left\\{\\mathbb{E}_{\\bf y_{\\rm D},{\\rm h}_{\\rm D}}P_{B}(e|{\\bf y}_{\\rm D},\\sqrt{\\mathbf{\\rho}_{\\rm D}}\\odot{\\rm h}_{\\rm D})\\right.$$ $$\\left.\\times\\mathbb{E}_{\\bf y_{\\rm R},{\\rm h}_{\\rm R}}P_{B}(e|{\\bf y}_{\\rm R},\\sqrt{\\mathbf{\\rho}_{\\rm R}}\\odot{\\rm h}_{\\rm R})\\right\\}\\tag{29}$$\nWhile DF proves suboptimal with respect to AF for a noiseless ISL, on a noisy ISL this may not be true in general, as the latter combines the noise on the ISL with the noise on the G2S link between the GU and satellite R.\n"
    },
    {
        "level": "##",
        "title": "Iv. Simulation Results",
        "content": "\nIn Table I, we report the main parameters of the simulation.\n\nWe consider a single satellite pass5. In that pass, we focus on the time window for which satellites T and S have the highest elevations (both larger than \u03b4min) in the constellation.\n\nThe elevation time series for both satellites is quantized on the set of values {30\u25e6, 45\u25e6, 60\u25e6, 70\u25e6}, for which there exist tables of channel parameters in [7]. More precisely, we consider a carrier frequency fG2S = 2.2 GHz, and the suburban environment, so that the parameter tables for the different elevations can be found in [7, Annex 2, Sect. 2.2]. Given the parameters, the channel coefficients for the two G2S links are then generated independently. The visibility interval of both satellites lasts for about 2 minutes, during which we suppose that 500 code blocks are transmitted.\n\nIn the simulations, we consider as the independent variable a reference SNR, which is the LoS SNR when the satellite is at the minimum distance (i.e., the maximum elevation) from the\n\nGU. In other words, the reference SNR for satellite $\\ell=\\{$S, T$\\}$ is given by\n\n$$\\rho_{\\rm ref}=\\frac{P_{\\rm GU}G_{\\rm GU}G_{\\ell}L_{\\rm ref}}{N_{0}W_{\\rm G2S}}\\tag{30}$$\n\nwhere\n\n$$L_{\\rm ref}=\\left(\\frac{c}{4\\pi h_{0}f_{\\rm G2S}}\\right)^{2}\\tag{31}$$\nso that the actual LoS SNR is \u03c1\u2113[n] = \u03c1refL\u2113[n]/Lref. With the parameters reported in Table I, a reference SNR of 20 dB\ncorresponds to a transmitted power PGU of about 50 mW.\n\n| Parameter                      | Notation   | Value           |\n|--------------------------------|------------|-----------------|\n| Geometrical model              |            |                 |\n| Orbit height                   |            |                 |\n| h                              |            |                 |\n| 0                              |            |                 |\n| 550 km                         |            |                 |\n| Orbit inclination              |            |                 |\n| i                              |            |                 |\n| K                              |            |                 |\n| 45                             |            |                 |\n| \u25e6                              |            |                 |\n| Constellation size             |            |                 |\n| M                              |            |                 |\n| {                              | 42         |                 |\n| ,                              |            |                 |\n| 63                             | }          |                 |\n| GU coordinates                 |            |                 |\n| (                              |            |                 |\n| \u03bb                              |            |                 |\n| GU                             |            |                 |\n| , \u03c6                            |            |                 |\n| GU                             |            |                 |\n| )                              |            |                 |\n| (                              |            |                 |\n| 45                             |            |                 |\n| \u25e6                              |            |                 |\n|                                |            |                 |\n| N,                             |            |                 |\n| 7                              |            |                 |\n| \u25e6                              |            |                 |\n|                                |            |                 |\n| E)                             |            |                 |\n| Minimum elevation              |            |                 |\n| \u03b4                              |            |                 |\n| min                            |            |                 |\n| 25                             |            |                 |\n| \u25e6                              |            |                 |\n| Ground-to-satellite (G2S) link |            |                 |\n| Carrier frequency              |            |                 |\n| f                              |            |                 |\n| G2S                            |            |                 |\n| 2.2 GHz                        |            |                 |\n| Transmitted power              |            |                 |\n| P                              |            |                 |\n| GU                             |            |                 |\n| See text                       |            |                 |\n| GU antenna gain                |            |                 |\n| G                              |            |                 |\n| GU                             |            |                 |\n| 0 dBi                          |            |                 |\n| Satellite antenna gain         |            |                 |\n| G                              |            |                 |\n| S                              |            |                 |\n| , G                            |            |                 |\n| T                              |            |                 |\n| 50 dBi                         |            |                 |\n| Signal bandwidth               |            |                 |\n| W                              |            |                 |\n| G2S                            |            |                 |\n| 5 MHz                          |            |                 |\n| Environment                    | -          | Suburban        |\n| Channel model parameters       | -          | From [7]        |\n| Noise level                    |            |                 |\n| N                              |            |                 |\n| 0                              |            |                 |\n| -174 dBm/Hz                    |            |                 |\n| Inter-satellite link (ISL)     |            |                 |\n| Carrier frequency              |            |                 |\n| f                              |            |                 |\n| ISL                            |            |                 |\n| {                              | 2          |                 |\n| ,                              |            |                 |\n| 193                            | }          |                 |\n| THz                            |            |                 |\n| Transmitted power              |            |                 |\n| P                              |            |                 |\n| T                              |            |                 |\n| {                              | 5          |                 |\n| ,                              |            |                 |\n| 10                             |            |                 |\n| ,                              |            |                 |\n| 15                             |            |                 |\n| ,                              |            |                 |\n| 20                             |            |                 |\n| ,                              |            |                 |\n| 25                             | }          |                 |\n| dBW                            |            |                 |\n| Ambient noise temperature      |            |                 |\n| T                              |            |                 |\n| 0                              |            |                 |\n| 7000 K                         |            |                 |\n| Signal bandwidth               |            |                 |\n| W                              |            |                 |\n| ISL                            |            |                 |\n| 2%                             |            |                 |\n| f                              |            |                 |\n| ISL                            |            |                 |\n| TX/RX antenna gain             |            |                 |\n| G                              |            |                 |\n| 0                              |            |                 |\n| {                              | 60         |                 |\n| ,                              |            |                 |\n| 90                             | }          |                 |\n| dBi                            |            |                 |\n| Half-power beam width          |            |                 |\n| \u03b8                              |            |                 |\n| 3dB                            |            |                 |\n| 202                            |            |                 |\n| .                              |            |                 |\n| 5                              | \u00d7          | 10              |\n| \u2212                              |            |                 |\n| G                              |            |                 |\n| 0                              |            |                 |\n| /                              |            |                 |\n| 20                             |            |                 |\n|                                |            |                 |\n| deg                            |            |                 |\n| Misalignment variance          |            |                 |\n| \u03c3                              |            |                 |\n| 2                              |            |                 |\n| p                              |            |                 |\n| See text                       |            |                 |\n| Transmitted signal format      |            |                 |\n| Channel coding rate            |            |                 |\n| R                              |            |                 |\n| c                              |            |                 |\n| 1/2                            |            |                 |\n| Channel code                   | -          | (3,6) LDPC code |\n| Code threshold                 |            |                 |\n| C                              |            |                 |\n| T                              |            |                 |\n| 0.5714 bits                    |            |                 |\n| Modulation format              | -          | QPSK (          |\n| S                              |            |                 |\n| = 4                            |            |                 |\n| )                              |            |                 |\n\nA. Comparison between AF and DF\nWe first compare AF and DF in the scenario summarized by the parameters in Table I. In particular, we consider the case in which:\n\n- there is no misalignment in the ISL; - the angular distance between the two satellites is \u03b10 =\n0.15 rad, corresponding to (about) M = 42 satellites in\nthe same orbit;\n- the carrier frequency on the ISL is fISL = 193 THz (in the optical band), with an antenna gain G0 = 90 dB.\n\nFigure 3 shows the numerical results. Blue curves represent the BLER for DF, with three different values of the transmit power PT on the ISL, namely PT \u2208 {5, 10, 20} dBW. For the same values of PT , red curves depict the performance of AF. The thick black curve shows the BLER of hard handover, while the thick purple and green curves correspond to the BLER for AF and DF, respectively, with an infinite SNR on the ISL (or, equivalently, a noiseless ISL).\n\nAs it can be seen, at BLER\n=\n10\u22124 and with the parameter setting of the figure, the ultimate gain of soft handover, compared to hard handover, is 16 dB. Most of this potential advantage can be achieved by adopting an AF\nrelaying strategy with a transmitted power of PT = 20 dBW.\n\nThe comparison between red and blue curves reveals that, for low-to-intermediate transmitted power (PT = 10 dBW), AF\nand DF show a comparable performance. Instead, for large PT , AF improves on DF, as the former seems to exploit better the diversity gain offered by multisatellite reception, in accordance with the analysis of Section III-A.\n\nIt is worth commenting the shape of the curves for different SNR values. For reference SNR lower than 10 dB, BLER curves decrease with SNR as expected, but for middle SNR values (say, around 10 to 12-15 dB, depending on the curve) there is a floor. This is due to the fact that, in the elevation time series, there is a time window where both satellites have a quantized elevation as low as 45\u25e6, so that the channel model for both satellites shows a more severe impact of B-state events. As a result, the error floor appears when the reference SNR is not large enough to yield a good performance also in this time window.\n\nB. Increasing the Size of the Constellation After obtaining in the previous subsection the BLER performance for a number of satellites in the same orbit equal to M = 42, in this subsection we obtain the same results for M = 63, corresponding to an angular distance between neighbor satellites of \u03b10 = 0.1 rad. In both cases, the elevation time series for the two satellites are very similar, with one delayed with respect to the other. For M = 63, when the two satellites have about the same elevation, this elevation is close to 60\u25e6, while for M = 42 it is close to 45\u25e6, as already mentioned in Section IV-A. All the other parameters are as in Figure 3.\n\nFigure 4 shows the BLER performance in the new scenario with more satellites. Blue curves are obtained for DF while red curves are for AF. As it can be seen, the maximum achievable gain of soft handover is reduced to about 2\u20132.5 dB. In this scenario, DF slightly outperforms AF for PT = 5 dBW, as its performance is not affected by the noise on the GU-to-T\nlink, while for larger PT AF is better than DF, as in Figure 3.\n\nOverall, we can say that increasing the size of the constellation makes soft handover less awarding, as, for N = 63 satellites, a BLER of 10\u22123 is obtained with hard handover for a reference SNR equal to about 13 dB, while the same value for N = 42\nsatellites requires a reference SNR of at least 15 dB and a large ISL transmitted power (with AF). Also, we conclude that, in the simulated scenario, DF does not achieve the performance gain that would repay for its complexity increase with respect to AF.\n\nFinally notice that, in this scenario, since there is always at least one satellite with quantized elevation larger than 45\u25e6, there is no error floor for middle SNR values. C. The Impact of Misalignment Finally, we consider the impact on performance of misalignment in the ISL. Following [8], we consider two different carrier frequencies on the ISL, namely, fISL = 193 THz, as in Sections IV-A and IV-B, and fISL = 2 THz. In both cases, we adopt Kraus' approximate formula [12] to derive the halfpower beamwidth given the antenna gain, as shown in Table I.\n\nFor fISL = 193 THz, a gain of 90 dB yields a half-power beamwidth of 0.0064\u25e6, while for fISL = 2 THz, we have set a gain G0 = 60 dB, which results in a half-power beamwidth equal to 0.2\u25e6. The misalignment stays constant over a single code block.\n\nFor the two bands, Figures 5-6 show, for both DF and AF, the reference SNR needed to achieve BLER = 10\u22125, as a function of \u03c32\np, the misalignment variance. In Figure 5, which is for M = 42 satellites, the transmitted power on the ISL is set to PT = 25 dBW, while in Figure 6, for M = 63 satellites, PT = 15 dBW. The figures show similar behavior in the two bands. For low enough \u03c32\np, the performance reaches that of the no-misalignment case. Instead, for sufficiently high \u03c32\np, the soft-handover performance reaches the hard-handover BLER, with no help anymore from the ISL. As it was to be expected, the optical band is much more sensitive, due to the narrower beam. For instance, with the parameter settings of Figure 6 and threshold reference SNR equal to 12 dB, a 15 times larger misalignment variance can be tolerated in the case with fISL =\n2 THz, compared to the case with fISL = 193 THz. It is worth noting that, in both figures and for \u03c32\np = 10\u22123, the performance in the THz band is still optimal, while the optical scenario shows already a completely spoiled contribution of the ISL. Of course, the larger bandwidth in the optical band allows to serve more users at the same time, and to potentially reduce the number of satellites connected to the ground by feeder links.\n\nIt is also worth noting that, when misalignment starts to worsen performance, the difference between AF and DF disappears.\n"
    },
    {
        "level": "##",
        "title": "V. Conclusions",
        "content": "\nWe considered a constellation of LEO satellites connected to a handheld device on the ground. In particular, we studied the benefits of soft handover in the UL from the physicallayer point of view. We have performed simulation results in a realistic scenario, where the impairments are taken into account both in the ground-to-satellite and the ISL.\n\nOur results show that, although implying a larger computation complexity, soft handover can achieve a substantial performance gain over hard handover. Considering different relaying techniques, AF should be preferred to DF, as the former shows essentially the same performance of the latter for low-to-medium transmitted power on the ISL, and a definite advantage for large transmitted power. Moreover, AF has a lower complexity for the relaying satellite. Adding satellites to the constellation improves the performance of both hard handover and soft handover, and reduces the achievable gain of soft handover. Finally, our results show how important is to maintain a suitable alignment of the satellite antennas, to achieve the potential gain of soft handover, especially in the optical band.\n"
    },
    {
        "level": "##",
        "title": "Acknowledgment",
        "content": "\nFunded by the European Union, under ANTERRA\n101072363 HORIZON-MSCA-2021-DN-01. Views and opinions expressed are however those of the authors only and do not necessarily reflect those of the European Union. Neither the European Union nor the granting authority can be held responsible for them.\n"
    },
    {
        "level": "##",
        "title": "References",
        "content": "\n[1] U. Gustavsson, P. Frenger, C. Fager, T. Eriksson, H. Zirath, F. Dielacher,\nC. Studer, A. Parssinen, R. Correia, J. N. Matos, D. Belo, and N. B. Carvalho, \"Implementation challenges and opportunities in beyond-5G\nand 6G communication,\" *IEEE Journal of Microwaves*, vol. 1, no. 1,\npp. 86\u2013100, 2021.\n[2] N. Rajatheva, I. Atzeni, S. Bicais, E. Bjornson, A. Bourdoux, S. Buzzi,\nC. D'Andrea, J.-B. Dore, S. Erkucuk, M. Fuentes, K. Guan, Y. Hu, X. Huang, J. Hulkkonen, J. M. Jornet, M. Katz, B. Makki, R. Nilsson, E. Panayirci, K. Rabie, N. Rajapaksha, M. Salehi, H. Sarieddeen, S. Shahabuddin, T. Svensson, O. Tervo, A. Tolli, Q. Wu, and W. Xu, \"Scoring the terabit/s goal: Broadband connectivity in 6G,\" 2021.\n[3] E. Juan, M. Lauridsen, J. Wigard, and P. Mogensen, \"Handover solutions\nfor 5G low-earth orbit satellite networks,\" *IEEE Access*, vol. 10, pp.\n93 309\u201393 325, 2022.\n[4] G. Barros, J. Vieira, F. Ganhao, L. Bernardo, R. Dinis, P. Carvalho,\nR. Oliveira, and P. Pinto, \"A soft-handover scheme for LEO satellite\nnetworks,\" in 2013 IEEE 78th Vehicular Technology Conference (VTC Fall), 2013, pp. 1\u20135.\n[5] Y. Omid, Z. M. Bakhsh, F. Kayhan, Y. Ma, and R. Tafazolli, \"Space\nMIMO: Direct unmodified handheld to multi-satellite communication,\"\n2023.\n[6] \"3rd generation partnership project; technical specification group radio\naccess network: study on new radio (NR) to support nonterrestrial\nnetworks (release 15),\" June 2018.\n[7] \"Recommendation\nof\nradiocommunication\nsector\nof\ninternational\ntelecommunication union: propagation data required for the design systems in the land mobile-satellite service (release 11),\" August 2019.\n[8] S. Nie and I. F. Akyildiz, \"Channel modeling and analysis of inter-smallsatellite links in terahertz band space networks,\" IEEE Transactions on Communications, vol. 69, no. 12, pp. 8585\u20138599, 2021.\n[9] E. G\u00a8uven, O. B. Yahia, and G. Karabulut-Kurt, \"Multi-state intersatellite channel models,\" in 2023 International Balkan Conference on Communications and Networking (BalkanCom), 2023, pp. 1\u20136.\n[10] M. Richharia\nand L. Westbrook,\nSatellite\nSystems for Personal\nApplications: Concepts and Technology, ser. Wireless Communications\nand\nMobile\nComputing.\nWiley,\n2010.\n[Online].\nAvailable:\nhttps://books.google.it/books?id=TC1KZTaCLU8C\n[11] L. M. Kells, W. F. Kern, and J. R. Bland, Plane and spherical\ntrigonometry.\nMcGraw Hill Book Company, Inc., 1940.\n[12] J. D. Kraus and R. J. Marhefka, *Antenna for all applications*. McGraw-\nHill, 2002."
    }
]