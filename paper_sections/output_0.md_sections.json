[
    {
        "level": "#",
        "title": "Bistatic Doppler Frequency Estimation With Asynchronous Moving Devices For Integrated Sensing And Communications",
        "content": "\nGianmaria Ventura\u2020, *Graduate Student Member, IEEE*, Zaman Bhalli\u2020, *Graduate Student Member, IEEE*, Michele Rossi\u2020\u2217 *Senior Member, IEEE*, Jacopo Pegoraro\u2020, Member, IEEE\n\n  Abstract\u2014In this letter, we present for the first time a method\nto estimate the bistatic Doppler frequency of a target with clock\nasynchronous and mobile Integrated Sensing And Communication\n(ISAC) devices. Existing approaches have separately tackled\nthe presence of phase offsets due to clock asynchrony or the\nadditional Doppler shift due to device movement. However,\nin real ISAC scenarios, these two sources of phase nuisance\nare concurrently present, making the estimation of the target's\nDoppler frequency particularly challenging. Our method solves\nthe problem using the sole wireless signal at the receiver, by\ncomputing Channel Impulse Response (CIR) phase differences\nacross different multipath components and subsequent time\ninstants. In this way, we cancel out phase offsets. Then, we\nconstruct a system of equations that allows disentangling the\ntarget's Doppler frequency from that of the moving device. The\nproposed method is validated via simulation, exploring the impact\nof different system parameters. Numerical results show that our\napproach is a viable way of estimating Doppler frequency in\nbistatic asynchronous ISAC scenarios with mobile devices.\n\n  Index Terms\u2014Integrated sensing and communication, clock\nasynchrony, bistatic sensing, mobile devices, Doppler frequency.\n"
    },
    {
        "level": "##",
        "title": "I. Introduction",
        "content": "\nIntegrated Sensing And Communication (ISAC) has been identified as a prominent feature of next-generation wireless networks, endowing them with perception capabilities by exploiting the radar principle [1]. Among the objectives of ISAC systems, estimating the Doppler frequency caused by targets of interest is of key importance. It enables several applications such as movement speed estimation, enhanced resolution in target detection and tracking, target recognition, and human sensing for remote healthcare [2], [3].\n\nIn bistatic ISAC, where the transmitter (TX) and receiver\n(RX) are spatially separated, the main challenge is the timevarying relative drift between their clocks, which is referred to as *asynchronism*. Clock asynchronism causes Timing Offset\n(TO), Carrier Frequency Offset (CFO), and a random Phase Offset (PO) across different transmissions. Such offsets hinder coherent processing of the channel measurements across time, introducing errors in the estimate of the target's parameters, including the Doppler frequency [4]. Moreover, in real ISAC deployments, an additional Doppler frequency shift is caused by the movement of the TX or RX device, which are usually considered to be static in the ISAC literature. While CFO is the same for all propagation paths [5], but changes quickly over time, the device movement evolves slowly but causes a Engineering.\n\ndifferent frequency shift on each propagation path. This makes the combination of Doppler shift due to device movement and CFO particularly challenging to compensate for. Existing solutions have either focused on *moving* monostatic radar systems, which are not affected by CFO and PO [6], or have tackled asynchronous ISAC systems with *static* devices [5],\n[7]\u2013[9]. Hence, a key limitation of all these approaches is that they do not work in realistic scenarios where ISAC devices are both asynchronous *and* mobile. In this setting, the Doppler shift due to the movement of devices adds up to the CFO, and it is hard to disentangle from the target's Doppler frequency.\n\nIn this letter, we propose the first approach to estimate the Doppler frequency of a target in bistatic ISAC with asynchronous mobile devices using the sole wireless signal. The key challenge we solve is the superposition of (i) the target Doppler frequency, (ii) the TX or RX Doppler frequency, and (iii) the CFO and PO, where (ii) and (iii) act as a nuisance that hinders the estimation of the target Doppler. The proposed algorithm obtains phase measurements from different multipath reflections in the Channel Impulse Response (CIR) across time. Then, it removes phase offsets by computing phase differences between each path and the Line-of-Sight (LoS) path, leveraging the fact that phase offsets are constant for all propagation paths. In a second step, time-domain phase differences for each propagation path are obtained and used to construct a non-linear system with one equation per multipath component. Different multipath components are affected by the TX or RX motion in different ways, depending on the path geometry. We exploit this as a source of *diversity* to reduce the number of system variables. As a result, the system is solvable if at least 2 multipath components from static scatterers are available. In this case, the target Doppler frequency can be estimated and refined by aggregating results over a short processing window.\n\nThe main contributions of this letter are: 1) We propose the first solution to the problem of estimating the Doppler frequency of a target in bistatic ISAC systems with mobile asynchronous devices, affected by CFO and PO.\n\n2) Our solution is based on an original approach that processes CIR phase measurements across multipath components and subsequent time frames, removing the undesired phase offsets caused by asynchrony and TX or RX movement.\n\n3) We validate the proposed algorithm via numerical simulation under different system configurations, showing that it provides a viable way to estimate Doppler frequency in realistic bistatic ISAC systems.\n"
    },
    {
        "level": "##",
        "title": "Ii. System Model",
        "content": "\nIn this section, we introduce our system model including the reference scenario, the CIR, and the phase measurements.\n"
    },
    {
        "level": "##",
        "title": "A. Reference Scenario",
        "content": "\nWe consider a 2D scenario including two ISAC devices, namely, a transmitter (TX) and a receiver (RX). The aim is to estimate the bistatic Doppler frequency caused by a moving target of interest, as shown in Fig. 1, by using the channel estimates obtained from the ongoing communication traffic. For simplicity, we assume that the TX is static while the RX moves with velocity vrx(t) with an angle \u03b7(t) with respect to the segment connecting the TX and the RX (LoS segment), where t is the continuous-time variable. The symmetric case where the TX moves and the RX is static leads to similar derivations, as discussed in Section II-B, and it is omitted. The received signal includes M(t) delayed, Dopplershifted, and attenuated copies of the transmitted one, where M(t) corresponds to the number of multipath components caused by scatterers in the environment. As commonly done in ISAC, we only consider first-order reflections since they have significantly higher received power than higher-order ones [10]. Denote by \u03bb = *c/f*c the transmission wavelength, with c being the speed of light and fc the carrier frequency.\n\nThe movement of the m-th scatterer causes a bistatic Doppler shift fD,m(t). The RX movement causes a Doppler shift equal to f rx D,m(t) = (vrx(t) cos \u03bem(t))/\u03bb, where \u03bem(t) is the angle between the elongation of the segment connecting the mth scatterer to the RX and the RX velocity vector. In our scenario, we consider that the M(t) propagation paths can be partitioned as follows: (i) a LoS path, which represents the direct propagation from the TX to the RX (assumed to be available), (ii) a single moving target path, (iii) S(t) static scatterers paths for which fD,m(t) = 0. We assume that the orientation of the RX with respect to the TX is known and it has been compensated for, e.g., by using onboard sensors like a gyroscope.\n"
    },
    {
        "level": "##",
        "title": "B. Channel Model",
        "content": "\nConsider the continuous-time channel between the TX and the RX and denote by \u03c4m(t), \u03b1m(t), and Am(t) the propagation delay, the Angle of Arrival (AoA), and the complex coefficient of the m-th path, respectively. Am(t) accounts for the propagation loss and the complex target reflectivity, hence it contains a phase term that depends on the path.\n\nThe TO, CFO, and random PO are denoted by \u03c4o(t), fo(t), and \u03c8o(t), respectively. Denoting the Dirac delta function by \u03b4\u03c4, the CIR at time t and delay \u03c4 is\n\n$$h(t,\\tau)=e^{j\\psi_{\\rm o}(t)}\\sum_{m=1}^{M(t)}A_{m}(t)e^{j\\vartheta_{m}(t)}\\delta_{\\tau-\\tau_{m}(t)-\\tau_{\\rm o}(t)},\\tag{1}$$\n\nwith $\\vartheta_{m}(t)=2\\pi(f_{\\rm D,m}(t)+f_{\\rm o}(t)+f_{\\rm D,m}^{\\rm x}(t))t$. Note that $f_{\\rm D,m}(t)$ is summed to the CFO and the Doppler shift introduced by the receiver, which act as a nuisance.\n\nIn Single Carrier (SC) systems, e.g. IEEE 802.11ay, the RX estimates the CIR directly using cross-correlation of the received signal with a known pilot sequence. In Orthogonal Frequency Division Multiplexing (OFDM) systems, it can obtain the CIR via Inverse Discrete Fourier Transform (IDFT) from an estimate of the Channel Frequency Response (CFR).\n\nThe CIR estimation is repeated across multiple frames, indexed by k, with period T. Using a common assumption in ISAC and radar processing, we consider a short processing window of K frames [10], where the parameters, M(t), \u03c4m(t), fD,m(t), \u03b1m(t), Am(t), \u03b7(t), \u03bem(t), vrx(t), and consequently the RX motion-induced Doppler shift f rx D,m(t) can be considered constant. Conversely, all the nuisance parameters, \u03c4o(t), fo(t), \u03c8o(t), are time-varying within the window.\n\nThe estimated discrete-time CIR at time kT with k =\n0*, . . . , K* \u2212 1 is\n\n$$h[k,l]=e^{j\\psi_{\\rm o}(kT)}\\sum_{m=1}^{M}A_{m}e^{j\\vartheta_{\\rm o}[m]}\\chi[l-\\tau_{m}-\\tau_{\\rm o}(kT)],\\tag{2}$$\n\nwhere $\\vartheta_{m}[k]=2\\pi(f_{\\rm D,}m+f_{\\rm o}(kT)+f_{\\rm D,}^{\\rm x}m)kT$, $l$ is the discrete delay index, and $M$ is the number of resolvable paths within the window, with $M\\leq M(t)$. In Eq. (2), $\\chi[l]$ replaces the Dirac delta function to account for non-ideal autocorrelation of the pilot sequence (in single carrier systems) or the impact of the finite-length CFR estimate (in OFDM systems). In the following, we focus on estimating the target Doppler frequency under the nuisance due to the CFO, PO, and the RX motion. Hence, we assume that the RX can detect and separate the $M$ multipath components and extract their phase across time. To this end, the TO can be compensated for by obtaining _relative_ delay measurements with respect to the LoS, as done in [5].\n\nOur model is agnostic to the number of available antennas at the RX. Multiple antennas could be used to estimate the AoAs of the different multipath components, which are needed in our processing pipeline. However, our system works even for analog beamforming-based receivers, with a single Radio Frequency (RF) chain, that estimate the AoAs using other techniques, such as that in [5].\n"
    },
    {
        "level": "##",
        "title": "C. Phase Measurements",
        "content": "\nIn this section, we model the phase of each multipath component in the CIR. We consider the phase measurements to be affected by Gaussian noise w[k] \u223c N(0, \u03c32\n\u03d5), where \u03c32\n\u03d5\nis the noise variance. To simplify the equations, we group the phase nuisance terms, which are the same on all propagation paths, into \u03a8o(kT) = \u03c8o(kT) + 2\u03c0fo(kT)kT. Moreover, we use subscripts \u00b7LoS and \u00b7t to refer to quantities related to the LoS and to the target-induced paths, respectively, as shown in Fig. 1. For the paths caused by static scatterers, we use index s = 1*, . . . , S*, where S is the number of\n\nresolvable static scatterers detected in the processing window, with $S=M-2$. The phase of the LoS component is\n\n$$\\phi_{\\rm LoS}[k]=\\Psi_{\\rm o}(kT)+\\angle A_{\\rm LoS}+2\\pi kT\\left(\\frac{v^{\\rm rx}}{\\lambda}\\cos\\eta\\right)+w_{\\rm LoS}[k],\\tag{3}$$\n\nwhere $\\angle\\cdot$ is the phase operator. The phase of the target-induced path is affected by both the Doppler shift caused by the target, $f_{\\rm D,t}$, and by the receiver motion as\n\n$$\\phi_{\\rm t}[k]=\\Psi_{\\rm o}(kT)+\\angle A_{\\rm t}+2\\pi kT\\left(f_{\\rm D,t}+\\frac{v^{\\rm rx}}{\\lambda}\\cos\\xi_{\\rm t}\\right)+w_{\\rm t}[k],\\tag{4}$$\n\nwhere $\\xi_{\\rm t}$ is the angle between the elongation of the segment connecting the target to the RX and the RX velocity vector. The phase of the $s$-th static multipath component is\n\n$$\\phi_{s}[k]=\\Psi_{\\rm o}(kT)+\\angle A_{s}+2\\pi kT\\left(\\frac{v^{\\rm rx}}{\\lambda}\\cos\\xi_{s}\\right)+w_{s}[k].\\tag{5}$$\n\nFrom the CIR, the RX measures $\\texttt{modd}_{2\\pi}(\\phi_{i}[k])$ where $i\\in\\{\\rm t,LoS,s\\}$, $k=0,\\ldots,K-1$, and $\\texttt{modd}_{2\\pi}(\\cdot)$ is the modulo $2\\pi$ division, whose result is in $[0,2\\pi]$.\n"
    },
    {
        "level": "##",
        "title": "Iii. Methodology",
        "content": "\nIn this section, we present our approach for estimating the bistatic Doppler frequency of the target from the phase measurements in Eqs. (3-5). It can be summarized as follows.\n\nA. CFO and PO cancellation. By subtracting the phase of the LoS path from the other phase measurements we cancel out the nuisance component \u03a8o, without estimating it directly.\n\nThis is further detailed in Section III-A.\n\nB. Time-domain phase differencing. By computing timedomain phase differences *for each path*, we cancel out the path-specific phase terms\n\u0338 Ai, with i *\u2208 {*t, LoS, s}, as detailed in Section III-B. This yields phase differences whose value depends on the Doppler shifts of the RX and the target.\n\nC. AoA-based simplification. By leveraging AoA estimation at the RX and the multipath geometry, we make a key simplification in the phase measurements model (see Section III-C). This allows reducing the number of unknowns, making the estimation of the target Doppler frequency feasible if at least 2 static multipath components are detected.\n\nD. Doppler frequency estimation. We formulate the estimation of the target's Doppler frequency as a Nonlinear Least- Squares (NLS) problem across the multipath components (see Section III-D). A closed-form solution using S = 2 static paths is provided next to initialize the NLS problem.\n"
    },
    {
        "level": "##",
        "title": "A. Cfo And Po Cancellation",
        "content": "\nWe subtract $\\phi_{\\rm LoS}[k]$ from $\\phi_{\\rm t}[k]$ and $\\phi_{s}[k]$, obtaining\n\n$$\\tilde{\\phi}_{\\rm t}[k]=\\Omega_{\\rm t}+2\\pi kT\\left(f_{\\rm D,t}+\\frac{v^{\\rm rx}}{\\lambda}\\left(\\cos\\xi_{\\rm t}-\\cos\\eta\\right)\\right)+w^{\\prime}_{\\rm t}[k],\\tag{6}$$\n\n$$\\tilde{\\phi}_{s}[k]=\\Omega_{s}+2\\pi kT\\left(\\frac{v^{\\rm rx}}{\\lambda}\\left(\\cos\\xi_{s}-\\cos\\eta\\right)\\right)+w^{\\prime}_{s}[k],\\tag{7}$$\n\nwhere $\\Omega_{s}=\\angle A_{s}-\\angle A_{\\rm LoS},\\Omega_{\\rm t}=\\angle A_{\\rm t}-\\angle A_{\\rm LoS}$, and $w^{\\prime}_{i}[k]=w_{i}[k]-w_{\\rm LoS}[k],i\\in\\{t,s\\}$ is distributed as ${\\cal N}(0,2\\sigma_{\\phi}^{2})$.\n\nComputing phase differences *cancels out* CFO and PO without estimating them, since they are common to all propagation paths. Despite the absence of CFO and PO in Eq. (6), the estimation of the target's Doppler frequency remains nontrivial due to the presence of the undesired frequency term vrx (cos \u03bet \u2212 cos \u03b7) /\u03bb caused by the receiver movement. Indeed, a direct application of standard Fourier-based processing to estimate the Doppler frequency would fail to separate fD,t from the Doppler due to the RX movement.\n"
    },
    {
        "level": "##",
        "title": "B. Time-Domain Phase Differencing",
        "content": "\nAfter CFO and PO cancellation, the RX computes first-order, time-domain phase differences as $\\Delta_{i}[k]=\\texttt{mod}_{2\\pi}\\big{(}\\tilde{\\phi}_{i}[k]\\big{)}-\\texttt{mod}_{2\\pi}\\big{(}\\tilde{\\phi}_{i}[k-1]\\big{)}$ with $i\\in\\{\\texttt{t},s\\}$ and $k=1,\\ldots,K-1$. The phase differences are expressed as\n\n$$\\Delta_{\\texttt{t}}[k]=2\\pi T\\left(f_{\\texttt{D},\\texttt{t}}+\\frac{v^{\\texttt{rx}}}{\\lambda}\\left(\\cos\\xi_{\\texttt{t}}-\\cos\\eta\\right)\\right)+w_{\\texttt{t}}^{\\prime\\prime}[k],\\tag{8}$$ $$\\Delta_{s}[k]=2\\pi T\\left(\\frac{v^{\\texttt{rx}}}{\\lambda}\\left(\\cos\\xi_{s}-\\cos\\eta\\right)\\right)+w_{s}^{\\prime\\prime}[k],\\tag{9}$$\n\nwhere $w_{i}^{\\prime\\prime}[k]=w_{i}^{\\prime}[k]-w_{i}^{\\prime}[k-1],i\\in\\{\\texttt{t},s\\}$ is a Gaussian noise term with zero mean and variance $4\\sigma_{\\phi}^{2}$.\n\nIn Eq. (8) and Eq. (9), we assume that the channel estimation period $T$ is sufficiently small, so that the phase change between two subsequent frames is smaller than $\\pi$. This allows writing phase differences without the ambiguity due to the mode$\\texttt{l}_{2\\pi}$ operator. From Eq. (8), it can be seen that the noise-free phase differences $\\Delta_{\\texttt{t}}$ and $\\Delta_{s}$ are upper bounded by $2\\pi T(3f_{\\texttt{max}})$, with $i\\in\\{\\texttt{t},s\\}$ and $f_{\\texttt{max}}$ being the maximum Doppler shift caused by the RX (or the target). $f_{\\texttt{max}}$ is a system design parameter that can be set depending on the specific scenario and application. To fulfill the assumption, it is sufficient to impose $|\\Delta_{i}|<\\pi$ which yields $T<1/(6f_{\\texttt{max}})$. The choice of $T$ is further discussed in Section IV.\n"
    },
    {
        "level": "##",
        "title": "C. Aoa-Based Simplification",
        "content": "\nBy inspecting Fig. 1, a key simplification can be made in Eq. (8) and Eq. (9) noticing that\n\n$$\\cos\\xi_{i}=\\cos\\left(\\eta-\\alpha_{i}\\right)=\\cos\\left(\\alpha_{i}-\\eta\\right),\\tag{10}$$\n\nwith $i\\in\\left\\{\\mathrm{t},s\\right\\}$. This substitution removes the dependency on the unknown and path-dependent angle $\\xi_{i}$. The new dependency on $\\alpha_{i}-\\eta$ is easier to handle since the RX estimates $\\alpha_{i}$ and the unknown term $\\eta$ is independent of the propagation paths. Note that, since $\\alpha_{s}$ and $\\alpha_{\\mathrm{t}}$ are estimated by the RX, this operation reduces the unknowns from $S+4$, i.e., $f_{\\mathrm{D,t}},v^{\\mathrm{rx}},\\eta,\\xi_{\\mathrm{t}},\\xi_{1},\\ldots,\\xi_{S}$, to just 3, i.e. $f_{\\mathrm{D,t}},v^{\\mathrm{rx}},\\eta$. This makes Eq. (8) and Eq. (9), for $s=1,\\ldots,S$, a set of $S+1$ equations with 3 unknowns, which can be solved if the number of static multipath components satisfies $S\\geq2$. In the next section, we provide our solution based on NLS.\n"
    },
    {
        "level": "##",
        "title": "D. Doppler Frequency Estimation",
        "content": "\nWe reformulate Eq. (8) and Eq. (9) in vector notation by introducing: the phase differences vector at time kT,\n\u2206[k] = [\u2206t[k], \u22061[k]*, . . . ,* \u2206S[k]]\u22a4, the unknown parameter\n\nvector \u03b8 = [fD,t, \u03b7, vrx]\u22a4, the non-linear vector function g(\u03b8),\nwhich expresses the non-linear relations in Eq. (8) and Eq. (9).\nThe following model holds \u2206[k] = g(\u03b8) + w[k], where\nw[k] \u223c N(0, 4\u03c32\n                  \u03d5I) is the noise vector with components\nw\u2032\u2032\n i [k], i \u2208 {t, 1, . . . , S}. To reduce the impact of noise, we\naverage the measured phase differences over time obtaining\n\u00af\u2206 = \ufffdK\u22121\n        k=1 \u2206[k]/(K \u2212 1).\n  1) Nonlinear least-squares solution: An NLS problem is\nsolved to retrieve an estimate of the unknown parameters\n\narg min \u03b8 || \u00af\u2206 \u2212 g(\u03b8)||2 2, (11)\nfrom which we get the Doppler frequency estimate as the first component of the solution, which we denote by \u02c6fD,t. This problem can be solved using, e.g., the Levenberg-Marquardt algorithm with a suitable initialization [11].\n\n2) Closed form solution: A closed-form solution using 3\nmultipath components is used to initialize the NLS. Consider Eq. (9) with 2 phase measurements from static paths, i.e., s = 1, 2. Using also Eq. (8), a system with 3 equations in\n3 unknowns is attained, which can be solved for \u03b8. Denoting by \u00af\u2206t, \u00af\u22061, and \u00af\u22062 the time-averaged phase differences for the sensing path, and static paths 1 and 2, respectively, we compute\n\n\ufffd . (12) \u02dc\u03b7 = arctan \ufffd \u00af\u22062(cos \u03b11 \u2212 1) \u2212 \u00af\u22061(cos \u03b12 \u2212 1) \u00af\u22061 sin \u03b12 \u2212 \u00af\u22062 sin \u03b11\nThen, \u02c6\u03b7 is obtained as \u02c6\u03b7 = mod2\u03c0(\u02dc\u03b7) if the argument of the arctan is positive and \u02c6\u03b7 = mod2\u03c0(\u02dc\u03b7 + \u03c0) otherwise. Eventually the expression of \u02c6fD,t is\n\n\u02c6fD,t = 1 2\u03c0T \ufffd . (13) \ufffd \u00af\u2206t \u2212 \u00af\u22061 cos(\u03b1t \u2212 \u02c6\u03b7) \u2212 cos \u02c6\u03b7 cos(\u03b11 \u2212 \u02c6\u03b7) \u2212 cos \u02c6\u03b7\nThe solution requires the following conditions to be met:\n(i) \u03b1i \u0338= 0, i *\u2208 {*1, 2, t}, (ii) \u03b1i \u0338= \u03b1\u2113, i \u0338= \u2113 *\u2208 {*1, 2, t}, and\n(iii) \u03b1i \u0338= 2\u02c6\u03b7, i *\u2208 {*1, 2}. Note that violating conditions (i) and\n(ii) correspond to degenerate scenarios in which the LoS path is not available, or two static multipath components have the same AoA. Condition (iii) instead is violated if the AoA of one of the multipath components is equal to 2\u02c6\u03b7.\n"
    },
    {
        "level": "##",
        "title": "Iv. Numerical Results",
        "content": "\nIn this section, we present our simulation environment and numerical results.\n"
    },
    {
        "level": "##",
        "title": "A. Simulation Setup",
        "content": "\nTo validate the solution presented in Section III-D we perform simulations for 28 GHz and 60 GHz carrier frequencies, representing, e.g., Frequency Range 2 (FR2) 5G-NR and IEEE 802.11ay systems, respectively. We generate realistic values of fD,t, \u03a8o[k], vrx, \u03b1s, \u03b1t, and \u03b7 considering low to moderate movement velocities for both the target and the RX. Furthermore, we set a minimum Doppler frequency for the target, fmin, below which we consider it to be static.\n\nAll parameters are summarized in Tab. 1. In addition, we set T = 1/(6fmax) = 0.08 ms to avoid phase ambiguity as discussed in Section III-B. We perform 104 simulations for each set of parameters.\n\n4 , \u03c0\nTarget Doppler frequency [Hz]\nfD,t\n\u00b1U(fmin, fmax)\nLoS-RX velocity angle [rad]\n\u03b7\nU(0, 2\u03c0)\nReceiver velocity [m/s]\nvrx\nU(0, vmax)\nAngle-of-Arrival [rad]\n\u03b1m\nU\n\ufffd\n\u2212 \u03c0\n4\n\ufffd\nCarrier wavelength [cm]\n\u03bb\n{0.5, 1.07}\nMax. RX/target velocity [m/s]\nvmax\n{5, 10}\nMin. RX/target Doppler frequency [Hz]\nfmin\n{40, 18}\nMax. RX/target Doppler frequency [kHz]\nfmax\n{2, 1.9}\nCFO time difference stand. dev. [Hz]\n\u03c3o\n{481, 225}\n\n  The CFO is modeled as a Gaussian random walk fo(kT) =\nfo((k \u2212 1)T) + wo(kT), where fo(0), wo(kT) \u223c N(0, \u03c32\n                                                     o).\n\u03c32\n o is chosen such that the frequency shift in 1 ms is between\n\u00b11 parts-per-million (ppm) of the carrier frequency. We model\nthe PO as \u03c8o(kT) \u223c N(0, \u03c32\n                          o). Note that, since our method\ncancels out the CFO and PO without estimating them, the\nestimation accuracy is independent of their magnitude. The\nCIR phases, \u03d5i[k], are computed using Eqs. (3-5). The error\nvariance on the phase measurements, \u03c32\n                                   \u03d5, is varied to evaluate\nits impact on the estimation, as discussed in the next section.\nThe error on the AoA estimates is modeled as an additive\nGaussian noise with zero mean and variance \u03c32\n                                          \u03b1.\n"
    },
    {
        "level": "##",
        "title": "B. Doppler Frequency Estimation Performance",
        "content": "\nWe evaluate the performance of our Doppler frequency estimation algorithm in terms of normalized absolute estimation error, defined as \u03b5fD,t = |fD,t \u2212 \u02c6fD,t|/|fD,t|.\n\n1) Number of static scatterers: The number of available static scatterers, S, is key in determining the performance of the algorithm. As detailed in Section III-D1, the target Doppler frequency can be estimated as long as at least 2\nstatic scatterers are resolved at the RX. In Fig. 2a, we show that the estimation error is significantly reduced if more static scatterers are available. The median error lies below 5% of the actual Doppler frequency even with S = 2. Increasing S improves the median error and reduces the spread of the error distribution. This is because each scatterer adds one equation to the NLS problem in Eq. (11) without increasing the number of unknowns, leading to a more robust solution.\n\n2) Processing window duration: In Fig. 2b, we evaluate the impact of averaging phase measurements over a longer processing window. A longer aggregation time clearly improves robustness to noise. However, our assumption is that the sensing parameters of the multipath reflections remain constant in the processing window. Hence, the window duration can not be increased arbitrarily but has to be tuned depending on the dynamicity of the multipath environment. As an example, for indoor human sensing applications, the movement velocities involved could be considered constant up to a few tens of milliseconds. In this case, our method provides a median error of about 3% of the true Doppler frequency.\n\n3) Measurements error: In Fig. 2c, we show the Doppler frequency estimation error depending on the noise affecting phase (\u03c3\u03d5), and AoA measurements (\u03c3\u03b1). Note that the phase measurements error depends on the Signal-to-Noise Ratio (SNR) of the received signal as shown in [5]. For high noise variance in the measurements, the estimation becomes noisy, despite the low median normalized error of 0.06. This is due to the required trade-off in the choice of the CIR measurement interval T, which is discussed in the next section.\n\nFig. 2c also shows that the Doppler frequency estimate is not significantly affected by the AoA error, which means the phase measurements error has a much stronger impact.\n\n4) CIR measurement interval analysis: As discussed in Section III-B, T has to be sufficiently small so as to avoid ambiguity in the phase measurements, i.e., the maximum phase shift across subsequent frames should not exceed \u03c0.\n\nHowever, small values of T make the estimation of the Doppler frequency more sensitive to noise due to the structure of Eq. (13). We analyze the impact of increasing T in Fig. 3, showing the average Doppler frequency estimation error, \u00af\u03b5fD,t, and its standard deviation, for different values of the number of static multipath components, S. Thanks to the robustness of the NLS formulation in Eq. (11), our method tolerates increasing T slightly above the maximum value needed to avoid ambiguity, which even yields lower estimation error due to the lower sensitivity to noise. However, further increasing T causes phase ambiguity to occur more often, consequently degrading the system's performance.\n"
    },
    {
        "level": "##",
        "title": "V. Conclusion",
        "content": "\nIn this letter, we proposed the first method to estimate the Doppler frequency of a target in an *asynchronous* ISAC system with *mobile* devices. Our approach can effectively disentangle the target's Doppler frequency from the CFO and the Doppler caused by the device movement. It does so by leveraging\n(i) phase differences across multipath components, (ii) phase differences across time, and (iii) the multipath geometry. The Doppler frequency estimation is thus formulated as an NLS problem that can be solved as long as the LoS and at least 2\npaths (reflections) from static scatterers are available.\n\nOur simulation results show that the proposed method achieves accurate Doppler frequency estimation if the noise in the phase measurements is reasonably low, and it is robust to AoA estimation errors.\n"
    },
    {
        "level": "##",
        "title": "References",
        "content": "\n[1] F. Liu, L. Zheng, Y. Cui, C. Masouros, A. P. Petropulu, H. Griffiths, and\nY. C. Eldar, \"Seventy years of radar and communications: The road from separation to integration,\" *IEEE Signal Processing Magazine*, vol. 40,\nno. 5, pp. 106\u2013121, 2023.\n[2] J. A. Zhang, M. L. Rahman, K. Wu, X. Huang, Y. J. Guo, S. Chen,\nand J. Yuan, \"Enabling joint communication and radar sensing in mobile networks\u2014a survey,\" *IEEE Communications Surveys & Tutorials*, vol. 24, no. 1, pp. 306\u2013345, 2021.\n[3] A. Singh, S. U. Rehman, S. Yongchareon, and P. H. J. Chong, \"Multi-\nResident Non-Contact Vital Sign Monitoring Using Radar: A Review,\" IEEE Sensors Journal, vol. 21, no. 4, pp. 4061\u20134084, 2021.\n[4] J. A. Zhang, K. Wu, X. Huang, Y. J. Guo, D. Zhang, and R. W. Heath,\n\"Integration of radar sensing into communications with asynchronous transceivers,\" *IEEE Communications Magazine*, vol. 60, no. 11, pp. 106\u2013 112, 2022.\n[5] J. Pegoraro, J. O. Lacruz, T. Azzino, M. Mezzavilla, M. Rossi, J. Widmer, and S. Rangan, \"JUMP: Joint communication and sensing with Unsynchronized transceivers Made Practical,\" IEEE Transactions on Wireless Communications, 2024.\n[6] F. Zhang, J. Xiong, Z. Chang, J. Ma, and D. Zhang, \"Mobi2Sense:\nempowering wireless sensing with mobility,\" in Proceedings of the 28th Annual International Conference on Mobile Computing And Networking, ser. MobiCom '22.\nNew York, NY, USA: Association for Computing\nMachinery, 2022, p. 268\u2013281.\n[7] J. Zhao, Z. Lu, J. A. Zhang, S. Dong, and S. Zhou, \"Multiple-Target\nDoppler Frequency Estimation in ISAC with Clock Asynchronism,\" IEEE Transactions on Vehicular Technology, vol. 73, no. 1, pp. 1382\u2013 1387, 2024.\n[8] F. Meneghello, D. Garlisi, N. Dal Fabbro, I. Tinnirello, and M. Rossi,\n\"SHARP: Environment and Person Independent Activity Recognition with Commodity IEEE 802.11 Access Points,\" IEEE Transactions on Mobile Computing, vol. 22, no. 10, pp. 6160\u20136175, 2023.\n[9] K. Wu, J. Pegoraro, F. Meneghello, J. A. Zhang, J. O. Lacruz, J. Widmer,\nF. Restuccia, M. Rossi, X. Huang, D. Zhang *et al.*, \"Sensing in Bi-\nStatic ISAC Systems with Clock Asynchronism: A Signal Processing Perspective,\" *arXiv preprint arXiv:2402.09048*, 2024.\n[10] J. A. Zhang, F. Liu, C. Masouros, R. W. Heath, Z. Feng, L. Zheng, and\nA. Petropulu, \"An overview of signal processing techniques for joint communication and radar sensing,\" IEEE Journal of Selected Topics in\nSignal Processing, vol. 15, no. 6, pp. 1295\u20131315, 2021.\n[11] J. Nocedal and S. Wright, *Numerical optimization*.\nSpringer Science\n& Business Media, 2006."
    }
]