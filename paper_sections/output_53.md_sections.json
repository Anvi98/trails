[
    {
        "level": "#",
        "title": "Channel Orthogonalization With Reconfigurable Surfaces: General Models, Theoretical Limits, And Effective Configuration",
        "content": "\nJuan Vidal Alegr\u00b4\u0131a, Johan Thunberg, Ove Edfors Abstract\u2014We envision a future in which multi-antenna technology effectively exploits the spatial domain as a set of noninterfering orthogonal resources, allowing for flexible resource allocation and efficient modulation/demodulation. Reconfigurable intelligent surface (RIS) has emerged as a promising technology which allows shaping the propagation environment for improved performance. This paper studies the ability of three extended types of reconfigurable surface (RS), including the recently proposed beyond diagonal RIS (BD-RIS), to achieve perfectly orthogonal channels in a general multi-user multiple-input multiple-output (MU-MIMO) scenario. We propose practical implementations for the three types of RS consisting of passive components, and obtain the corresponding restrictions on their reconfigurability. We then use these restrictions to derive closedform conditions for achieving arbitrary (orthogonal) channels. We also study the problem of optimal orthogonal channel selection for achieving high channel gain without active amplification at the RS, and we propose some methods with satisfying performance. Finally, we provide efficient channel estimation and RS configuration techniques such that all the computation, including the channel selection, may be performed at the base station (BS). The numerical results showcase the potential and practicality of RS channel orthogonalization, thus taking a step towards orthogonal spatial domain multiplexing (OSDM).\n\n  Index Terms\u2014Reconfigurable surface (RS), channel orthog-\nonalization, Beyond diagonal reconfigurable intelligent surface\n(BD-RIS), MU-MIMO, orthogonal spatial domain multiplexing\n(OSDM).\n\nI. INTRODUCTION\nM\nODERN wireless communication systems tend to favor the use of modulations based upon orthogonal timefrequency resources, which may be employed independently without interfering each other. This can be seen in the popular orthogonal frequency division multiplexing (OFDM) [2], considered in most current wireless communication standards, but also in more recent proposals such as orthogonal time frequency space (OTFS) [3], where the orthogonality is conversely achieved in the delay-Doppler domain. On the other hand, since the introduction of MIMO technology [4], the spatial domain has become a new resource which, in the same way as frequency or time, can be exploited for simultaneous transmission of independent streams of data. We may thus expect that efficient exploitation of the spatial domain may favor the use of techniques to divide it into a set of orthogonal resources, already hinted by the derivation of MIMO capacity [5]. The extra challenge of the spatial domain comes from the fact that the propagation channel is scenario dependent, and we may have some limitations when it comes to channel estimation, as well as precoding/decoding [6].\n"
    },
    {
        "level": "##",
        "title": "A. Motivation",
        "content": "\nMulti-user MIMO (MU-MIMO) [7] stands out as one of the main solutions for base station (BS) operation in modern wireless communication systems. Massive MIMO [8], the large-scale version of MU-MIMO, has proved to be key in the development of 5G [9], owing its fame to the improved spectral efficiency [10] and energy efficiency [11] from increasing the number of antennas at the BS. An important feature of massive MIMO is that, under rich multipath propagation, increasing the antennas at the BS leads to channel hardening and favorable propagation [12]. This means that the channel matrix becomes close to a semi-unitary matrix, allowing for enhanced multiplexing of user equipments (UEs) in the spatial domain at reduced complexity. Channel hardening has been observed to a fair extent in real measurements [13]; however, perfect channel orthogonality cannot be generally assured, specially when considering reduced array sizes or scarcely scattering environments. On the other hand, if we consider some of the technologies beyond massive MIMO, such as cell-free massive MIMO [14] or extra-large MIMO (XL- MIMO) [15]\u2014which are under consideration for upcoming 6G [9], [16]\u2014channel hardening and favorable propagation become even more compromised due to the non-stationarities of the channel when antennas have physically large separation [15], [17], [18]. Moreover, the current interest in exploiting higher frequency bands, such as millimeter wave (mmW) and terahertz (THz) [16], reduces the validity of the rich scattering assumption due to the limited reflections and high insertion losses at these bands [19], [20].\n\nReconfigurable intelligent surface (RIS) [21], [22], also known as intelligent reflective surfaces (IRS), is a technology with potential to become a key enabler for next generation communication systems [16], [22]. RIS provides energy-efficient control over the propagation channel [21], [22], since it typically consists of a large number of passive reconfigurable elements whose reflection coefficients may be conveniently selected to generate adaptable reflections. Much of the research on RIS has focused on its impressive beamforming gains [22], [23]. However, RIS may also be employed for improving the multiplexing capabilities in general MIMO scenarios. For example, [24], [25] proposes to employ the RIS reflection to increase the effective rank of a MIMO channel, where [25] further provides experimental validation of this use case. Moreover, RIS optimizations based on capacity-related metrics also lead to improved multiplexing performance under certain scenarios [26], [27].\n\nWe propose to use RIS-related technology to further enhance the multiplexing performance by enforcing channel orthogonality. The aim is to converge towards the spatial converse of OFDM, which we denote orthogonal spatial domain multiplexing (OSDM). This problem has been treated to some extent in [28], where the authors propose to use RIS to eliminate the interference between transceiver pairs. However, [28] focuses on an scenario with perfect channel state information (CIS) knowledge with direct channel blockage, and where the cascaded channel through the RIS consists of a pure line-of-sight (LoS) channel, which may limit the validity of the results in more general scenarios. Note also that channel estimation in RIS is one of the main challenges faced by this technology due to the large pilot overhead required to estimate the cascaded channel coefficients [29]. Furthermore, in MU- MIMO we may have some extra degrees of freedom (DoF) by allowing for more general orthogonal MIMO channels [30] other than the identity channel enforced in [28].\n\nSome extended reconfigurable surface (RS) technologies have been studied in the literature beyond RIS. For example, [31], [32] consider the use of beyond diagonal RIS (BD-RIS), which consists of a generalized model of RIS where the reconfigurable elements may be interconnected through reconfigurable impedance networks, leading to an arbitrary reciprocal network. Due to its extra reconfigurability options, BD-RIS offers improved performance in terms of beamforming gain, up to 62% [31]. Thus, it is natural to expect that BD-RIS will also outperform RIS in the task of orthogonalizing the MIMO channel, which, to the best of our knowledge, has not been studied. In [1], two further extended RS models are considered, amplitude-reconfigurable intelligent surface (ARIS), which corresponds to a variant of RIS which allows for amplitude reconfigurability (also contemplated to some extent in [22] and [31]), and fullyreconfigurable intelligent surface (FRIS), which considers the upper limit of having an unrestricted reflection matrix. In fact, considering the passive restriction, as well as the direct channel blockage assumption, the FRIS model leads to the capacity achieving reflection matrix derived in [33], which is given by an unconstrained unitary matrix. In this work, we will consider some of these RS technologies in the task of MU-MIMO channel orthogonalization towards OSDM.\n"
    },
    {
        "level": "##",
        "title": "B. Contribution",
        "content": "\nThis paper extends the results from [1], where the problem of channel orthogonalization was preliminarily addressed considering ARIS and FRIS. However, in [1] we did not give a formal treatment of the passive constraints of ARIS and FRIS, since we considered constraining the average RS power instead of completely avoiding the use of active elements. In [30] we employed a similar framework, but we instead focused on deriving the extra DoF available in the RS-BS link, which we now disregard. In this work, we study the problem of MU- MIMO channel orthogonalization based on purely passive RS technology. We include in our analysis the BD-RIS model, corresponding to the reciprocal version of FRIS, which was not considered in [1]. To the best of our knowledge, the use of BD-RIS, or generalized RS techonology based on purely passive components, has not been previously studied in the context of channel orthogonalization. The main contributions may be summarized as follows:\n\n- We provide formal restrictions on the reflection matrix\nof ARIS, FRIS, and BD-RIS, connecting them to possible implementations based on reconfigurable impedance networks.\n- We derive necessary conditions on the number of elements, and corresponding reflection matrix, for selecting arbitrary (orthogonal) channels using ARIS, FRIS, and BD-RIS. These conditions are also sufficient when relaxing the passive constraint or when the direct channel is blocked. In [1] we only included achievable bounds for ARIS and FRIS with relaxed passive constraint.\n- We provide methods for orthogonal channel selection\nwith ARIS, FRIS, and BD-RIS maximizing channel gain while fulfilling the passive constraint. Some methods employ similar tools as [1], but the main channel selection algorithm is novel. Moreover, we now enforce a strict passive constraint unlike [1], where a relaxed version based on average power was considered.\n- We provide a generalized method for channel estimation\nand RS configuration with passive ARIS, FRIS, and BD- RIS. In [1] a similar method was provided for ARIS, but for FRIS it was assumed that the RS could send pilots, which we hereby avoid.\n"
    },
    {
        "level": "##",
        "title": "C. Paper Organization And Notation",
        "content": "\nThe rest of the paper is organized as follows. Section II presents the system model, including a discussion about implementation and restrictions of the different RS models. Section III provides formal theoretical results on the achievability of arbitrary (orthogonal) channels with RS. Section IV studies orthogonal channel selection, and provides a suitable algorithm to perform this task. Section V presents a general channel estimation and RS configuration method for (orthogonal) channel selection. Section VI includes numerical results to evaluate the presented theory. Finally, Section VI concludes the paper with some final remarks and future work.\n\nIn this paper, lowercase, bold lowercase and bold uppercase letters stand for scalars, column vectors and matrices, respectively. The operations (\u00b7)T, (\u00b7)\u2217, (\u00b7)H, and (\u00b7)\u2020 denote transpose, conjugate, conjugate transpose, and pseudoinverse, respectively. The trace operator is written as tr(\u00b7). The operation diag(a) gives a diagonal matrix with the input vector a as diagonal elements. A \u2297 B denotes the Kronecker product between matrices A and B. Ii corresponds to the identity matrix of size i, 1i\u00d7j denotes the i \u00d7 j all-ones matrix, and\n0i\u00d7j denotes the i \u00d7 j all-zeros matrix (the subindices may be omitted if they can be derived from the context). {A}i,j is the (*i, j*)th element of A. Ei,j is a matrix having a single non-zero element in position (*i, j*) equal to 1 (the dimensions are given by the context).\n\nII. SYSTEM MODEL\nLet us consider a scenario where K UEs are communicating in the uplink with an M-antenna BS through a narrowband channel. We consider the general assumption M \u2265 K, but most of our results are straightforwardly applicable for M <\nK. The communication link is assisted by an N-element RS.\n\nThe received signal may be expressed in complex baseband as an M-sized vector given by\n\n$$\\mathbf{y}=\\mathbf{H}\\mathbf{s}+\\mathbf{n},\\tag{1}$$\n\nwhere $\\mathbf{H}$ is the $M\\times K$ channel matrix, $\\mathbf{s}$ is the $K\\times1$ vector of complex baseband symbols transmitted by the UEs, with $\\mathbb{E}(\\mathbf{s}\\mathbf{s}^{\\rm H})=E_{\\rm s}\\mathbf{1}_{K}$, and $\\mathbf{n}$ is the random noise vector modeled by $\\mathbf{n}\\sim\\mathcal{CN}(\\mathbf{0}_{M\\times1},N_{0}\\mathbf{1}_{M})$.\n\nIn a general RS scenario, we may assume that there exists a direct link between the UEs and the BS, as well as a reflected channel through the RS. Thus, we may express the channel matrix as\n\n$$\\mathbf{H}=\\mathbf{H}_{0}+\\mathbf{H}_{1}\\mathbf{\\Theta}\\mathbf{H}_{2},\\tag{2}$$\nwhere H0 corresponds to the M \u00d7 K channel matrix associated to the direct link between the BS and the UEs, H1 corresponds to the M \u00d7 N channel matrix associated to the BS-to-RS link, H2 corresponds to the channel matrix associated to the RS-to-UEs link, and \u0398 is the reflection matrix which characterizes the narrowband response of the RS for a given configuration.\n\nA. RS Models The most widespread model of RS is RIS, which considers that each RS element is associated to a passive network with controllable reflection coefficient. Furthermore, it is commonly assumed that this reflection coefficient corresponds to a pure phase shift, so that the power being reflected at the RIS is maximized and no energy is burnt at the passive network associated to each RIS element. This leads to the usual restriction on the narrowband reflection matrix\n\n$$\\Theta_{\\rm RIS}={\\rm diag}\\left(\\exp(j\\phi_{1}),\\ldots,\\exp(j\\phi_{N})\\right).\\tag{3}$$\nThe restriction set on the RIS to reflect all the incoming power can become a limiting factor in certain situations where it may be interesting to sacrifice part of the reflected power with the aim to improve other qualities of the channel, e.g., its multiplexing performance. Thus, we consider an RS model which generalizes that of the RIS, where such restriction is not present and we may have amplitude reconfigurability at each RS element together with the common phase reconfigurability.\n\nDefinition 1: Amplitude reconfigurable intelligent surface\n(ARIS) is hereby defined as an RS model whose reflection matrix satisfies\n\n$$\\Theta_{\\rm ARIS}={\\rm diag}\\left(\\alpha_{1},\\ldots,\\alpha_{N}\\right),\\ \\ |\\alpha_{i}|^{2}\\leq1\\ \\ \\forall i.\\tag{4}$$\n\nAn _ARIS with relaxed power constraint_ corresponds to an ARIS where the restriction $|\\alpha_{i}|^{2}\\leq1$ is disregarded.\n\nFrom (4), we may note that the RIS restriction, which can be written as $|\\alpha_{i}|=1$, is now relaxed to $|\\alpha_{i}|^{2}\\leq1$. The restriction $|\\alpha_{i}|^{2}\\leq1$ comes from considering fully-reconfigurable passive (impedance) networks. However, it could further be \nremoved by incuding active elements, e.g., amplifiers\u2014as proposed in [34], [35]\u2014which leads to the ARIS with relaxed power constraint.1 A potential implementation of ARIS is illustrated in Fig. 1a.\n\nAnother RS model that has been studied in the literature is BD-RIS [31], [32], which extends the idea of RIS by allowing to interconnect different RS elements through a reconfigurable passive (impedance) network. The correspondence between the impendance network interconnecting the RS elements, and the resulting reflection matrix is one-to-one, and obtained from microwave network theory [36] as\n\n$$\\mathbf{\\Theta}=(\\mathbf{Z}+\\mathbf{I}_{N})^{-1}(\\mathbf{Z}-\\mathbf{I}_{N}),\\tag{5}$$\n\nwhere $\\mathbf{Z}$ is the $N\\times N$ impedance matrix. Hence, the restrictions on the reflection matrix when considering different BD-RIS architectures are directly determined by the restrictions on the impedance network leading to $\\mathbf{Z}$[31]. In the case of ARIS, which corresponds to a restricted BD-RIS, no interconnection is assumed between elements, leading to a N-port network with diagonal impedance matrix, which correspondingly gives a diagonal reflection matrix. The power constraint $|\\alpha_{i}|^{2}\\leq1$ further comes from the fact that, in the positive. In the general case, a passive network has an impedance network with non-negative eigenvalues, i.e. of equal-responding reflection matrix, has the response reflection matrix, as well as the 1 to [31], [36]. Moreover, assuming reciprocal networks--the e.g., pure impedance networks--the impedance matrix has the extra restriction that it is symmetric, which further leads to a symmetric constraint in the reflection matrix, i.e., $\\mathbf{\\Theta}=\\mathbf{\\Theta}^{\\mathsf{T}}$.\n\nAs happened with the RIS case, most of the literature on BD-RIS [31], [32] focuses on the lossless case, i.e., where all the incident power at the BD-RIS is being reflected. However, it may still be interesting, under certain scenarios, to sacrifice some reflected power at the BD-RIS for improving other channel properties. Hence, we will consider a generalization over the common BD-RIS [31], [32] reflection model by assuming that the impedance network may include resistive (lossy) components instead of purely reactive (lossless) components. This leads to the following definition.\n\nDefinition 2: Beyond diagonal reconfigurable surface (BD-\nRIS) is hereby defined as an RS model whose reflection matrix satisfies\n\n$$\\Theta_{\\text{BD-RIS}}\\in\\{\\Theta\\in\\mathbb{C}^{N\\times N}\\mid\\Theta=\\Theta^{\\text{T}},\\,||\\Theta||_{2}^{2}\\leq1\\},\\tag{6}$$\n\nwhere $||\\cdot||_{2}$ corresponds to the matrix spectral norm. A _BD-RIS with relaxed power constraint_ corresponds to a BD-RIS where the restriction $||\\Theta||_{2}^{2}\\leq1$ is disregarded.[2]\n\nAssuming a fully reconfigurable impedance network, an arbitrary reflection matrix fulfilling (6) may be achieved by selecting the converse impedance matrix from (5). A potential implementation of BD-RIS is illustrated in Fig. 1b. A more thorough discussion on specific implementations of the considered impedance networks is given in [32].\n\nWe also consider an RS model corresponding to a further generalization of the previous models.\n\nDefinition 3: Fully-reconfigurable intelligent surface (FRIS)\nis hereby defined as an RS model whose reflection matrix satisfies\n\n$$\\Theta_{\\rm FRIS}\\in\\{\\Theta\\in\\mathbb{C}^{N\\times N}\\mid\\|\\Theta\\|_{2}^{2}\\leq1\\}.\\tag{7}$$\n\nA _FRIS with relaxed power constraint_ corresponds to a FRIS where the restriction $\\|\\Theta\\|_{2}^{2}\\leq1$ is disregarded.${}^{2}$\n\nThe practicality of FRIS is doubtful, but it naturally arises\nThe practicality of FRIS is doubtful, but it naturally arises as a limit case for upper bounding the capabilities of RS systems. In fact, this type of RS gives the capacity achieving reflection matrix in [33], where the non-symmetric reflection matrix is further restricted to be unitary, corresponding again to the lossless case, i.e., reflecting maximum power. In principle, a general reflection matrix, as given by (7), may be achieved by considering a passive non-reciprocal network, i.e., including elements such as passive circulators or isolators [37]. In Fig. 1c we illustrate a possible implementation based on circulators, where the impedance network has now 2N\nports instead of N as in the previous designs. Other possible implementations may use N pairs of RS elements, half of them for receiving and the other half for transmitting, as well as isolators between both sides; however, such implementations may lead to a loss of channel reciprocity. In any case, the reader may take FRIS as a mere theoretical concept to understand the limits of RS systems.\n\nB. Note on the downlink scenario Assuming channel reciprocity, the results presented in this work may be trivially extended to the downlink scenario. Note that the architectures illustrated in Fig. 1 would maintain the reciprocity of the channel for fixed RS configuration. Thus, the downlink channel would correspond to the transpose of the uplink channel, retaining the same enhanced qualities without the need for RS reconfiguration.\n"
    },
    {
        "level": "##",
        "title": "Iii. Rs Channel Orthogonalization The Main Goal Of This Work Is To Employ The Previously Defined Rs Technology To Enforce Channel Orthogonality In The",
        "content": "\nspatial domain. This would allow to perfectly multiplex the symbols transmitted by the different UEs without interference, nor noise enhancement as in zero-forcing (ZF) schemes. Note that, due to the passive nature of RS, we may assume that the covariance of the noise vector is unaffected by the reconfigurable reflection. We next define what is meant by channel orthogonality in the spatial domain.\n\n_Definition 4:_ We hereby define an _orthogonal channel_ as a wireless propagation channel leading to a channel matrix $\\widetilde{\\mathbf{H}}$ which corresponds to a scaled element of the Stiefeld manifold, i.e.,\n\n$$\\widetilde{\\mathbf{H}}=\\sqrt{\\beta}\\widetilde{\\mathbf{U}},\\tag{8}$$\n\nwhere $\\beta$ is a real positive scalar corresponding to the _channel gain_, and $\\widetilde{\\mathbf{U}}$ is an element of the Stiefel manifold $\\mathcal{S}(M,K)$ such that $\\widetilde{\\mathbf{U}}^{\\mathsf{H}}\\widetilde{\\mathbf{U}}=\\mathbf{1}_{K}$. In other words, $\\widetilde{\\mathbf{U}}$ corresponds to a semi-unitary matrix which may be constructed by taking $K$ columns of an $M\\times M$ unitary matrix $\\mathbf{U}\\in\\mathcal{U}(M)$.\n\nNote that the previous definition leads to a channel matrix whose squared singular values are all equal to $\\beta$. We could consider a less restrictive definition by allowing for different eigenvalues while maintaining the orthogonality constraint, e.g., multiplying from the right in (8) a $K\\times K$ diagonal matrix. In fact, most of the results presented in this work have straightforward extension to that case. Nevertheless, we focus our exposition on orthogonal channels given by (8) for notation simplicity and due to some increased benefits explained next.\n\nOrthogonal channels, as given by (8), are hugely desirable in MU-MIMO systems for several reasons [6]:\n- Full multiplexing gain is available since all of the singular values of the channel matrix are non-zero.\n- The waterfilling algorithm [5] is not needed for achieving\ncapacity since all eigenvalues of the channel are equal.\n- The sum-rate is equally distributed among the UEs since\nthe orthogonal spatial streams have equal power.\n- Simple linear equalization or precoding, namely MRC or\nMRT, achieves optimum performance, since it can exploit the orthogonal paths of the channel without the need for UE cooperation.\nWe will now study the requirements for the different RS\nmodels to achieve arbitrary channel matrices, and specifically, to achieve an arbitrary orthogonal channel. We will start by ignoring the RS power constraints for analytical tractability.\n\nNevertheless, whenever the collection of channels H0, H1, and H2, as well as the desired channel \ufffd\nH, allow for an RS configuration fulfilling the respective power constraint, the presented results will provide it. On the other hand, if said collection of channels leads to an RS configuration not fulfilling the power constraint, we will show in the next section how to employ the freedom in the orthogonality constraint to minimize the RS power such that it may be implemented using purely passive components. Moreover, in the case of having H0 \u2248 0M\u00d7K, e.g., when the direct channel suffers from severe blockage, we will see that the RS power constrains may be trivially fulfilled by sacrificing channel gain.\n"
    },
    {
        "level": "##",
        "title": "A. Fris",
        "content": "\nWe start by considering the FRIS model since this should lead to the most fundamental limits on the ability to generate arbitrary (orthogonal) channels with RS technology. The following proposition provides the conditions for FRIS to be able to generate arbitrary (orthogonal) channels.\n\n_Proposition 1:_ Given an arbitrary direct channel $\\mathbf{H}_{0}$, and arbitrary full-rank channel matrices $\\mathbf{H}_{1}$ and $\\mathbf{H}_{2}$, a FRIS with relaxed power constraint is able to generate an arbitrary channel $\\widetilde{\\mathbf{H}}\\neq\\mathbf{H}_{0}$, and specifically an arbitrary orthogonal channel given by (8), if and only if\n\n$$N\\geq\\max(M,K).\\tag{9}$$\n\nSaid channel $\\widetilde{\\mathbf{H}}$ is achieved by configuring the FRIS reflection matrix as\n\n$$\\mathbf{\\Theta}_{\\rm FRIS}=\\mbox{vec}^{-1}\\big{(}\\mathbf{\\mathcal{H}}^{\\dagger}\\mathbf{c}\\big{)},\\tag{10}$$\n\nwhere $\\mathbf{\\mathcal{H}}^{\\dagger}$ corresponds to the right pseudoinverse of $\\mathbf{\\mathcal{H}}=(\\mathbf{H}_{2}^{\\dagger}\\otimes\\mathbf{H}_{1})$, and $\\mathbf{c}=\\mbox{vec}(\\widetilde{\\mathbf{H}}-\\mathbf{H}_{0})$. An alternative (more compact) expression may be given by\n\n$$\\mathbf{\\Theta}_{\\rm FRIS}=\\mathbf{H}_{1}^{\\dagger}\\big{(}\\widetilde{\\mathbf{H}}-\\mathbf{\\mathcal{H}}_{0}\\big{)}\\mathbf{H}_{2}^{\\dagger},\\tag{11}$$\n\nwhere $\\mathbf{H}_{1}^{\\dagger}$ and $\\mathbf{H}_{2}^{\\dagger}$ correspond to the right and left pseudoinverses of $\\mathbf{H}_{1}$ and $\\mathbf{H}_{2}$, respectively.\n\n_Proof:_ We want to study solutions to the matrix equation\n\n$$\\mathbf{H}_{0}+\\mathbf{H}_{1}\\mathbf{\\Theta}\\mathbf{H}_{2}=\\widetilde{\\mathbf{H}},\\tag{12}$$\n\nto a linear system of equations where $\\mathbf{\\Theta}$ $N\\times N$ complex matrix of unknowns. If\nwhich corresponds to a linear system of equations where \u0398\nis the unrestricted N \u00d7 N complex matrix of unknowns. If we move H0 to the right-hand side (RHS) and vectorize, we may express (12) as\n\n$\\mathcal{H}$ vec($\\Theta$) = $\\mathbf{c}$, (13)\n\nwhere c = vec(\ufffd\n              H \u2212 H0) is a non-zero MK-sized vector\n(since \ufffd\n     H \u0338= H0), and H = (HT\n                            2 \u2297 H1) is an MK \u00d7 N 2\n\nmatrix. From the properties of the Kronecker product [38],\nwe can characterize the rank of H as\n\n$$\\mbox{rank}(\\mathbf{H})=\\mbox{rank}(\\mathbf{H}_{2})\\cdot\\mbox{rank}(\\mathbf{H}_{1}),\\tag{14}$$\nwhere, since H1 and H2 are full rank, we have that rank(H1) = min(*M, N*) and rank(H2) = min(*K, N*). On the other hand, by fundamental linear algebra arguments, a solution to (13) can be found if and only if rank(H) = M \u00b7K, which leads to the condition (9). Moreover, if a solution to (13) exists, it is given by\n\n$$\\text{vec}(\\mathbf{\\Theta})=\\mathcal{H}^{\\dagger}c,\\tag{15}$$\n\nwhere $\\mathcal{H}^{\\dagger}$ is the right pseudoinverse of $\\mathcal{H}$. Note that there may be multiple solutions since the pseudoinverse may include $(N^{2}-MK)$ columns arbitrarily selected from the null-space of $\\mathcal{H}$. After inverse vectorization we reach (10). Moreover, exploiting the property of the Kronecker product $(\\mathbf{A}\\otimes\\mathbf{B})^{\\dagger}=\\mathbf{A}^{\\dagger}\\otimes\\mathbf{B}^{\\dagger}$[38] leads to (11). \n\nProposition 1 sets a requirement on $N$ to generate arbitrary channels using FRIS. However, as seen in the previous section, practical implementations of FRIS may actually employ an impedance network with $2N$ ports. We will find out that, in some cases, this consideration could make FRIS implementations more restrictive than BD-RIS implementations.\n\nB. BD-RIS\nThe following theorem delimits the capabilities of BD-RIS\nto achieve arbitrary (orthogonal) channels.\n\nTheorem 1: Given an arbitrary direct channel H0, and randomly chosen3 channel matrices H1 and H2, a BD-RIS\nwith relaxed power constraint is able to generate an arbitrary channel \ufffd\nH \u0338= H0, and specifically an arbitrary orthogonal channel as given by (8), if and only if\n\nN \u2265 M + K \u2212 1. (16)\nFurthermore, (16) is also a sufficient condition for arbitrary full-rank H1 and H2. Said channel \ufffd\nH is achieved by configuring the BD-RIS reflection matrix as\n\n\u0398BD-RIS = vec\u22121\ufffd\ufffd K(N,N) + IN 2\ufffd ZU/L \ufffd HU + HL \ufffd\u2020c \ufffd\n(17)\nwhere K(N,N) is the commutation matrix for N \u00d7N matrices\n[39], c = vec(\ufffd\nH \u2212 H0), HU/L corresponds is an N 2 \u00d7\nN(N + 1) matrix constructed from the columns of H from\n(10) associated to the upper/lower triangular elements after vectorization, and ZU/L is an N 2 \u00d7 N(N + 1)/2 matrix that pads zeros in the entries associated to elements below/above the diagonal after inverse vectorization.\n\nProof: See Appendix.\n\n\u25a1\nWe may now note that, if we consider a FRIS implementation requiring a 2N-port impendance network (as illustrated in Fig. 1c), the minimum N from (16) and (9) would translate into a stricter requirement in terms of impedance network ports for FRIS than for BD-RIS, giving an increase of max\n\ufffd\nM \u2212K +1, K \u2212M +1\n\ufffd\nports. This may be understood by the fact that such FRIS implementation corresponds to a non-reciprocal version of a BD-RIS with 2N elements where the non-reciprocicity actually reduces the DoF. However, the reduction in antenna elements may still be desirable in some scenarios. On the other hand, from (16) we may also notice that, assuming *M >* 1 and/or *K >* 1, BD-RIS does not make perfect use of all the N(N + 1)/2 free variables in \u0398BD-RIS\nsince it actually requires an excess of \u2308(M 2\u2212M+K2\u2212K)/2\u2309\nfree variables to be able to solve the MK unknowns associated to the channel update.\n"
    },
    {
        "level": "##",
        "title": "C. Aris",
        "content": "\nThe following proposition particularizes the previous results to the ARIS restriction.\n\n_Proposition 2:_ Given an arbitrary direct channel $\\mathbf{H}_{0}$, and _randomly chosen_ channel matrices $\\mathbf{H}_{1}$ and $\\mathbf{H}_{2}$, an ARIS with relaxed power constraint is able to generate an arbitrary channel $\\widetilde{\\mathbf{H}}\\neq\\mathbf{H}_{0}$, and specifically an arbitrary orthogonal channel given by (8), if and only if\n\n$$N\\geq MK.\\tag{18}$$\n\nSaid channel $\\widetilde{\\mathbf{H}}$ is achieved by selecting the ARIS reflection matrix as\n\n$$\\mathbf{\\Theta}_{\\rm ARIS}={\\rm diag}\\big{(}\\mathbf{\\mathcal{H}}_{D}^{\\dagger}\\mathbf{c}\\big{)},\\tag{19}$$\n\nwhere $\\mathbf{c}={\\rm vec}(\\widetilde{\\mathbf{H}}-\\mathbf{H}_{0})$, and $\\mathbf{\\mathcal{H}}_{D}$ is an $MK\\times N$ matrix constructed from the columns of $\\mathbf{\\mathcal{H}}$ from (10) associated to the diagonal elements after vectorization.\n\n_Proof:_ We study the solutions to the equation\n\n$$\\mathbf{H}_{0}+\\mathbf{H}_{1}\\mathbf{\\Theta}_{\\rm D}\\mathbf{H}_{2}=\\widetilde{\\mathbf{H}},\\tag{20}$$\n\nwhere $\\mathbf{\\Theta}_{\\rm D}={\\rm diag}(\\mathbf{\\alpha}_{\\rm D})$ for an $N$-sized vector of unknowns $\\mathbf{\\alpha}_{\\rm D}$. We may proceed by vectorizing as in the proof of Proposition 1, leading to\n\n$$\\mathbf{\\mathcal{H}}_{\\rm D}\\mathbf{\\alpha}_{\\rm D}=\\mathbf{c},\\tag{21}$$\nwhere HD is an MK \u00d7N matrix whose columns correspond to the columns of H multiplying the diagonal elements of\n\u0398 in (13). Since c = vec(\ufffd\nH \u2212 H0) is a non-zero vector,\n(21)\u2014corresponding to a linear equation\u2014is solvable if and only if rank(HD) = MK. Let us assume (9) since this is clearly a necessary condition for (20). For arbitrary full rank matrices H2 and H1, we have that rank(H) = MK. On the other hand, if H2 and H1 are further *randomly chosen*, any selection of columns/rows from H will also be full rank with probability 1. Hence, having a selection HD of rank MK is equivalent to (18). The solution (19) is then trivially given by inverting HD in (21), and constructing the diagonal matrix.\n\n\u25a1\n"
    },
    {
        "level": "##",
        "title": "Iv. Orthogonal Channel Selection",
        "content": "\nIn this section, we provide techniques for selecting suitable orthogonal channels, given by (8), such that the required reflection matrix fulfills the passive restrictions from (7), (6), and (4). In the previous section, we derived closed-form expressions for the reflection matrices required to obtain an arbitrary (orthogonal) channel with FRIS, ARIS, and BD-RIS, given in (10), (17), and (19), respectively. The idea now is to exploit the freedom in the orthogonality constraint to restrict the power of the reflection matrix such that no amplification is required at the respective RS models.\n\nIn the three RS models considered, the power constraint allowing for channel orthogonalization using only passive components may be expressed in terms of the spectral norm as\n\n\u2225\u0398r\u22252 2 \u225c max x xH\u0398H r \u0398rx \u2225x\u22252 2 \u2264 1, (22)\nwhere r *\u2208 {*FRIS, BD-RIS, ARIS}, and \u0398r may be obtained by substituting (8), in (10), (17), and (19). We may write \u0398r as\n\n\u0398r = vec\u22121\ufffd \ufffdHr \ufffd\ufffd \u03b2vec( \ufffdU) \u2212 vec(H0) \ufffd\ufffd , (23)\nwhere \ufffdHr is an N 2\u00d7MK full-rank matrix respectively given by\n\ufffdHFRIS = H\u2020\n(24a)\n\n\ufffdHBD-RIS = \ufffd K(N,N) + IN 2\ufffd ZU/L \ufffd HU + HL \ufffd\u2020 (24b) \ufffdHARIS = ZDH\u2020 D, (24c)\nwith ZD corresponding to an N 2 \u00d7 N matrix that pads zeros in the entries associated to the off-diagonal elements after vectorization\u2014converse to ZU/L for the upper/lower triangular elements. Note that, whenever H0 = 0, the only term left in\n(23) scales with \u221a\u03b2, so if the direct channel is blocked we can always find a value of \u03b2 such that (22) is fulfilled. However, we are also interested in having the channel gain \u03b2 as high as possible since it multiplies the post-processed signal-to-noise ratio (SNR) for each UE, i.e., leading to the Shannon capacity\n[40]. In general, if a given \ufffdU allows for some \u03b2 \u2265 0 such that (22) is fulfilled, then \u2225\u0398r\u22252\n2 is an increasing function in\n\u03b2 \u2265 \u03b20 for some \u03b20 \u2265 0,4 so it is desirable to increase \u03b2\nuntil (22) is fulfilled with equality. We could thus formulate our problem as\n\nmax \ufffd U \u03b2, s.t. \u2225\u0398r\u22252 2 = 1. (25) However, a given combination of parameters may not even allow for fulfilling the constraint (25). Hence, our proposed solution considers the initial problem of minimizing $||\\Theta_{r}||_{2}^{2}$ over $\\beta$ and $\\vec{U}$, and use the result as a starting point for attempting to solve (25). In the rest of this section, we will use the general formulation of $\\Theta_{r}$ from (23) to be able to provide general results applicable to the three RS models under study. However, the fact that $Z_{S}$ and $Z_{U/L}$ have several zero columns, as well as the properties of the commutation matrix, allow for some improvement in computation efficiency for ARIS and BD-RIS which may be leveraged for the numerical results. In the case of FRIS, we could also consider the alternative expression for the reflection matrix given in (11) to improve this efficiency, but this requires the knowledge of $\\mathbf{H}_{1}$ and $\\mathbf{H}_{2}$ (up to a shared scalar). We will see that, unlike in [1] where the FRIS is allowed to transmit pilots, a passive FRIS only allows us to estimate $\\mathcal{H}$. However, Kronecker product decomposition methods [41] could be potentially employed on $\\mathcal{H}$ to obtain estimates of $\\mathbf{H}_{1}$ and $\\mathbf{H}_{2}$, up to shared scaling.\n\n4This can be seen by noting that \u2225\u0398r\u22252\nA. RS power minimization The initial concern is to find if a combination of \u03b2 and\n\ufffdU such that (22) can be fulfilled. We may tackle this by minimizing \u2225\u0398r\u22252\n2 with respect to \ufffdU and \u03b2 and checking if the minimum value fulfills said constraint. The spectral norm\n\u2225\u0398r\u22252\n2, given by the largest singular value of \u0398r, is generally difficult to minimize. On the other hand, the Frobenius norm\n\u2225\u0398r\u2225F = tr(\u0398H\nr \u0398r) corresponds to an equivalent matrix norm which upper-bounds the spectral norm, so by minimizing the Frobenius norm we can also reduce the spectral norm to a great extent. Let us thus consider the problem of minimizing the Frobenius norm \u2225\u0398\u22252\nF = tr(\u0398H\u0398), which coincides with the Euclidean norm for vectorized matrices.\n\nConsidering (23), the squared Frobenius norm of \u0398r for r *\u2208 {*FRIS, BD-RIS, ARIS} may be expressed as P Fro r (\n\ufffd\n\n$$\\widetilde{\\beta},\\widetilde{U}\\rangle\\triangleq||\\mathbf{\\Theta}_{r}||_{\\rm F}^{2}=\\beta g_{r}(\\widetilde{U})-2\\sqrt{\\beta}f_{r}(\\widetilde{U})+\\kappa_{r},\\tag{26}$$\n\nwhere\n\n$$g_{r}(\\widetilde{U})=\\mbox{vec}(\\widetilde{U})^{\\rm H}\\widetilde{\\mathbf{H}}_{r}^{\\rm H}\\widetilde{\\mathbf{H}}_{r}\\mbox{vec}(\\widetilde{U})\\tag{27a}$$ $$f_{r}(\\widetilde{U})=\\Re\\{\\mbox{vec}(\\widetilde{U})^{\\rm H}\\widetilde{\\mathbf{H}}_{r}^{\\rm H}\\widetilde{\\mathbf{H}}_{r}\\mbox{vec}(\\mathbf{H}_{0})\\}$$ (27b) $$\\kappa_{r}=\\mbox{vec}(\\mathbf{H}_{0})^{\\rm H}\\widetilde{\\mathbf{H}}_{r}^{\\rm H}\\widetilde{\\mathbf{H}}_{r}\\mbox{vec}(\\mathbf{H}_{0}),\\tag{27c}$$\n\nwith $\\widetilde{\\mathbf{H}}_{r}$, given in (24) for $r\\in\\{$F RIS, BD-RIS, ARIS$\\}$. Note that $g_{r}(\\mathbf{U})$ and $\\kappa_{r}$ are always positive, while $f_{r}(\\widetilde{U})$ can be made positive or negative through $\\widetilde{U}$. The problem we want to solve may be formulated as\n\n$$\\begin{array}{c}\\arg\\min_{\\sqrt{\\beta},\\widetilde{U}}P_{r}^{\\rm Fr}(\\sqrt{\\beta},\\widetilde{U})\\\\ \\mbox{s.t.}\\widetilde{U}^{\\rm H}\\widetilde{U}={\\bf I}_{K}.\\end{array}\\tag{28}$$\n\nSince this problem is quadratic in $\\sqrt{\\beta}$, the optimal value for given $\\widetilde{U}$ corresponds to the stationary point\n\n\\[\\sqrt{\\beta_{\\rm opt}(\\widetilde{U})}=\\frac{f_{r}(\\widetilde{U})}{g_{r}(\\widetilde{U})},\n\u03b2opt( \ufffdU) = fr( \ufffdU)\n\n$\\frac{J_{r}(\\tilde{U})}{g_{r}(\\tilde{U})}$, (29)\n\n$\\frac{J_{r}(\\tilde{U})}{g_{r}(\\tilde{U})}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$, $\\tilde{U}$ is positive since, from $\\tilde{U}$\nwhere we may assume that\n\ufffd\n\u03b2opt( \ufffdU) is positive since, from\n(27), the sign of fr( \ufffdU) can be absorbed in \ufffdU without loss of generality (WLOG).5 After substituting\n\ufffd\n\nof generality (WLOG).${}^{5}$ After substituting $\\sqrt{\\beta_{\\rm opt}(\\widetilde{U})}$ in (26) we get the equivalent problem\n\n$$\\arg\\max_{\\widetilde{U}}\\frac{f_{r}^{2}(\\widetilde{U})}{g_{r}(\\widetilde{U})}\\tag{30}$$ $$\\mbox{s.t.}\\ \\widetilde{U}^{\\rm H}\\widetilde{U}={\\bf I}_{K}.$$\n\nThe previous maximization problem is generally non-convex. However, we may reach a local minimum by considering gradient ascent algorithms in the unitary group, as those proposed in [42]. To this end, we first need to characterize the gradient of the objective function in (30), given by\n\n$$\\Gamma(\\widetilde{U})\\triangleq\\left(\\frac{f_{r}^{2}(\\widetilde{U})}{g_{r}(\\widetilde{U})}\\right)^{\\prime}=\\frac{2f_{r}(\\widetilde{U})g_{r}(\\widetilde{U})f_{r}^{\\prime}(\\widetilde{U})-f_{r}^{2}(\\widetilde{U})g_{r}^{\\prime}(\\widetilde{U})}{g_{r}^{2}(\\widetilde{U})},\\tag{31}$$\nwhere we have\n\n$$f_{T}(\\vec{U})\\stackrel{{\\Delta}}{{=}}\\frac{\\partial f_{T}(\\vec{U})}{\\partial\\vec{U}}=\\mbox{vec}-\\mbox{1}\\left(\\vec{U}_{R}^{T}\\vec{W}_{R}\\mbox{vec}(\\mathbf{H}_{R})\\right)\\tag{32a}$$ $$g_{T}^{\\prime}(\\vec{U})\\stackrel{{\\Delta}}{{=}}\\frac{\\partial g_{T}(\\vec{U})}{\\partial\\vec{U}}=\\mbox{vec}-\\mbox{1}\\left(\\vec{U}_{R}^{T}\\vec{W}_{R}\\mbox{vec}(\\vec{U})\\right).\\tag{32b}$$\n\nWe can easily employ the algebra function [42, Table 3].\n\nIn which we consider the algebra we have used the following quadratic equations describing the gradient using the geodesic equation. The algorithm for the linear [42, Table 4] is not sufficient to compute the integral of the Hessian. The linear (negative) component of the Hessian is not sufficient to compute the integral of the Hessian. The linear (negative) component of the Hessian is not sufficient to compute the integral of the Hessian. The problem is solved by solving the inverse Fourier transform of [42, Table 43], being the inverse Fourier transform of [44], we take a look at (23), being the inverse Fourier transform of [45]. We can use the above method to compute the integral of the Hessian and the second term corresponds to the difference between the vector and the vector. The second term represents the difference between the vector and the vector. The second term is the linear vector of the Hessian. Note that, in the case, taking the second term, the second term is the linear vector of the Hessian, and the second term is the linear component of $\\vec{W}_{R}$.\n\n$$\\vec{U}=\\mathcal{P}_{\\mathcal{G}(M,K)}\\left(\\mbox{vec}\\nabla^{-1}\\left(\\nabla_{M,K}+\\mbox{vec}(\\mathbf{H}_{R})\\right)\\right),\\tag{33}$$\n\nwhere $\\nabla_{M,K}$ is the right unitary vector of $\\vec{W}_{R}$, predicted to be the vector and the vector. The vector is computed by the linear vector of $\\mathcal{H}_{R}$. We can use the following vector and the vector.\n\n\\[\\mathcal{P}_{\\mathcal{G}(M,K)}(\\Delta)=\\mathbf{U}\\\nB. Channel gain maximization As previously mentioned, we are interested in having the channel gain \u03b2 as high as possible since it has direct impact on the rate at which each of the UEs may transmit data. Hence, assuming that we can find \u03b2 and \ufffdU such that (22) is fulfilled\u2014\ne.g., by using the proposed approximate solutions to (28)\u2014the next aim is to maximize \u03b2 by trying to solve (25).\n\nLet us assume that we can find \ufffdU 0 such that, for some\n\u03b20 \u2265 \u03b2opt( \ufffdU 0) from (29), we get a reflection matrix fulfilling\n(22) with strict inequality, i.e., \u2225\u0398r\u22252\n2 < 1. Due to the characteristics of the spectral norm, it is not obvious how much \u03b2 can be increased until (22) is fulfilled with equality. The reason is that the vector x in (22), which we may assume to be a unit vector WLOG, is dependent on \u03b2. To solve this problem, we propose an iterative procedure where, starting with \u03b20, we alternate between obtaining the unit vector xi solving the maximization in (22) for the current \u03b2i, and obtaining the highest \u03b2i+1 such that xH\ni \u0398r(\u03b2i+1)H\u0398r(\u03b2i+1)xi = 1, which corresponds to solving a quadratic equation in\n\ufffd\n\n                                        \u03b2i+1.\nThe convergence of this method is assured by observing that\n{\u2225\u0398r(\u03b2i)\u22252\n       2}i\u22651 is a decreasing sequence lower bounded by\n1, while we know there exists \u03b20 such that \u2225\u0398r(\u03b20)\u22252\n                                       2 < 1.\nHence, \u2225\u0398r(\u03b2i)\u22252\n            2 will converge to 1, and \u03b2i will converge\nto the maximum value allowing for \u2225\u0398r(\u03b2i)\u22252\n                                 2 = 1 with the\ngiven \ufffdU = \ufffdU 0.\n We have presented a rule for adjusting \u03b2 such that (22)\nis fulfilled with equality. We can further try to solve (25) by\niteratively minimizing \u2225\u0398r( \ufffdU)|\u03b2=\u03b2i\u22252\n                           2 over \ufffdU, and use the\nprevious method to increment \u03b2 until \u2225\u0398r(\u03b2i)| \ufffd\n                                    U= \ufffd\n                                      U i\u22252\n                                         2 =\n1. Assuming we can find the global minimizer\n                                       \ufffdU i of\n\u2225\u0398r( \ufffdU)|\u03b2=\u03b2i\u22252\n           2 at iteration i, this method will converge to\nthe optimal solution of (25), since in each iteration \u03b2 is\nincreased and upper bounded by the finite7 optimal value.\nHowever, finding a global minimizer \ufffdU i of \u2225\u0398r( \ufffdU)|\u03b2=\u03b2i\u22252\n                                           2\nis non-trivial. We thus consider approximate solutions by\nsolving the alternative problem given in (28) for fixed \u03b2,\nwhich only differs from (28) in that \u03b2 is constant and not\ntreated as an optimization variable. This can be done by using\nmethods for minimization with unitary constraints as the ones\nconsidered for solving (30). Specifically, we consider again\nthe algorithm from [42, Table II], where the gradient of the\nobjective function is now given by\n\n$$\\Gamma_{\\beta}(\\widetilde{\\mathbf{U}})\\triangleq\\frac{\\partial P_{r}^{\\text{Fro}}(\\sqrt{\\beta},\\widetilde{\\mathbf{U}})}{\\partial\\widetilde{\\mathbf{U}}}=\\beta g_{r}^{\\prime}(\\widetilde{\\mathbf{U}})-2\\sqrt{\\beta}f_{r}^{\\prime}(\\widetilde{\\mathbf{U}}),\\tag{35}$$\n\nwhere $g_{r}^{\\prime}(\\widetilde{\\mathbf{U}})$ and $f_{r}^{\\prime}(\\widetilde{\\mathbf{U}})$ are given in (32).\n\nAlgorithm 1 summarizes the proposed method for orthogonal channel selection. We have used the notation $\\mathbf{v}_{\\max}(\\cdot)$ to denote an eigenvector associated to the largest eigenvalue of the positive semi-definite input matrix. We will also consider a simplified version of Algorithm 1 where we skip step 10, since the use of [42, Table II] may lead to large computation times due to the variability in convergence speed.\n\nV. CHANNEL ESTIMATION AND RS CONFIGURATION\nWe now turn our focus into proposing efficient techniques to estimate the channel coefficients required to be able to apply the respective configuration within the different RS models considered. The aim is to obtain the necessary parameters to be able to perform channel selection and RS configuration. In (23), we have a general expression for the desired reflection matrix of the RS technologies under study. We thus need to estimate the channel parameters that allow to characterize\n"
    },
    {
        "level": "##",
        "title": "Algorithm 1 Orthogonal Channel Selection Algorithm.",
        "content": "\nInput: H0, \ufffdHr Output: \u03b2, \ufffdU\nRS power minimization :\n1: Select initial \ufffdU and \u03b2, e.g., by (33) and (29).\n2: if \u2225\u0398r\u22252\n2 > 1 then\n4:\n\u03b2 \u2190 Update with (29)\n3:\nUse [42, Table II] to find \ufffdU maximizing (30)\n5:\nif \u2225\u0398r\u22252\n2 > 1 then\n6:\nActive amplification may be required\n7:\nend if\n8: end if\nChannel gain maximization :\n11:\nwhile \u03b2 has not converged do\n9: **while** \u03b2 has not converged do\n10:\nUse [42, Table II] to find \ufffdU minimizing (22) (fixed \u03b2)\n12:\nx = vmax\n\ufffd\n\u0398H\nr (\u03b2)\u0398r(\u03b2)\n\ufffd\n13:\n\u221a\u03b2 \u2190 Largest root of xH\u0398H\nr (\u03b2)\u0398r(\u03b2)x \u2212 1\n14:\nend while\n15: end while\n\ufffdHr and H0, which are the only parameters employed in the computation of the channel selection and RS configuration. From (24), the required channel parameters are given by H, (HU + HL), and HS for FRIS, BD-RIS, and ARIS, respectively.8 Note that, (HU + HL) and HS correspond to reduced matrices coming from H by selecting and/or combining columns, so BD-RIS and ARIS may be seen as a special case of FRIS with restricted channel knowledge.\n\nDue to the passive (energy-efficient) nature of RS technology [46], [47], we assume that, during the training phase, the estimation/computation tasks are carried out at the BS, while the RS only needs to configure its impedance networks by following a preprogrammed training sequence. Once the RS configuration is computed at the BS, it is then forwarded to the RS which may then implement it by tuning its impedance networks accordingly. We also assume that the desired channel is conveniently selected at the BS\u2014e.g., through the proposed channel selection algorithm\u2014so that it can use it in the data phase for decoding/precoding purposes without the need for extra channel estimation steps. Next, we describe the proposed estimation and configuration scheme consisting of three stages: direct channel estimation, cascaded channel coefficients estimation, and RS configuration.\n\nA. Direct Channel Estimation Assuming the direct channel H0 is not blocked, all the considered RS models require full knowledge of said channel. Hence, in the initial step the RS would configure its reflection matrix \u0398 = 0, which is allowed in the FRIS, ARIS, and BD-\nRIS models. This corresponds to configuring the impedance networks such that all the impinging power is dissipated in the RS resistive components. A practical alternative in more restricted RS models is to reflect the power in a direction away\n\nfrom the BS--i.e., putting $\\Theta$ in the null-space of $H_{1}$ and/or $H_{2}$--or to use a two step-method with reflection matrices $\\Theta_{1}$ and $\\Theta_{2}$ such that $\\Theta_{1}+\\Theta_{2}=0$. Assuming $\\Theta=0$ is effectively achieved, the UEs may send a sequence of $K$ orthogonal pilots to estimate $H_{0}$. The received signal over the $K$ time slots is a $K\\times K$ matrix given by\n\n$$Y_{0}=H_{0}P+N_{0},\\tag{36}$$\nwhere P is the K \u00d7 K known pilot matrix fulfilling *P P* H =\nEsIK, and N 0 is the noise matrix with IID entries {N 0}i,j \u223c\nCN(0, N0). We can then estimate H0 by removing the pilot matrix, i.e., multiplying 1/EsP H from the right, which would not affect the distribution of the estimation noise except for the corresponding scaling.\n\nB. Cascaded Channel Coefficients Estimation We proceed with the estimation of the required cascaded channel coefficients, associated to matrix\n\ufffdHr from (24).\n\nIn general, it is enough to perform the estimation of the cascaded channel coefficients obtained from a sequence of configurations of the reflection matrix \u0398 forming a basis for the vector spaces defined by its constraints\u2014given in (7), (6), and (4) for the different RS models\u2014since this would capture enough parameters to exploit the DoFs of the RS reflection. This can be understood by looking at the linear equation (13), which captures the ability of FRIS to configure the channel, and where the particularization to BD-RIS and ARIS corresponds to imposing the extra constraints on vec(\u0398). We will exemplify how this process looks like by considering a simple basis for each the three RS models under study, but extension to other bases is trivial.\n\n1) FRIS: This corresponds to the most general case since\n\u0398FRIS is unrestricted (except for the power constraint). However, all the columns of H have to be estimated to be able to exploit the full capabilities of FRIS. We would thus need a sequence of N 2 steps, where in step n the FRIS selects\n\u0398 = Ein,jn, with in and jn corresponding to the indexes such that vec(\u0398) has its non-zero entry at position n\u2014leading to the canonical basis for vec(\u0398).9 At each step, the UEs would send K orthogonal pilots, leading to the following received matrix at step n\n\n$$Y_{n}=H_{0}P+h_{1i_{n}}h_{2j_{n}}^{T}P+N_{n},\\tag{37}$$\nwhere h1in is the inth column of H1, hT\n2jn is the jnth row of H2, and N n is the corresponding IID Gaussian noise matrix. In (37), we can remove the pilot matrix as before and subtract our estimate of H0 from the previous stage, leading to an estimate of h1inhT\n2jn with IID Gaussian estimation noise (since we have just applied unitary transformations and combined IID Gaussian matrices). We may note that vec(h1inhT\n2jn) corresponds to the nth column of H, so, after repeating the process for the sequence of N 2 base configurations, we would reach an estimate of the whole H.\n\n2) BD-RIS: The constraint on \u0398 of being symmetric now translates into having only N(N + 1)/2 free variables\u2014\nvec(\u0398) in (13) would have N(N \u2212 1)/2 repeated entries.\n\nWe can proceed as in the FRIS case, but we would now have N(N +1)/2 steps, where in step n we may configure the RS\nwith reflection matrix \u0398 = Ein,jn + Ejn,in, generating an orthonormal basis for the space of N \u00d7N symmetric matrices.\n\nAgain, other less sparse bases may be more desirable to avoid receiver sensitivity issues, but this basis gives a convenient example. The received matrix over K orthogonal pilot slots can now be written as\n\n$$Y_{n}=H_{0}P+h_{1i_{n}}h_{2j_{n}}^{T}P+h_{1j_{n}}h_{2i_{n}}^{T}P+N_{n}.\\tag{38}$$\nFollowing the same reasoning as for FRIS, we may reach an estimate of h1inhT\n2jn+h1jnhT\n2in with IID Gaussian estimation noise. The vectorization of said estimated matrix corresponds to the nth column of (HU + HL), so after N(N + 1)/2 we would have estimated all the channel coefficients required to configure the BD-RIS.\n\n3) ARIS: The constraint now is that \u0398 has to be diagonal.\n\nThis means that vec(\u0398) in (13) has only N non zero elements multiplying the respective columns of H. We may then follow the same steps as in FRIS, but configuring \u0398 = En,n at step n\u2014generating an orthonormal basis for the space of N \u00d7 N\ndiagonal matrices. Following the same reasoning as in FRIS, we may get an estimate of h1nhT\n2n, which corresponds to the nth column of HS in (19). Hence, after N steps we have estimated all the necessary channel coefficients to configure the ARIS, where the estimation noise is again IID Gaussian.\n\nIf we select the minimum N in the different RS models\u2014\ni.e., fulfilling with equality (9), (16), and (18), respectively\u2014 we obtain the minimum number of pilot slots of length K\nrequired to estimate the cascaded channel channel parameters, given by LARIS = MK, LFRIS = min(*M, K*)2, and LBD-RIS =\n(M + K \u2212 1)(M + K \u2212 2)/2. We can note that for M \u0338=\nK we always have LFRIS < min(LARIS, LBD-RIS), showcasing another limitation in terms of FRIS practicality. On the other hand, the comparison between LARIS and LBD-RIS is dependent on M and K, but for large enough M (or K) LBD-RIS will be larger due to its quadratic relation to M (and K).\n"
    },
    {
        "level": "##",
        "title": "C. Rs Configuration",
        "content": "\nAfter having estimated the necessary channel parameters to configure the respective RS models, the BS can select a suitable desired channel, e.g., an orthogonal channel with high gain that does not require RS amplification. The BS may hereby employ Algorithm 1 for channel selection, which requires only knowledge of the estimated channel parameters\u2014\nfrom which we can obtain estimates of \ufffdHr and H0. Then, the BS can compute the reflection matrix to be applied at the RS for achieving said channel. The reflection matrix for FRIS, BD-RIS, and ARIS may be computed by using equations (10), (17), and (19), respectively. We may further translate the respective reflection matrices into impedance network parameters by considering (5).\n"
    },
    {
        "level": "##",
        "title": "Vi. Numerical Results And Examples A. Performance Under Iid Rayleigh Fading",
        "content": "\nWe first analyze the performance of Algorithm 1, as well as its simplified version when \ufffdU is directly fixed to (33) and [42, Table 2] is disregarded. We have considered a rich multipath propagation environment where H0, H1, and H2 may be modelled as IID Gaussian matrices [6]. From the theoretical results in Section IV, the ratio between power of the direct channel and the power of the cascaded channel seems to be a limiting factor towards perform channel orthogonalization. We have thus considered different values for this ratio by fixing the average power of the cascaded channel entries to\n1, i.e., E\n\ufffd\n|{H1}i,j|2\ufffd\n= 1 and E\n\ufffd\n|{H2}i,j|2\ufffd\n= 1, and selecting \u03b7 as the power of the direct channel elements, i.e.,\n\ufffd\n|{H0}i,j|2\ufffd\n= \u03b7, which allows to control said ratio.\n\nIn Fig. 2 (left) we plot the average channel gain over 103\nchannel realizations, \u03b2avg, versus \u03b7 in a K = 4 UEs scenario, where we consider various configurations of BS antennas and RS antennas. Note that the value of \u03b2 is directly related to the Shannon capacity of each UE through log(1 + \u03b2SNR) [40].\n\nWe have pessimistically assumed that the channel gain is 0 for every channel realization where the channel selection has failed to provide a solution fulfilling the respective RS passive constraint. Moreover, we have limited the number of iterations of the while loops from [42, Table 2] to avoid unreasonable computation times when the convergence is too slow at the cost of limiting the optimality of the results. As expected, for the same number of RS elements, FRIS outperforms BD-RIS, which outperforms ARIS by a wider margin. However, when selecting the minimum number of RS elements from (18), (16), and (9), FRIS and ARIS achieve a similar channel gain, while BD-RIS can get a substatial improvement (reaching over 10 dB gain for some values of \u03b7). We may also observe that an increase in the number of BS antennas effectively leads to a shift in \u03b2avg, where the shift seems to be larger for larger RS freedom, i.e., FRIS has greater benefit from more BS antennas than BD-RIS, which has greater benefit than ARIS. On the other hand, the simplified channel selection seems to perform closer to Algorithm 1 as the power of the direct channel increases, meaning that it does a better job at trying to compensate the direct channel than in projecting the solution towards the lowest eigenmode of Hr. We have included for comparison the average channel gain for a RIS scenario with M = 8 and N = 2MK elements\u2014same as the best performing ARIS selection. The RIS phases have been optitimized using numerical solvers for maximizing the condition number of the channel, which gives a measure of the orthogonality of the channel [1]. Interestingly, by allowing a small error in the orthogonality constraint, RIS can actually achieve a better channel gain than ARIS with the same number of elements, since its model actually is fixed to reflect maximum power\u2014BD-RIS and FRIS with the same N still lead to a considerable improvement of 2-5 dB. A natural extension of this work could thus consider a relaxation of the orthogonality constraint to study the interplay between channel gain and level of orthogonality.\n\nFig. 2 (right) shows the failure rate Pfail, which is defined as the rate of channel realizations where the channel selection leads to a configuration not fulfilling the passive constraint\u2014 i.e., leading to \u03b2 = 0 in our previous simulation. The same considerations as for Fig. 2 (left) are taken regarding the channel model, employed methods, etc. As expected, the higher the direct channel power (with respect to the cascaded channel power) the higher the failure rate since more power is required to compensate this channel, increasing the minimum\n\u03b2 to do it\u2014recall that \u221a\u03b2 is quadratically related to the RS\npower. We may identify similar trends in performance as in the previous simulation results, but we now see that adding extra RS elements eventually leads to 0% failure in the considered range, achieved in our results for ARIS with N = 2MK, or for BD-RIS and FRIS with N = MK. Note that the RIS model is not applicable for this case since it always leads to non-zero orthogonality mismatch by enforcing the fullreflection constraint.\n\nB. Pure LoS Example Scenario We next analyze an example of a pure LoS scenario at 2.4\nGHz to showcase the potential of channel orthogonalization with RS. The scenario is depicted in Fig. 3, where all the antenna elements are assumed isotropic, and free space propagation is assumed. In such scenario, by employing Algorithm 1, if the RS corresponds to a FRIS we reach a normalized10\nchannel gain of 5 dB, while if the RS corresponds to a BD-RIS we get a normalized channel gain of 4.85 dB. On the other hand, if the RS corresponds to an ARIS we are not able to find a suitable orthogonal channel that does not require amplification (the minimum amplification required is 7.42 dB). On the other hand, if the RS corresponds to a RIS maximizing condition number, the average channel gain is 3.84 dB, while the minimum channel gain is just 1.93 dB.\n\nThe main challenge in this type of scenarios comes from the fact that the cascaded channel suffers from double path loss, leading to significantly higher power loss than in the direct channel. Hence, the pure LoS can be seen as a worst case scenario, while considering blockage in the direct channel, or including some multipath propagation would likely help to even up the ratio between direct and cascaded channel power.\n\nC. Imperfect CSI Scenario under IID Rayleigh fading In Fig. 4 we study the effect of imperfect-CSI on the condition number of the orthogonalized channel with respect to SNR. We have based the simulations on the channel estimation procedure from Section V, which considers estimation over a single time-frequency resource\u2013i.e., leading to correspondence between the estimation SNR and the communication SNR\u2014 but we could further increase the estimation SNR, e.g., by combining several time samples or highly-correlated subcarriers. We have also focused on the case where the direct channel is blocked, i.e., H0 = 0, since the presence of an imperfect direct channel only leads to an extra addititive IID Gaussian noise term in the final channel, which has simple characterization, while the imperfect-CSI cascaded channel has less predictable impact due to the involvement of complex operations like matrix pseudoinverses. Moreover, H0 = 0\nassures that the RS models can fulfill the passive constraint in all cases whenever the respective conditions from (18),\n(16), and (9) are fulfilled. The simulation considers 103 IID\nGaussian realizations of H1 and H2 with normalized power, and we have compared a random orthogonal channel selection with a channel selection based on Algorithm 1. The results showcase how the proposed channel selection generally helps in reducing the effect of imperfect-CSI towards the loss of orthogonality, especially with excess of RS elements. Interestingly, BD-RIS outperforms FRIS even for the same number of elements, which can be understood by the fact that the FRIS configuration employs considerably more noisy channel parameters (N 2) than BD-RIS (N(N + 1)/2). Moreover, all the results show improved orthogonalization performance than RIS\u2014which has been again numerically optimized for minimum condition number\u2014even for a lower number of elements.\n"
    },
    {
        "level": "##",
        "title": "Vii. Conclusions And Future Work",
        "content": "\nWe have analysed the use passive RS technology for channel orthogonalization in MU-MIMO. We have presented three RS models which generalize the widely studied models, and we have discussed their potential implementation, as well as the respective restrictions on the achievable reflection matrices. We have also derived the conditions for achieving arbitrary (orthogonal) channel configuration with the considered RS models. Moreover, we have shown methods to optimize the channel selection procedure, and to practically estimate the channel parameters to be able to apply the corresponding RS configuration. The numerical results have showcased the potential of the methods presented, which allow for perfect channel orthogonalization with reduced loss in terms of channel gain. Overall, BD-RIS seems to achieve a good trade-off in terms of performance and complexity, but more research is needed to confirm its practicality.\n\nThe presented work takes an important step towards the achievement of OSDM, which has been proposed as the spatial converse to orthogonal time-frequency modulations like OFDM. However, these results constitute the beginning of a novel research direction with many possibilities of extension. For example, future work could consider the use of alternative technologies to RS in the task of channel orthogonalization. Regarding closer extension to the presented work, we could study the use of alternative optimization methods to those proposed in Section IV. For example, we could consider exploiting the freedom in the pseudoinverse to further improve the results, or we could try to adapt the results to the spectral norm instead of using the relaxation to Frobenius norm. Moreover, the imperfect CSI scenario could also be optimized by proposing specific channel selection schemes which take into account the distribution of the estimation error. Another interesting extension could consider studying the interplay between channel gain and level of orthogonality.\n\nThe presented results can also be employed to address other research questions. For example, these findings could be employed towards estimating the number of RIS elements required in general scenarios with different requirements. On the other hand, the general estimation procedure we studied can also be considered in such scenarios to understand the required pilot overhead.\n"
    },
    {
        "level": "##",
        "title": "Appendix Proof Of Theorem 1 We Seek To Study The Solutions To The Matrix Equation",
        "content": "\nH0 + H1\u0398SH2 = \ufffd H, (39)\nwhere \u0398S = \u0398T\nS with dimension N \u00d7N, and \ufffd\nH is a non-zero M \u00d7 K matrix. We can define WLOG \u0398S = \u0398U/L + \u0398T\nU/L, where \u0398U/L corresponds to an upper/lower triangular matrix.\n\nWe can then rewrite (39) as After vectorizing, we reach the linear equation\n\nH1\u0398U/LH2 + H1\u0398T U/LH2 + H0 = \ufffd H. (40) (H + HK(N,N))ZU/L\u03d5 = c, (41)\nwhere \u03d5 is a vector containing the unique unknowns from \u0398S\n(with the diagonal elements scaled by 1/2), H and c are defined as in (13), K(N,N) is the commutation matrix mapping vec(\u0398U/L) to vec(\u0398T\nU/L) [39], and ZU/L is a matrix selecting the columns of H+HK(N,N) associated to the N(N +1)/2\nupper/lower triangular elements after vectorization.11 Let us define the matrix associated to the upper triangular elements as HU = HZU, while the matrix associated to the lower triangular elements is then given by HL = HK(N,N)ZU, since ZL = K(N,N)ZU (and vice-versa). The existence of a solution to (39) is equivalent to the existence of a solution to (41), which is given by the rule\n\nrank \ufffd HU + HL \ufffd = MK. (42)\nCharacterizing said rank is not trivial, but, assuming that a solution is available, said solution is given by\n\n\u03d5 = \ufffd HU + HL \ufffd\u2020c, (43)\nwhere (\u00b7)\u2020 here stands for right pseudoinverse (which may not be unique). The solution to (39) can be obtained by reorganizing \u03d5 into the upper/lower triangular elements of an N \u00d7 N matrix, i.e.,\n\n\u0398U/L = vec\u22121(ZU/L\u03d5), (44)\nand constructing \u0398S = \u0398U/L + \u0398T\nU/L, where we can use the commutation matrix to introduce the sum inside the vec\u22121(\u00b7)\noperator [39].\n\nWe now proceed to prove the conditions under which a solution to (39) exists. Let us assume (9) since this is clearly a necessary condition for (39) due to the stronger constraints on the matrix of unknowns. Given the singular value decomposition H1 = U 1S1V H\n1 we can define WLOG\n\ufffd\u0398S = V H\n1 \u0398SV *\n1, and multiply from the left both sides of\n(39) by S\u22121\n1,sqU H\n1 , where S1,sq is the invertible part of S1, to reach\n\ufffdIM\n0\ufffd \ufffd\u0398S\ufffd\nH2 = |\nH,\n(45)\nwhere \ufffd\nH2 remains a randomly chosen matrix, and we have defined |\nH = S\u22121\n1,sqU H\n1 (\ufffd\nH \u2212 H0). Let us denote the top M\nrows of \ufffd\u0398S by\n\n{ \ufffd\u0398S}1:M,: = \ufffd \ufffd\u039811,S \ufffd\u039812 \ufffd , (46)\nwhere \ufffd\u039811,S must be chosen as a symmetric M \u00d7 M matrix, while \ufffd\u039812 can be chosen as an unrestricted M \u00d7 (N \u2212 M)\nmatrix. We may rewrite (46) as\n\n\ufffd\u039811,S\ufffd H2,T + \ufffd\u039812\ufffd H2,B = | H, (47)\nwhere \ufffd\nH2,T and \ufffd\nH2,B correspond to the top M \u00d7 K block and the bottom (N \u2212 M) \u00d7 K block of \ufffd\nH2, respectively. We may then apply on \ufffd\nH2,T the equivalent trick we used with H1 in (46), which here results in\n\nq\u039811,S \ufffdIK 0\ufffdT = \u00afH \u2212 q\u039812| H2,B. (48)\nFrom (48) it becomes evident that the solvability is determined by the conditions under which the top K tows of the RHS can be made symmetric. This can be seen from the fact that the left hand side (LHS) of (48) corresponds to a M\u00d7K matrix where the bottom (M \u2212 K) \u00d7 K block can be freely selected, but the top K \u00d7K block has symmetric constraint. Thus, solving (39) is equivalent to finding an arbitrary K \u00d7(N \u2212M) matrix q\u039812,T such that\n\nq\u039812,T| H2,B \u2212 | H T 2,B q\u0398 T 12,T = \u00afHT \u2212 \u00afH T T. (49)\nIf N \u2212 M \u2265 K, (49) is trivially solvable since this allows to select q\u039812,T such that q\u039812,T|\nH2,B = \u00afH\nT\nT. Let us now assume N \u2212 *M < K*. We may now proceed as before to absorb the invertible parts of |\nH2,B in the other matrices until we reach\n\n\ufffd \u00af\u0398 T 12 = \u00af\u00afH \u2212 \u00af\u00afHT. (50) \u00af\u039812 \ufffdIN\u2212M 0\ufffd \u2212 \ufffd IN\u2212M 0 The LHS then corresponds to a matrix which has a bottom-right block of zeros of dimension $(M+K-N)\\times(M+K-N)$, while the other block is anti-symmetric with $0$s on the diagonal. Moreover, the RHS is an anti-symmetric matrix with zeros in the diagonal, while the off-diagonals are in general non-zero, leading to the sufficient (\"if\") condition (16) associated to having said block of zeros in the LHS of dimension lower or equal to $1$. If we recall the transformations that we have applied to the top $K\\times K$ block of $(\\widehat{\\mathbf{H}}-\\mathbf{H}_{0})$ until reaching $\\widehat{\\mathbf{H}}$, we have essentially multiplied _randomly chosen_ matrices from the right and from the left. Thus, as long as $(\\widehat{\\mathbf{H}}-\\mathbf{H}_{0})$ has at least one non-zero entry, the non-diagonal entries of the RHS will be non-zero with probability $1$ since they are given by linear combinations of elements of randomly chosen matrices. Hence, (16) is a necessary (\"only if\") condition for randomly chosen $\\mathbf{H}_{1}$ and $\\mathbf{H}_{2}$, which completes the proof.\n"
    },
    {
        "level": "##",
        "title": "References",
        "content": "\n[1] J. V. Alegr\u00b4\u0131a and F. Rusek, \"Channel orthogonalization with reconfigurable surfaces,\" in *2022 IEEE Globecom Workshops (GC Wkshps)*,\n2022, pp. 37\u201342.\n[2] T. Hwang, C. Yang, G. Wu, S. Li, and G. Ye Li, \"Ofdm and its wireless\napplications: A survey,\" *IEEE Transactions on Vehicular Technology*, vol. 58, no. 4, pp. 1673\u20131694, 2009.\n[3] R. Hadani, S. Rakib, M. Tsatsanis, A. Monk, A. J. Goldsmith, A. F.\nMolisch, and R. Calderbank, \"Orthogonal time frequency space modulation,\" in 2017 IEEE Wireless Communications and Networking Conference (WCNC), 2017, pp. 1\u20136.\n[4] R. H. Roy III and B. Ottersten, \"Spatial division multiple access wireless\ncommunication systems,\" May 7 1996, uS Patent 5,515,378.\n[5] E. Telatar, \"Capacity of multi-antenna gaussian channels,\" European\nTransactions on Telecommunications, vol. 10, no. 6, pp. 585\u2013595,\n1999. [Online]. Available: https://onlinelibrary.wiley.com/doi/abs/10.\n1002/ett.4460100604\n[6] A. Paulraj, R. Nabar, and D. Gore, Introduction to Space-Time Wireless\nCommunications, 1st ed.\nUSA: Cambridge University Press, 2008.\n[7] N. Jindal, \"MIMO broadcast channels with finite-rate feedback,\" IEEE\nTransactions on Information Theory, vol. 52, no. 11, pp. 5045\u20135060, 2006.\n[8] T. L. Marzetta, \"Noncooperative cellular wireless with unlimited numbers of base station antennas,\" IEEE Transactions on Wireless Communications, vol. 9, no. 11, pp. 3590\u20133600, November 2010.\n[9] E.\nBj\u00a8ornson,\nL.\nSanguinetti,\nH.\nWymeersch,\nJ.\nHoydis,\nand\nT.\nL.\nMarzetta,\n\"Massive\nMIMO\nis\na\nreality\u2014what\nis\nnext?:\nFive\npromising\nresearch\ndirections\nfor\nantenna\narrays,\"\nDigital\nSignal\nProcessing,\nvol.\n94,\npp.\n3\u201320,\n2019,\nspecial\nIssue\non\nSource Localization in Massive MIMO. [Online]. Available: https: //www.sciencedirect.com/science/article/pii/S1051200419300776\n[10] E. Bj\u00a8ornson, J. Hoydis, and L. Sanguinetti, \"Massive mimo has unlimited capacity,\" *IEEE Transactions on Wireless Communications*, vol. 17,\nno. 1, pp. 574\u2013590, 2018.\n[11] H. Q. Ngo, E. G. Larsson, and T. L. Marzetta, \"Energy and spectral\nefficiency of very large multiuser mimo systems,\" IEEE Transactions on Communications, vol. 61, no. 4, pp. 1436\u20131449, 2013.\n[12] T. L. Marzetta, E. G. Larsson, H. Yang, and H. Q. Ngo, Fundamentals\nof Massive MIMO.\nCambridge University Press, 2016.\n[13] S. Willhammar, J. Flordelis, L. Van Der Perre, and F. Tufvesson, \"Channel hardening in massive mimo: Model parameters and experimental assessment,\" *IEEE Open Journal of the Communications Society*, vol. 1,\npp. 501\u2013512, 2020.\n[14] H. Q. Ngo, A. Ashikhmin, H. Yang, E. G. Larsson, and T. L. Marzetta,\n\"Cell-free massive mimo versus small cells,\" IEEE Transactions on Wireless Communications, vol. 16, no. 3, pp. 1834\u20131850, 2017.\n[15] E. D. Carvalho, A. Ali, A. Amiri, M. Angjelichinoski, and R. W. Heath,\n\"Non-stationarities in extra-large-scale massive mimo,\" IEEE Wireless Communications, vol. 27, no. 4, pp. 74\u201380, 2020.\n[16] W. Saad, M. Bennis, and M. Chen, \"A vision of 6g wireless systems:\nApplications, trends, technologies, and open research problems,\" IEEE\nNetwork, vol. 34, no. 3, pp. 134\u2013142, 2020.\n[17] A. A. Polegre, F. Riera-Palou, G. Femenias, and A. G. Armada, \"Channel hardening in cell-free and user-centric massive mimo networks with spatially correlated ricean fading,\" *IEEE Access*, vol. 8, pp. 139 827\u2013 139 845, 2020.\n[18] Z. Chen and E. Bj\u00a8ornson, \"Channel hardening and favorable propagation\nin cell-free massive mimo with stochastic geometry,\" IEEE Transactions on Communications, vol. 66, no. 11, pp. 5205\u20135219, 2018.\n[19] C. Gentile, P. B. Papazian, N. Golmie, K. A. Remley, P. Vouras, J. Senic,\nJ. Wang, D. Caudill, C. Lai, R. Sun, and J. Chuang, \"Millimeterwave channel measurement and modeling: A NIST perspective,\" IEEE\nCommunications Magazine, vol. 56, no. 12, pp. 30\u201337, 2018.\n[20] S. Priebe and T. Kurner, \"Stochastic modeling of THz indoor radio\nchannels,\" *IEEE Transactions on Wireless Communications*, vol. 12,\nno. 9, pp. 4445\u20134455, 2013.\n[21] C. Huang, A. Zappone, G. C. Alexandropoulos, M. Debbah, and\nC. Yuen, \"Reconfigurable intelligent surfaces for energy efficiency in wireless communication,\" IEEE Transactions on Wireless Communications, vol. 18, no. 8, pp. 4157\u20134170, 2019.\n[22] E. Basar, M. Di Renzo, J. De Rosny, M. Debbah, M.-S. Alouini, and\nR. Zhang, \"Wireless communications through reconfigurable intelligent surfaces,\" *IEEE Access*, vol. 7, pp. 116 753\u2013116 773, 2019.\n[23] Q. Wu and R. Zhang, \"Towards smart and reconfigurable environment:\nIntelligent reflecting surface aided wireless network,\" IEEE Communications Magazine, vol. 58, no. 1, pp. 106\u2013112, 2020.\n[24] O. Ozdogan, E. Bj\u00a8ornson, and E. G. Larsson, \"Using intelligent reflecting surfaces for rank improvement in MIMO communications,\" in ICASSP 2020 - 2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), 2020, pp. 9160\u20139164.\n[25] S. Meng, W. Tang, W. Chen, J. Lan, Q. Y. Zhou, Y. Han, X. Li, and\nS. Jin, \"Rank optimization for mimo channel with ris: Simulation and measurement,\" *IEEE Wireless Communications Letters*, vol. 13, no. 2, pp. 437\u2013441, 2024.\n[26] H. Guo, Y.-C. Liang, J. Chen, and E. G. Larsson, \"Weighted sumrate maximization for reconfigurable intelligent surface aided wireless networks,\" *IEEE Transactions on Wireless Communications*, vol. 19,\nno. 5, pp. 3064\u20133076, 2020.\n[27] Y. Zhang, C. Zhong, Z. Zhang, and W. Lu, \"Sum rate optimization\nfor two way communications with intelligent reflecting surface,\" IEEE Communications Letters, vol. 24, no. 5, pp. 1090\u20131094, 2020.\n[28] T. Jiang and W. Yu, \"Interference nulling using reconfigurable intelligent\nsurface,\" *IEEE Journal on Selected Areas in Communications*, vol. 40,\nno. 5, pp. 1392\u20131406, 2022.\n[29] X. Wei, D. Shen, and L. Dai, \"Channel estimation for ris assisted\nwireless communications\u2014part i: Fundamentals, solutions, and future opportunities,\" *IEEE Communications Letters*, vol. 25, no. 5, pp. 1398\u2013 1402, 2021.\n[30] J. V. Alegr\u00b4\u0131a, J. Vieira, and F. Rusek, \"Increased multiplexing gain\nwith reconfigurable surfaces: Simultaneous channel orthogonalization and information embedding,\" in GLOBECOM 2023 - 2023 IEEE Global Communications Conference, 2023, pp. 5714\u20135719.\n[31] S. Shen, B. Clerckx, and R. Murch, \"Modeling and architecture design\nof reconfigurable intelligent surfaces using scattering parameter network analysis,\" *IEEE Transactions on Wireless Communications*, vol. 21,\nno. 2, pp. 1229\u20131243, 2022.\n[32] H. Li, S. Shen, and B. Clerckx, \"Beyond diagonal reconfigurable\nintelligent surfaces: From transmitting and reflecting modes to single- , group-, and fully-connected architectures,\" IEEE Transactions on Wireless Communications, vol. 22, no. 4, pp. 2311\u20132324, 2023.\n[33] G. Bartoli, A. Abrardo, N. Decarli, D. Dardari, and M. Di Renzo,\n\"Spatial multiplexing in near field mimo channels with reconfigurable intelligent surfaces,\" *IET Signal Processing*, vol. 17, no. 3, p. e12195, 2023. [Online]. Available: https://ietresearch.onlinelibrary.wiley.com/ doi/abs/10.1049/sil2.12195\n[34] R. A. Tasci, F. Kilinc, E. Basar, and G. C. Alexandropoulos, \"A new\nRIS architecture with a single power amplifier: Energy efficiency and error performance analysis,\" *IEEE Access*, vol. 10, pp. 44 804\u201344 815, 2022.\n[35] R. Long, Y.-C. Liang, Y. Pei, and E. G. Larsson, \"Active reconfigurable\nintelligent surface-aided wireless communications,\" IEEE Transactions on Wireless Communications, vol. 20, no. 8, pp. 4962\u20134975, 2021.\n[36] D. Pozar, *Microwave Engineering, 4th Edition*.\nWiley, 2011. [Online].\nAvailable: https://books.google.se/books?id=JegbAAAAQBAJ\n[37] A. Kord, D. L. Sounas, and A. Al`u, \"Microwave nonreciprocity,\"\nProceedings of the IEEE, vol. 108, no. 10, pp. 1728\u20131758, 2020.\n[38] A. N. Langville and W. J. Stewart, \"The kronecker product and\nstochastic automata networks,\" Journal of Computational and Applied\nMathematics, vol. 167, no. 2, pp. 429\u2013447, 2004. [Online]. Available: https://www.sciencedirect.com/science/article/pii/S0377042703009312\n[39] J. R. Magnus and H. Neudecker, \"The commutation matrix: Some\nproperties and applications,\" *The Annals of Statistics*, vol. 7, no. 2, pp. 381\u2013394, 1979. [Online]. Available: http://www.jstor.org/stable/ 2958818\n[40] T. M. Cover and J. A. Thomas, Elements of Information Theory (Wiley\nSeries in Telecommunications and Signal Processing).\nUSA: Wiley-\nInterscience, 2006.\n[41] F. Liu, \"New kronecker product decompositions and its applications,\"\nResearch Inventy: International Journal of Engineering and Science,\nvol. 1, pp. 25\u201330, 12 2012.\n[42] T. E. Abrudan, J. Eriksson, and V. Koivunen, \"Steepest descent algorithms for optimization under unitary matrix constraint,\" IEEE Transactions on Signal Processing, vol. 56, no. 3, pp. 1134\u20131147, 2008.\n[43] E. Polak, *Optimization: algorithms and consistent approximations*.\nSpringer Science & Business Media, 2012, vol. 124.\n[44] X. Chen, Y. He, and Z. Zhang, \"Tight error bounds for nonnegative\northogonality constraints and exact penalties,\" 2022.\n[45] M. Gavish, \"A personal interview with the singular value decomposition,\" URL: https://web. stanford. edu/gavish/documents/SVDansyou. pdf, 2010.\n[46] M. Di Renzo, K. Ntontin, J. Song, F. H. Danufane, X. Qian, F. Lazarakis,\nJ. De Rosny, D.-T. Phan-Huy, O. Simeone, R. Zhang, M. Debbah, G. Lerosey, M. Fink, S. Tretyakov, and S. Shamai, \"Reconfigurable intelligent surfaces vs. relaying: Differences, similarities, and performance comparison,\" *IEEE Open Journal of the Communications Society*, vol. 1,\npp. 798\u2013807, 2020.\n[47] Y. Liu, X. Liu, X. Mu, T. Hou, J. Xu, M. Di Renzo, and N. Al-\nDhahir, \"Reconfigurable intelligent surfaces: Principles and opportunities,\" *IEEE Communications Surveys & Tutorials*, vol. 23, no. 3, pp. 1546\u20131577, 2021."
    }
]