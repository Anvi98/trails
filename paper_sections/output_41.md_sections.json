[
    {
        "level": "#",
        "title": "Control Contraction Metrics On Lie Groups",
        "content": "\nDongjun Wu1, Bowen Yi2, Ian R. Manchester3\n\n  Abstract\u2014 In this paper, we extend the control contraction\nmetrics (CCM) approach, which was originally proposed for the\nuniversal tracking control of nonlinear systems, to those that\nevolves on Lie groups. Our idea is to view the manifold as a\nconstrained set that is embedded in Euclidean space, and then\npropose the sufficient conditions for the existence of a CCM\nand the associated controller design. Notably, we demonstrate\nthat the search for CCM on Lie groups can be reformulated as\nconvex conditions. The results extend the applicability of the\nCCM approach and provide a framework for analyzing the\nbehavior of control systems with Lie group structures.\n  Index Terms\u2014 nonlinear systems, contraction analysis, Lie\ngroups, tracking control\n"
    },
    {
        "level": "##",
        "title": "I. Introduction",
        "content": "\n  Contraction analysis has gained widespread recognition\nboth within and beyond the control community since the\nseminal paper by Lohmiller and Slotine [1]. It provides\na powerful and flexible tool to analyze the stability and\ndynamical behaviour of nonlinear systems by means of linear\nsystems theory. Over the years, researchers have extensively\napplied contraction analysis to various domains, including\nobserver design [2,3], trajectory tracking [4, 5], machine\nlearning [6]\u2013[9], and motion planning [10,11]. For a com-\nprehensive review of the literature and future perspectives on\nthis field, the interested reader may refer to the recent survey\npaper [12] and the monograph [13].\n  One recent development in contraction analysis involves\nits utilization as a synthesis tool for constructive nonlinear\ncontrol, exemplified by the widely popular control contrac-\ntion metric (CCM) method introduced in [14]. It is shown\nthat by searching for a CCM, the system could be universally\nstabilized for any feasible reference trajectories. A salient\nfeature of this approach is that its design procedure can be\nturned into a convex optimization problem. See also [15]\nfor its robust version for non-affine systems. In the last\nfew years, the CCM approach has been successfully applied\nto many domains, such as the safe control of robots [16],\nadaptive control [17], model predictive control (MPC) [18],\nand motion planning [10,11].\n  The existing results on CCM primarily focus on sys-\ntems evolving on Euclidean space. However, a majority of\n\nnonlinear systems reside on manifolds, including robotic\nmodels and rigid body models of vehicles such as aerial or\nunderwater robots. It is still an open problem to extend the\nCCM approach to manifolds. In this paper, we propose some\npreliminary results for such an extension to Lie groups. The\nmain contributions of the paper are twofold:\n\n1. We formulate the CCM on embedded submanifolds and\nthen specialize it to Lie groups setting. Subsequently, we demonstrate that the search for a CCM on Lie groups\ncan be characterized by some convex conditions.\n2. In the sampled-data version of the \"standard\" CCM, it\nis required to compute the geodesic during the online implementation at every sampling time. We show that computation of geodesics can be avoided by using other types of curves. It provides easier solutions while ensuring guaranteed stability.\nNotations: Given a manifold M, T M and T \u2217M represent the tangent and co-tangent bundles of M. We use g(\u00b7, \u00b7)\nand d to denote the Riemannian metric and the associated Riemannian distance, respectively. \u2207 stands for the Levi-\nCivita connection. Tr(\u00b7) is the trace of a square matrix, and \u2225 \u00b7 \u2225 is the Euclidean 2-norm. For symmetric matrices A, B \u2208 Rn\u00d7n, A > B means that the matrix (A \u2212 B) is positive definite; for a square matrix X, we define He{X} :=\nX + X\u22a4. Given a vector field f, DfQ stands for the directional derivative of a smooth quantity Q along f, i.e.\n\nDfQ = \ufffd\nj\n\u2202Q\n\u2202xj fj, particularly LfQ representing the Lie derivative. For m \u2208 N+, denote the set \u2113m := {1, \u00b7 \u00b7 \u00b7 , m}.\n"
    },
    {
        "level": "##",
        "title": "Ii. Preliminaries",
        "content": "\nIn this section, we review some preliminary results about the control contraction metric (CCM) approach [14].\n\nConsider the nonlinear system\n\n$$\\dot{x}=f(x,t)+B(x,t)u\\tag{1}$$\nwith the state x \u2208 X \u2286 Rn and the input u \u2208 Rm, where the functions f : Rn \u2192 Rn and B(x) = col(b1(x), \u00b7 \u00b7 \u00b7 , bm(x))\nare assumed continuously differentiable, and B has constant rank m. 1 The paper [14] considers the Euclidean case with X = Rn. We call (x\u22c6(t), u\u22c6(t)) \u2208 X \u00d7 Rm a feasible pair, if it satisfies \u02d9x\u22c6 = f(x\u22c6, t) + B(x\u22c6, t)u\u22c6 for all t \u2265 0.\n\nProblem set. For the given system (1), we aim to find a feedback law u\n= kp(x, x\u22c6, u\u22c6, t) that exponentially stabilizes any feasible desired trajectory x\u22c6.\n\nThe first step in contraction analysis is to calculate the variational dynamics of the system (1), that is\n\n$\\delta x=A(x,u,t)\\delta x+B(x,t)\\delta u$ (2)\nwith A(x, u, t) = \u2202f\n\n                \u2202x(x, t)+\ufffdm\n                           i=1\n                              \u2202bi\n                               \u2202x ui. The variables \u03b4x \u2208\nT X and \u03b4u \u2208 T Rm are the differential state and input, which\nare the infinitesimal variations in terms of the original system\n(1); see [14, 19] for details. A notable feature is that the\nvariational system (2) is linear time-varying (LTV) if we\nregard x and u as exogenous signals.\n  In the CCM approach, the design of a tracking controller\nis reformulated as the search for a smooth control contraction\nmetric M : Rn \u00d7 R \u2192 Rn\u00d7n\n                       >0\n                            and a differential controller\n\u03b4u = k\u03b4(x, \u03b4x, u, t) satisfying\nC0 The metric M is uniformly bounded, i.e.\n\n$\\alpha_{1}I\\leq M(x,t)\\leq\\alpha_{2}I$, $\\forall x,t$ (3)\nfor \u03b11, \u03b12 > 0 and satisfies the contraction condition\n\n$$B^{\\top}M\\delta x=0\\implies$$ $$\\delta x^{\\top}\\left(\\frac{\\partial M}{\\partial t}+D_{f}M+\\mbox{He}\\{MA\\}+2\\lambda M\\right)\\delta x<0\\tag{4}$$\n\nfor all $x,u,t$ and non-zero $\\delta x$, with some $\\lambda>0$.\n\nAs proven in [14], the following two stronger conditions imply (4):\n\n**C1**: For $\\delta x\\neq0$, the implication holds\n\n$$\\delta x^{\\top}\\left(\\frac{\\partial M}{\\partial t}+D_{f}M+\\mbox{He}\\left\\{\\frac{\\partial f^{\\top}}{\\partial x}\\,M\\right\\}+2\\lambda M\\right)\\delta x<0.\\tag{5}$$\n**C2**: For each $i\\in\\ell_{m}$,\n\n$$D_{b_{i}}M+\\mbox{He}\\left\\{\\frac{\\partial b_{i}}{\\partial x}\\,M\\right\\}=0.\\tag{6}$$\n\n  When (6) is satisfied, we call bi a Killing vector field under\nthe metric M(x, t), and in this case, M(x, t) is referred to\nas a strong CCM. Otherwise, if only C1 holds, we call it a\nweak CCM.\n  Remark 1: It should be noted that the (global) existence\nof Killing fields on a manifold is related to the topological\nproperties of the manifold [20], making a relatively strict\ncondition. It might be easier to find a weak CCM for a\ngiven system on manifolds. However, the challenge can be\ncircumvented if we consider locally.\n  Once a CCM has been found, a controller can be synthe-\nsized in the following two steps.\nS1 Find a differential feedback \u03b4u = k\u03b4(x, \u03b4x, u, t) such\n    that\n\n\u03b4x\u22a4 \u02d9M\u03b4x + 2\u03b4x\u22a4M(A\u03b4x + Bk\u03b4) < \u22122\u03bb\u03b4x\u22a4M\u03b4x\n\nholds for all x, u, t and non-zero \u03b4x.\nS2 Design a feedback law u = kp(\u00b7) to ensure that the\nclosed-loop dynamics conform to the desired differential systems when subjected to the differential feedback\n\u03b4u that is obtained in S1.\nFor S2, a feasible construction is that, given a minimizing geodesic \u03b3 : [0, 1] \u2192 Rn joining x\u22c6(t0) to x(t0), the feedback kp can be selected as the solution to\n\n$k_{p}(c,u_{\\star},t,s)=u_{\\star}(t)+\\int_{0}^{s}k_{\\delta}\\left(c(s),c^{\\prime}(s),k_{p}(c,u_{\\star},t,s),t\\right)ds$\nwhere c(t, s) is the solution to the system (1) with initial condition \u03b3(s). Then u\n=\nkp(c, u\u22c6, t, 1) exponentially stabilizes the trajectory x\u22c6(\u00b7), i.e., d(x\u22c6(t), x(t)) \u2264\ne\u2212\u03bbtd(x\u22c6(0), x(0)),\n\u2200t \u2265 0.\n\nThe control strategy described above is open-loop control as there is only onetime measurement of the state. Its performance and robustness can be enhanced by considering the sampled-date controller - recursively applying the openloop control described above at sampled instances [14] - or by adopting the minimal geodesics in real time [21].\n"
    },
    {
        "level": "##",
        "title": "Iii. Control Contraction Metrics On Lie Groups A. General Results",
        "content": "\nThe Lie groups commonly encountered in control systems have a structure characterized as matrix Lie groups multiplied by (in direct product with) a vector space. Many of them, if not all, can be seen as \"constrained submanifolds\"\nwithin certain Euclidean spaces, e.g., SO(n) = {X \u2208\nRn\u00d7n : X\u22a4X = I, det X = 1}. Therefore, it is natural to view these as systems in Euclidean space with constraints\n\n$$\\mathcal{M}=\\{x\\in\\mathbb{R}^{n}:h(x)=0\\},\\tag{7}$$\n\nwhere the smooth function $h:\\mathbb{R}^{n}\\rightarrow\\mathbb{R}^{q}$ has constant rank.\n\nIn this section, we consider the system model in the form (1) with the state space $\\mathcal{X}$ being $\\mathcal{M}$. To guarantee that the vector fields $f$ and $b_{i}$ ($i\\in\\ell_{m}$) are tangent to the manifold, it is necessary and sufficient to satisfy the transversality condition\n\n$$L_{f}h(x)=0,\\quad L_{b_{i}}h(x)=0.\\tag{8}$$\n\nfor all x \u2208 M and t \u2265 0. We aim to extend the CCM\napproach to the systems on manifolds to exponentially track\na feasible desired trajectory x\u22c6(t) \u2208 M.\n  Mimicking the conditions C0-C2, we propose the corre-\nsponding version on the manifold M as follows. A natural\nidea is to equip the manifold with the induced metric within\nM \u00d7 R\u22650 that is required to be positive definite on the\ntangent bundle T M. These conditions are sufficient to design\na CCM controller on manifolds, which will be introduced in\nProposition 3 below.\nA0 There exist two positive constants a1, a2 such that\n  \u2202h\n  \u2202x\u03b4x = 0 =\u21d2 a1\u2225\u03b4x\u22252 \u2264 \u03b4x\u22a4M(x, t)\u03b4x \u2264 a2\u2225\u03b4x\u22252\n\nA1 For some \u03bb > 0 and \u2200\u03b4x \u0338= 0, the following holds\n\n$$B^{\\top}M\\delta x=0\\tag{9}$$ $$\\frac{\\partial h}{\\partial x}\\delta x=0$$ $$\\delta x^{\\top}\\left(\\frac{\\partial M}{\\partial t}+\\partial_{f}M+\\mbox{He}\\left\\{\\frac{\\partial f^{\\top}}{\\partial x}\\ M\\right\\}+2\\lambda M\\right)\\delta x<0$$\nA2 Each bi is a Killing field, i.e., for all \u03b4x1, \u03b4x2\n\u2202h\n\u2202x(x)\u03b4x = 0 =\u21d2\n\n\u2202x \ufffd\ufffd \u03b4x = 0. (10) \u03b4x\u22a4 \ufffd DbiM + He \ufffd M \u2202bi\n\n  Remark 2: In contrast to the Euclidean case, the new\ningredient in A0-A1 is\n                      \u2202h\n                      \u2202x\u03b4x = 0, which imposes the\nconstraint \u03b4x \u2208 T M. Similarly to C2, the condition A2\nis related to the uniform stabilizability of the differential\ndynamics for arbitrary u\u22c6 [14,22]. However, our case only\nrequires the condition on the set {x \u2208 Rn : h(x) = 0}.2\n\n  Once a function M(x, t) satisfying A0-A2 can be found,\nwe call it a CCM on M. Then, we can proceed to controller\ndesign as follows. Assume that (x\u22c6(\u00b7), u\u22c6(\u00b7)) is a feasible\npair of the system (1) and \u03b3 : [0, 1] \u2192 M is the minimizing\ngeodesic under the induced metric from Rn joining x\u22c6(t0)\nto x(t0). We have the following.\n  Proposition 3: Let M(x, t) be a CCM on M satisfying\nA0 - A3. There exist open-loop and sampled-data exponen-\ntially stabilizing controllers of the trajectory x\u22c6(\u00b7).\n    Proof: In the proof, we show the existence of the open-\nloop and sampled-data controllers that exponentially stabilize\nthe tracking error system.\n  1) Open-loop controller. Let u(t, s), x(t, s) be the solution\nto the partial differential system\n          \u2202x\n           \u2202t = f(x, t) + B(x, t)u\n\n(11) 2\u03c1(x, t)B(x, t)\u22a4M(x, t)\u2202x \u2202s \u2202u \u2202s = \u22121\nwith s \u2208 [0, 1], u(t, 0) = u\u22c6(t), \u2200t \u2265 t0 and x(t0, s) =\n\u03b3(s), \u2200s \u2208 [0, 1], where the scalar function \u03c1(x, t) \u2265 0 will be determined later in the proof to guarantee the contraction of the closed loop.\n\nConsidering the infinitesimal variable \u03b4x(t) := \u2202x\n\u2202s (t, s), we calculate the evolution of energy:\n\n$$\\frac{d}{dt}\\int_{0}^{1}\\delta x^{\\top}M\\delta xds$$ $$=\\int_{0}^{1}2\\delta x^{\\top}M\\left(\\frac{\\partial f}{\\partial x}\\delta x+\\sum_{i=1}^{m}u_{i}\\frac{\\partial b_{i}}{\\partial x}\\delta x+\\sum_{i=1}^{m}\\frac{\\partial u_{i}}{\\partial s}b_{i}\\right)$$ $$\\quad+\\delta x^{\\top}\\left(\\frac{\\partial M}{\\partial t}+D_{f}M+\\sum_{i=1}^{m}u_{i}D_{b_{i}}M\\right)\\delta xds$$ $$=\\int_{0}^{1}\\delta x^{\\top}\\left(\\frac{\\partial M}{\\partial t}+D_{f}M+\\mathrm{He}\\left\\{M\\frac{\\partial f}{\\partial x}\\right\\}\\right)\\delta x$$ $$\\quad+\\sum_{i=1}^{m}u_{i}\\delta x^{\\top}\\left(D_{b_{i}}M+\\mathrm{He}\\left\\{M\\frac{\\partial b_{i}}{\\partial x}\\right\\}\\right)\\delta x$$ $$\\quad+2\\delta x^{\\top}\\sum_{i=1}^{m}\\frac{\\partial u_{i}}{\\partial s}Mb_{i}ds.$$\n2In fact, the condition (10) coincides with the definition of Killing vector fields i.e. LbM(x, t) = 0, which should not be surprising. Indeed, LbM(\u03b4x, \u03b4x) =\nd dt\n\n\ufffd\n \u2202\u03c6b\n  t(x)\n  \u2202x\n    \u03b4x\n      \ufffd\u22a4\n        M(t, \u03c6b\n            t(x)) \u2202\u03c6b\n                 t (x)\n                \u2202x\n                   \u03b4x where\n\n\ufffd\ufffd\ufffd\n  t=0\n\n\u03c6b\n t : x \ufffd\u2192 \u03c6b\n        t(x) is the flow of the vector field b. Expanding the above\nequation results in (10).\n\n\u2202x\n  \ufffd\n    \u2212 \u03c1MBB\u22a4M\n                 \ufffd\n                  \u03b4xds.\n\nDefine a = \u03b4x\u22a4( \u2202M\n\nInvoking\n         A2,\n               the\n                   fact\n                        that\n                              \u2202h\n                              \u2202xvs\n                                     =\n                                         0\n                                             and\n                                                  plug-\nging in (11), we immediately get\n                                   d\n                                   dt\n                                     \ufffd 1\n                                      0 \u03b4x\u22a4M\u03b4xds\n                                                     =\n\ufffd 1\n 0 \u03b4x\u22a4 \ufffd\n        \u2202M\n         \u2202t + DfM + He\n                         \ufffd\n                           M \u2202f\n\n\u2202t +DfM +He\n                 \ufffd\n                   M \u2202f\n\n\u2202x\n  \ufffd\n   \u22122\u03bbM)\u03b4 and\n\na2 + b2)/b otherwise. It follows that\n\nb = \u03b4x\u22a4MBB\u22a4\u03b4x. Invoking A1, we set \u03c1 as 0 if a < 0\nand (a +\n       \u221a\n\n$$\\frac{d}{dt}\\int_{0}^{1}\\delta x^{\\top}M\\delta x ds<-2\\lambda\\frac{d}{dt}\\int_{0}^{1}\\delta x^{\\top}M\\delta x ds,$$\nshowing that u(t, 1) exponentially stabilizes the trajectory x\u22c6(\u00b7), i.e., there exist two constants K, \u03bb > 0 such that dM(x\u22c6(t), x(t)) \u2264 Ke\u2212\u03bb(t\u2212t0)dM(x\u22c6(t0), x(t0))\n(12)\nwhere dM(\u00b7, \u00b7) stands for the Riemannian distance on the manifold M under the metric M(x, t). Note that here K\nmay be larger than 1 since the initial curve \u03b3 is the geodesic under the induced metric.\n\n2) *Sampled-data controller.* Choose a sampling time T > 0\nsatisfying K\n\ufffd\n\nsatisfying $K\\sqrt{\\frac{a_{2}}{a_{1}}}e^{-\\lambda T}=:k<1$, in which the constant $K$ is the same as in (12). At each sampling time instant $t_{i}$, $i=1,2,\\cdots$, measure the state $x(t_{i})$, compute a minimizing geodesic $\\gamma_{i}$ connecting $x_{\\star}(t_{i})$ to $x(t_{i})$ under the _induced metric_ from the ambient space and apply the open-loop control described above with initial condition $x(t_{i},s)=\\gamma_{i}(s)$ on the interval $[t_{i},t_{i+1})$. Then, such a sampled-data feedback exponentially stabilizes the trajectory $x_{\\star}(\\cdot)$. Let $d(\\cdot,\\cdot)$ be the Riemannian distance corresponding to the induced metric from the ambient space on $\\mathcal{M}$ and $d_{M}(\\cdot,\\cdot)$ the one corresponding to the metric $M$. Invoking (12) and Lemma 8, we have for all $i\\in\\mathbb{N}_{+}$ and $k\\in(0,1)$,\n\n$$d(x(t_{i+1}),x_{\\star}(t_{i+1}))\\leq\\frac{1}{\\sqrt{a_{1}}}d_{M}(x(t_{i+1}),x_{\\star}(t_{i+1}))$$ $$\\leq\\frac{1}{\\sqrt{a_{1}}}Ke^{-\\lambda T}d_{M}(x(t_{i}),x_{\\star}(t_{i}))$$ $$\\leq\\sqrt{\\frac{a_{2}}{a_{1}}}Ke^{-\\lambda T}d(x(t_{i}),x_{\\star}(t_{i}))$$ $$=kd(x(t_{i}),x_{\\star}(t_{i})).$$\nIt is then standard argument to show\n\n$d_{M}(x(t),x_{\\star}(t))\\leq Ke^{-\\tilde{\\lambda}(t-t_{0})}d_{M}(x(t_{0}),x_{\\star}(t_{0}))$\nfor some K\u2032, \u02dc\u03bb > 0 and all t \u2265 t0.\n\nIt complets the proof.\n\nRemark 4: Note that it is unnecessary to choose the initial curves \u03b3(\u00b7) and \u03b3i(\u00b7) as the geodesics - under the metric M(x, t) - for the open-loop and sampled-data controllers. In fact, thanks to assumption A1, there exist constants c1, c2 >\n0 such that c1I \u2264 M(x, t) \u2264 c2I on T M. Therefore, by Lemma 8 in Appendix, the geodesic distance under the metric M is equivalent to the one induced by the metric of the ambient space. This idea can be also used to design a sampled-data feedback when the geodesic on M under the induced metric, e.g. Euclidean metric, from the ambient space can be easily computed.\n\n  Remark 5: The conditions A0-A2 have two drawbacks\nfrom a numerical implementation perspective. Firstly, these\nconditions are non-convex, which require heavy computa-\ntional burden. Second, when the dimension of the manifold\nM is much smaller than that of the ambient space, numer-\nous unnecessary computations will arise, adding an undue\ncomputational burden. More precisely, one needs to search\nfor a matrix function taking values in Rn\u00d7n, while M only\nhas the dimension q \u226a n.\n"
    },
    {
        "level": "##",
        "title": "B. Convexified Conditions",
        "content": "\nIn this section, we propose a modified version of conditions to address the aforementioned numerical challenges.\nThe results are particularly useful on systems evolved on Lie\ngroups. Toward this end, we make the following assumption.\nA3 The\ntangent\nbundle\nof\nM\nin\n(7)\nis\nspanned\nby *independent* vector fields {s1, \u00b7 \u00b7 \u00b7 , sq}. Assume\n\u2225S(S\u22a4S)\u22121\u2225 \u2264 cS, \u2200x \u2208 M with some cS and the\ndefinition S(x) := [s1(x), \u00b7 \u00b7 \u00b7 , sq(x)].\nUnder the above assumption, we are able to find some\nsmooth matrix function E : M \u00d7 R\u22650 \u2192 Rq\u00d7m such that\n$B(x,t)=S(x)E(x,t)$, (13)\ndue to the fact bi \u2208 T M. Likewise, \u03b4x \u2208 T M can be written as \u03b4x = S(x)v(x) for some v(x) \u2208 Rq. Now, instead of searching for M \u2208 Rn\u00d7n directly, we may search for another metric M(x, t) in a lower-dimensional space Rq\u00d7q, and the previous metric M is parameterized by\n\n$$M(x,t)=P_{S}(x)\\mathfrak{M}(x,t)P_{S}^{\\top}(x)\\tag{14}$$\nwhere PS = S(S\u22a4S)\u22121 is the projection operator which is computed before searching for the CCM.\n\nConsidering the boundedness of PS, the condition A0 is equivalent to:\nA0\u2032 there exist two positive constants a1, a2 such that a1Iq \u2264 M(x, t) \u2264 a2Iq,\n\u2200x \u2208 M, t \u2265 0.\n\n(15)\n\nMeanwhile, writing $\\delta x=S(x)v(x)\\in T{\\cal M}$, and invoking (13) and (14), we have $B^{\\top}M\\delta x=E^{\\top}{\\cal M}v$. Then, **A1-A2** can be reformulated as:\n\n${\\bf A1^{\\prime}}$ For $v\\in\\mathbb{R}^{q}\\backslash\\{0\\}$, the following implication holds\n\n$$E^{\\top}{\\cal M}v=0\\implies$$ $$v^{\\top}\\left(\\frac{\\partial{\\cal M}}{\\partial t}+D_{f}{\\cal M}+{\\rm He}\\{{\\cal M}S_{f}\\}+2\\lambda{\\cal M}\\right)v<0\\tag{16}$$\n\nwhere the known matrices $S_{f}:=D_{f}(P_{S}^{\\top})S+P_{S}^{\\top}\\frac{\\partial f}{\\partial x}S$ and $S_{b_{i}}:=D_{b_{i}}(P_{S}^{\\top})S+P_{S}^{\\top}\\frac{\\partial b_{i}}{\\partial x}S$ are in $\\mathbb{R}^{q\\times q}$.\n\n${\\bf A2^{\\prime}}$ For each $i\\in\\ell_{m}$:\n\n$$D_{b_{i}}{\\cal M}+S_{b_{i}}^{\\top}{\\cal M}+{\\cal M}S_{b_{i}}=0.\\tag{17}$$\nFollowing [14], we convexify A0\u2032 - A2\u2032 via the \"musical isomorphism\" W \u22121(x, t) = M(x, t). Then, (15) and (17)\nare equivalent to\n\n$$\\frac{1}{a_{2}}I_{q}\\leq W\\leq\\frac{1}{a_{1}}I_{q},\\tag{18}$$\nand3\n\n$$-D_{b_{i}}W+WS_{b_{i}}^{\\top}+S_{b_{i}}W=0.\\tag{19}$$\nrespectively.\n\nFor (16), it is equivalent to the existence of a scalar function \u03c1(x, t) such that for all x, t:\n\n$$-\\frac{\\partial W}{\\partial t}-D_{f}W+WS_{f}^{\\top}+S_{f}W+2\\lambda W-\\rho EE^{\\top}<0.\\tag{20}$$\n\nThe formulas (18) - (20) is convex w.r.t. to the metric $W$ to be searched for. Once $\\rho$ and $W$ has been obtained, we can proceed to controller design with the CCM\n\n$$M=P_{S}W^{-1}P_{S}^{\\top}.\\tag{21}$$\nRemark 6: In Lie groups, the above condition A3 is always guaranteed as the tangent bundle of a Lie group G\nis trivial in the sense that T G = G \u00d7 g, see e.g., [23]. Thus, for example, T G is spanned by left (right)-invariant vector fields. On the other hand, generally even if there exist no global vector fields spanning T M, it is always possible to work locally.\n"
    },
    {
        "level": "##",
        "title": "C. Ccm On Lie Groups",
        "content": "\n  Most of Lie groups in control applications can be modeled\nas G \u00d7 Rl, where G is a Lie subgroup of GL(\u00b5) = {A \u2208\nR\u00b5\u00d7\u00b5 : A invertible}.4 This class of Lie groups is naturally\nembedded in the Euclidean space R\u00b52+l.\n  We use the space O(2)\u00d7R as a case study to illustrate how\nto apply the methods proposed in the previous subsection.\n  Step 1: We embed the Lie group O(2) \u00d7 R into R5 via\n\nO(2) \u00d7 R \u220b (R, x) \ufffd\u2192 (r, x) := [R11, R12, R21, R22, x]\u22a4\n\nwhere Rij are the elements of R \u2208 O(2). The constraint\nmap h, with q = 3, is then\n\n$$h(r,x)=\\begin{bmatrix}r_{1}^{2}+r_{3}^{2}-1\\\\ r_{2}^{2}+r_{4}^{2}-1\\\\ r_{1}r_{2}+r_{3}r_{4}\\end{bmatrix},$$\n\nwhich is a reinterpretation of $R^{\\top}R=I_{2}.$ From $h,$ we can determine the matrix $S(r,x).$ This is rather straightforward:\n\n$$S(r,x)=\\begin{bmatrix}0&0&0&0&1\\\\ -\\frac{r_{3}}{\\sqrt{2}}&\\frac{r_{3}}{\\sqrt{2}}&-\\frac{r_{4}}{\\sqrt{2}}&\\frac{r_{3}}{\\sqrt{2}}&0\\end{bmatrix}^{\\top}.$$\n\nIn addition, we have S\u22a4S = I2, and thus A0 is satisfied. It\nyields PS(r, x) = S(r, x).\n  Step 2: Write the system dynamics into standard form (1)\nand search for W \u2208 R2\u00d72 satisfying (18)-(20).\n  Step 3: Solve the partial differential equation (11) - the\npath integral - to obtain the controller. We need to calculate\nthe geodesic on O(2) \u00d7 R under the induced metric from\nthe ambient space. Since O(2) is compact, the geodesic is\nnothing but given by the matrix exponential. That is, given\n\n$R_{1},R_{2}$ in the same component of $O(2)$, the geodesic joining $R_{1}$ to $R_{2}$ is given by $t\\mapsto R_{1}\\exp(\\log(R_{1}^{\\top}R_{2})t)$. Thus, the geodesic on $O(2)\\times\\mathbb{R}$ joining $(R_{1},x_{1})$ to $(R_{2},x_{2})$ is $t\\mapsto(R_{1}\\exp(\\log(R_{1}^{\\top}R_{2})t),(1-t)x_{1}+tx_{2})$.\n\nFollowing the above three steps, we are able to design CCM-based controllers for general control systems evolving on $G\\times G_{1}\\times\\mathbb{R}^{k}$, where $G$ is a compact Lie group in $GL(\\mu)$ and $G_{1}$ represents a Lie group embedded in $\\mathbb{R}^{p}$.\n\n_Remark 7_: In Step 1, it is unnecessary to compute $S$ from the constraint $h(r,x)$. As we mentioned before, the tangent bundle of a Lie group is trivial and can be simply chosen as the left (or right) invariant vector fields, which is isomorphic to the Lie algebra. For example, the Lie algebra of $O(2)\\times\\mathbb{R}$ is $\\sigma(2)\\times\\mathbb{R}$ for a basis is\n\n$$E_{1}=\\begin{bmatrix}0&0\\\\ 0&0\\end{bmatrix}\\times\\{1\\}.\\quad E_{2}=\\begin{bmatrix}0&\\frac{1}{\\sqrt{2}}\\\\ \\frac{-1}{\\sqrt{2}}&0\\end{bmatrix}\\times\\{0\\},$$\nThe left-invariant vector fields corresponding to E1, E2 are\n\n$S_{1}=\\begin{bmatrix}0&0\\\\ 0&0\\end{bmatrix}\\times\\{1\\},\\ S_{2}=R\\begin{bmatrix}0&\\frac{-1}{\\sqrt{2}}\\\\ \\frac{1}{\\sqrt{2}}&0\\end{bmatrix}\\times\\{0\\},$\nfrom which one easily recovers S(r, x).\n\nExample 1: Consider the space SE(3):\n\n$$SE(3)=\\left\\{\\begin{bmatrix}R&v\\\\ 0&1\\end{bmatrix}\\in\\mathbb{R}^{4\\times4}:R^{\\top}R=I,\\det R=1,v\\in\\mathbb{R}^{3}\\right\\}.$$\n\nwhich is isomorphic to $SO(3)\\times\\mathbb{R}^{3}.$ Embed $SE(3)$ into $\\mathbb{R}^{12}$ as in the previous subsection and denote the state variable in $\\mathbb{R}^{12}$ as $(r,x).$ Note that $\\dim\\{SE(3)\\}=6,$ we shall search for a CCM $M(x,t)\\in\\mathbb{R}^{6\\times6}.$ Since $\\mathfrak{s}(3)=\\mathfrak{so}(3)\\times\\mathbb{R}^{3},$ it is easy to calculate $S(r,v)\\in\\mathbb{R}^{12\\times6}$ as\n\n$$S(r,x)=\\begin{bmatrix}0_{9\\times3}&S_{r}\\\\ I_{3}&0_{3\\times3}\\end{bmatrix}$$\nin which\n\n$$S_{r}=\\frac{1}{\\sqrt{2}}\\begin{bmatrix}-r_{2}&-r_{3}&0\\\\ r_{1}&0&-r_{3}\\\\ 0&r_{1}&r_{2}\\\\ -r_{5}&-r_{6}&0\\\\ r_{4}&0&-r_{6}\\\\ 0&r_{4}&r_{5}\\\\ -r_{8}&-r_{9}&0\\\\ r_{7}&0&-r_{9}\\\\ 0&r_{7}&r_{8}\\end{bmatrix}$$\n\nOne can verify that $S^{\\top}S=I_{6}$. As a consequence, $P_{S}(r,x)=S(r,x)$.\n\nConsider the system dynamics\n\n$$\\dot{R}=R\\Omega$$ $$\\dot{v}=-kv+Re,$$\n\nin which $e$ is a fixed unit vector in $\\mathbb{R}^{3}$ and $\\Omega\\in\\mathfrak{so}(3)$ can be directly controlled. The control objective is to make $v(t)$ exponentially converge to a given desired feasible $v_{\\star}(t)$.\n\nThe matrices $S_{f}$ and $S_{b_{i}}$ can be easily computed:\n\n$$S_{f}=\\begin{bmatrix}-kI_{3}&(I_{3}\\otimes e^{\\ |\\ \\ })S_{r}\\\\ 0_{3\\times3}&0_{3\\times3}\\end{bmatrix},\\quad S_{b_{i}}=\\begin{bmatrix}0_{3\\times3}&0_{3\\times3}\\\\ 0_{3\\times3}&F_{i}\\end{bmatrix}$$\nwhere\n\n$$F_{1}=\\frac{1}{2}\\begin{bmatrix}r_{2}-r_{4}&r_{3}&r_{6}\\\\ 0&-r_{4}&-r_{5}\\\\ 0&r_{1}&r_{2}\\end{bmatrix},$$ $$F_{2}=\\frac{1}{2}\\begin{bmatrix}-r_{7}&0&r_{9}\\\\ r_{2}&r_{3}-r_{7}&-r_{8}\\\\ -r_{1}&0&r_{3}\\end{bmatrix},$$ $$F_{3}=\\frac{1}{2}\\begin{bmatrix}-r_{8}&-r_{9}&0\\\\ r_{5}&r_{6}&0\\\\ -r_{4}&-r_{7}&r_{6}-r_{8}\\end{bmatrix}.$$\n\nWe can then substitute these matrices into (18)-(20) to solve for the matrix function $W$.\n"
    },
    {
        "level": "##",
        "title": "D. More Abstract Manifolds",
        "content": "\nIn this subsection, we provide an intrinsic treatment of CCM on abstract manifolds whose embeddings into Euclidean spaces are not immediately obvious. These results are of theoretical interest and may be viewed as a high level guideline - thanks to their much simpler forms.\n\nConsider a Riemannian manifold M equipped with a metric g0. Let x(t, s) be the solution to the system (1) with initial condition \u03b3(s) at t = 0, with \u03b3 : [0, 1] \u2192 M a geodesic under the metric g0.\n\nWe shall look for a CCM g, such that\n\n$$\\frac{1}{2}\\frac{d}{dt}g\\left(\\frac{\\partial x(t,s)}{\\partial s},\\frac{\\partial x(t,s)}{\\partial s}\\right)\\leq-\\lambda g\\left(\\frac{\\partial x(t,s)}{\\partial s},\\frac{\\partial x(t,s)}{\\partial s}\\right)\\tag{22}$$\n\nfor some $\\lambda>0$ and all $u,\\,t\\geq0,\\,s\\in[0,1].$ Let $\\frac{D}{ds}$ be the covariant derivative associated with the metric $g.$ For notational ease, denote $v_{s}:=\\frac{\\partial x(t,s)}{\\partial s},$ then the left hand side \n\u2202s\n, then the left hand side of (22) can be calculated as\n\n$$\\frac{1}{2}\\frac{dg\\left(v_{s},v_{s}\\right)}{dt}$$ $$=g\\left(\\frac{Dv_{s}}{dt},v_{s}\\right)+\\dot{g}(v_{s},v_{s})$$ $$=g\\left(\\nabla_{v_{s}}\\left(f+\\sum_{i=1}^{m}u_{i}b_{i}\\right),v_{s}\\right)+\\dot{g}(v_{s},v_{s})$$ $$=g(\\nabla_{v_{s}}f+\\sum_{i=1}^{m}u_{i}\\nabla_{v_{s}}b_{i}+\\sum_{i=1}^{m}\\frac{\\partial u_{i}}{\\partial s}b_{i},v_{s})+\\dot{g}(v_{s},v_{s})$$ $$=g(\\nabla_{v_{s}}f,v_{s})+\\sum_{i=1}^{m}u_{i}g(\\nabla_{v_{s}}b_{i},v_{s})+\\sum_{i=1}^{m}\\frac{\\partial u_{i}}{\\partial s}g(b_{i},v_{s})$$ $$+\\dot{g}(v_{s},v_{s}).$$\nIf (22) holds for all u, the second term on the last line vanish since it depends linearly on u. In other words,\n\n$$g(\\nabla_{v}b_{i},v)=0,\\quad\\forall v\\in T{\\cal M},\\ i\\in\\ell_{m}.\\tag{23}$$\nThis is nothing but saying that bis are Killing fields (c.f. C1).\n\nTo continue, note that if for v \u2208 T M satisfying g(bi, v) =\n0 for all i \u2208 \u2113m, there holds\n\n$$g(\\nabla_{v}f,v)+\\dot{g}(v,v)+2\\lambda g(v,v)<0,\\tag{24}$$\n\nthen we can simply design a \"differential controller\" as\n\u2202ui\n\u2202s = \u2212\u03c1g(bi, vs) for some non-negative function \u03c1(x, t)\nas in Proposition 3. We underline that (24) is exactly (9).\n  Like in the submanifold case, the search for a CCM on\nan abstract manifold can be convexified via the musical\nisomorphism: \u266d : T M \u2192 T M\u2217. In words, given v \u2208 T M\nand the Riemannian metric g, we lift v and g to T M\u2217:\n\n$ v=v^i\\frac{\\partial}{\\partial x_i}\\mapsto v^i g_{ij}dx^j$\n\n$ g=g_{ij}dx^i dx^j\\mapsto g^{ij}\\frac{\\partial}{\\partial x_i}\\frac{\\partial}{\\partial x_j}$\n\nwhere (gij) is the inverse of (gij).\n  For implementation, all the expressions will need to be\nwritten in local coordinates, from where one can recover\nthe assumptions A0-A2. In general, however, one should not\nexpect to solve the problem globally like on Lie groups.\n"
    },
    {
        "level": "##",
        "title": "Iv. Concluding Remarks",
        "content": "\n  This paper has presented an extension of the control\ncontraction metrics approach from Euclidean space to Lie\ngroups, in which we view the manifolds as constrained sets.\nIn particular, we show that the search for CCM on matrix\nLie groups (potentially with a direct product with a vector\nspace) can be formulated as the convex conditions. Future\ndirections would be to apply the proposed approach to study\nthe trajectory tracking control of some practical systems on\nmanifolds.\n"
    },
    {
        "level": "##",
        "title": "Appendix",
        "content": "\nLemma 8: Let g1, g2 be two Riemannian metrics on a manifold M satisfying a1g1(v, v) \u2264 g2(v, v) \u2264 a2g1(v, v),\n\u2200v \u2208 T M\n(25)\nfor some positive constants a1, a2. Let d1 and d2 be the induced Riemannian distances of the two metrics respectively.\n\nThen there holds\n\u221aa1d1(x, y) \u2264 d2(x, y) \u2264 \u221aa2d1(x, y),\n\u2200x, y \u2208 M (26)\nwhere dg and d\u00afg are the induced distances on M, whenever they are well defined.\n\nProof: For a given pair of points x, y \u2208 M such that dg(x, y) and d\u00afg(x, y) are defined, let \u03b3g : [0, 1] \u2192 M and\n\u03b3\u00afg : [0, 1] \u2192 M be the minimizing geodesics joining x to y for dg and d\u00afg, respectively.\n\nFrom Assumption A1, we have on one hand,\n\n$$d_{\\bar{g}}(x,y)=\\int_{0}^{1}\\sqrt{\\bar{g}}(\\gamma^{\\prime}_{\\bar{g}}(s),\\gamma^{\\prime}_{\\bar{g}}(s))ds$$ $$\\leq\\int_{0}^{1}\\sqrt{\\bar{g}}(\\gamma^{\\prime}_{g}(s),\\gamma^{\\prime}_{g}(s))ds$$ $$\\leq\\sqrt{a_{2}}\\int_{0}^{1}\\sqrt{g}(\\gamma^{\\prime}_{g}(s),\\gamma^{\\prime}_{g}(s))ds$$ $$=\\sqrt{a_{2}}d_{g}(x,y),$$\nwith the notation (\u00b7)\u2032 = \u2202(\u00b7)\n\u2202s for scalar functions, and on the other hand, similarly\n\n$$d_{\\bar{g}}(x,y)=\\int_{0}^{1}\\sqrt{\\bar{g}(\\gamma_{\\bar{g}}^{\\prime}(s),\\gamma_{\\bar{g}}^{\\prime}(s))}ds\\geq\\sqrt{a_{1}}d_{g}(x,y).$$\n\nThis completes the proof.\n"
    },
    {
        "level": "##",
        "title": "References",
        "content": "\n[1] W. Lohmiller and J.-J. E. Slotine, \"On contraction analysis for nonlinear systems,\" *Automatica*, vol. 34, no. 6, pp. 683\u2013696, 1998.\n[2] B. Yi, R. Wang, and I. R. Manchester, \"Reduced-order nonlinear\nobservers via contraction analysis and convex optimization,\" IEEE\nTrans. Autom. Control, vol. 67, no. 8, pp. 4045\u20134060, 2021.\n[3] N. Aghannan and P. Rouchon, \"An intrinsic observer for a class of\nLagrangian systems,\" *IEEE Trans. Autom. Control*, vol. 48, no. 6, pp.\n936\u2013945, 2003.\n[4] R. Reyes-B\u00b4aez, A. van der Schaft, and B. Jayawardhana, \"Tracking control of fully-actuated port-Hamiltonian mechanical systems\nvia sliding manifolds and contraction analysis,\" *IFAC-PapersOnLine*,\nvol. 50, no. 1, pp. 8256\u20138261, 2017.\n[5] A. Pavlov and L. Marconi, \"Incremental passivity and output regulation,\" *Syst. Control Lett.*, vol. 57, no. 5, pp. 400\u2013409, 2008.\n[6] C. Blocher, M. Saveriano, and D. Lee, \"Learning stable dynamical\nsystems using contraction theory,\" in Int. Conf. Ubiquitous Robot.\nAmbient Intell.\nIEEE, 2017, pp. 124\u2013129.\n[7] S.\nSingh,\nS.\nM.\nRichards,\nV.\nSindhwani,\nJ.-J.\nE.\nSlotine,\nand M. Pavone, \"Learning stabilizable nonlinear dynamics with\ncontraction-based regularization,\" *Int. J. Robot. Res.*, vol. 40, no. 10-\n11, pp. 1123\u20131150, 2021.\n[8] M. Revay, R. Wang, and I. R. Manchester, \"Recurrent equilibrium\nnetworks: Flexible dynamic models with guaranteed stability and\nrobustness,\" *IEEE Trans. Autom. Control*, 2023.\n[9] B. Yi and I. R. Manchester, \"On the equivalence of contraction and\nkoopman approaches for nonlinear stability and control,\" IEEE Trans.\nAutom. Control, 2023.\n[10] S. Singh, B. Landry, A. Majumdar, J.-J. Slotine, and M. Pavone,\n\"Robust feedback motion planning via contraction theory,\" Int. J. Robot. Research, 2019.\n[11] H. Tsukamoto and S.-J. Chung, \"Learning-based robust motion planning with guaranteed stability: A contraction theory approach,\" IEEE\nRobot. Autom. Lett., vol. 6, no. 4, pp. 6164\u20136171, 2021.\n[12] H. Tsukamoto, S.-J. Chung, and J.-J. E. Slotine, \"Contraction theory\nfor nonlinear stability analysis and learning-based control: A tutorial\noverview,\" *Ann. Rev. Control*, vol. 52, pp. 135\u2013169, 2021.\n[13] F. Bullo, *Contraction Theory for Dynamical Systems*, 1.1 ed.\nKindle\nDirect Publishing, 2023.\n[14] I. R. Manchester and J.-J. E. Slotine, \"Control contraction metrics:\nConvex and intrinsic criteria for nonlinear feedback design,\" IEEE\nTrans. Autom. Control, vol. 62, no. 6, pp. 3046\u20133053, 2017.\n[15] \u2014\u2014, \"Robust control contraction metrics: A convex approach to\nnonlinear state-feedback H\u221e control,\" *IEEE Control Syst. Lett.*, vol. 2,\nno. 3, pp. 333\u2013338, 2018.\n[16] C. Dawson, S. Gao, and C. Fan, \"Safe control with learned certificates:\nA survey of neural lyapunov, barrier, and contraction methods for\nrobotics and control,\" *IEEE Trans. Robot.*, 2023.\n[17] B. T. Lopez, J.-J. E. Slotine, and J. P. How, \"Robust adaptive control\nbarrier functions: An adaptive and data-driven approach to safety,\"\nIEEE Control Syst. Lett., vol. 5, no. 3, pp. 1031\u20131036, 2020.\n[18] A. Sasfi, M. N. Zeilinger, and J. K\u00a8ohler, \"Robust adaptive MPC\nusing control contraction metrics,\" *Automatica*, vol. 155, 2023, art.\nno. 111169.\n[19] A. van der Schaft, \"On differential passivity,\" in IFAC Symp. Nonlinear\nControl Syst.\nIFAC, 2013, pp. 21\u201325.\n[20] K. Nomizu, \"On local and global existence of killing vector fields,\"\nAnnals of Mathematics, pp. 105\u2013120, 1960.\n[21] R. Wang and I. R. Manchester, \"Continuous-time dynamic realization\nfor nonlinear stabilization via control contraction metrics,\" in Am.\nControl Conf.\nIEEE, 2020, pp. 1619\u20131624.\n[22] A. van der Schaft, \"On differential passivity.\" in IFAC Symp. Nonlinear\nControl Syst., 2013, pp. 21\u201325.\n[23] J. M. Lee and J. M. Lee, *Smooth manifolds*.\nSpringer, 2012."
    }
]